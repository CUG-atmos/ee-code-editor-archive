/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var olivier = ee.FeatureCollection("users/mahyouh/olivier"),
    site_poly = /* color: #edf163 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-2.893862398685542, 34.48791623163773],
                  [-2.8936531863823802, 34.48803119310905],
                  [-2.8938463054314525, 34.488243429255185],
                  [-2.8940930686608226, 34.48815499759326]]]),
            {
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-2.8902575097695262, 34.48720877294155],
                  [-2.890139492572871, 34.48740774630638],
                  [-2.8905310950890453, 34.487642092105084],
                  [-2.8906544767037303, 34.487447540922375]]]),
            {
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-2.8925972560284663, 34.486334850664285],
                  [-2.892350492799096, 34.48633927234611],
                  [-2.892377314889245, 34.486560356138035],
                  [-2.8926401713727046, 34.48657362114691]]]),
            {
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-2.892898676449363, 34.49519904079651],
                  [-2.8914073682370827, 34.49592853758004],
                  [-2.89222812419564, 34.4968658210486],
                  [-2.8933868384900734, 34.496189386395926]]]),
            {
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-2.9442512432523245, 34.414395824397914],
                  [-2.943242732662725, 34.41463480063017],
                  [-2.9433714786954397, 34.415307470802794],
                  [-2.9441975990720266, 34.41508619831686]]]),
            {
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-2.954396162504281, 34.44672810258758],
                  [-2.953875813955392, 34.44712181812633],
                  [-2.9541601281109706, 34.447338582069065],
                  [-2.95468047665986, 34.44695371508961]]]),
            {
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-2.955324206823434, 34.447210293272946],
                  [-2.955045257085885, 34.44699795276365],
                  [-2.9545356373730556, 34.44740936201018],
                  [-2.9549165110531703, 34.44766593879392],
                  [-2.955077443594064, 34.44753322676277]]]),
            {
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-3.0711665151980014, 34.51703074630955],
                  [-3.070501327362308, 34.51724290863313],
                  [-3.07020091995264, 34.517384349882036],
                  [-3.0701150892641635, 34.51767607169951],
                  [-3.071123599853763, 34.517322469365176]]]),
            {
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-3.0325469264994354, 34.532221762565534],
                  [-3.0322143325815887, 34.532407370772184],
                  [-3.0313989410410613, 34.53289348554305],
                  [-3.0318710098276824, 34.53358287980619],
                  [-3.0329438934336395, 34.532937677654225]]]),
            {
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-3.027347978355351, 34.54103564815263],
                  [-3.0274177157897384, 34.54097378520826],
                  [-3.0274123513717086, 34.54076610213017],
                  [-3.027106579544011, 34.54077493971852],
                  [-3.027181681396428, 34.54135379971174],
                  [-3.027406986953679, 34.5413493809484]]]),
            {
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-3.048935085659309, 34.55223793328284],
                  [-3.0487258733561475, 34.55242570594748],
                  [-3.0490960182002027, 34.55270184144916],
                  [-3.049283772831245, 34.55254057842749]]]),
            {
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-3.0736416272191036, 34.2551778728286],
                  [-3.0720215729741085, 34.25419354124954],
                  [-3.070712654974841, 34.2556744681736],
                  [-3.071935742285632, 34.25654350297427],
                  [-3.073405592825793, 34.25537296420658]]]),
            {
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-3.0957579447552916, 34.275675982461614],
                  [-3.0952429606244323, 34.27586216067649],
                  [-3.095623834304547, 34.27635863390041],
                  [-3.0960798098370788, 34.276176889578295]]]),
            {
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.0538641300496465, 34.50435754702357],
                  [-4.0538641300496465, 34.504154193366254],
                  [-4.0535905447301275, 34.504180717784486],
                  [-4.053306230574549, 34.50422050439599],
                  [-4.053349145918787, 34.504507851581835],
                  [-4.053848036795557, 34.50446364438695]]]),
            {
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.059107892531301, 34.5275134160364],
                  [-4.059070341605093, 34.527537723270854],
                  [-4.058963053244497, 34.527595176705866],
                  [-4.059158854502584, 34.52769019576148],
                  [-4.059244685191061, 34.52763274239199]]]),
            {
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.045888028149307, 34.53211382543722],
                  [-4.045662722592056, 34.532078471400354],
                  [-4.045539340977371, 34.53258668423717],
                  [-4.045770010952651, 34.53262203805824]]]),
            {
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.052575874320837, 34.5262378488305],
                  [-4.052543687812658, 34.52609421282762],
                  [-4.052310335628363, 34.526103051973415],
                  [-4.052304971210333, 34.526246687961034]]]),
            {
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.232383842694389, 34.19631730846834],
                  [-4.232233638989555, 34.196068836116744],
                  [-4.232019062268364, 34.1959978438818],
                  [-4.230677957760918, 34.19623744243517],
                  [-4.230795974957573, 34.19665451977435],
                  [-4.231568451153862, 34.19646816632458],
                  [-4.232308740841972, 34.196343930462575]]]),
            {
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.278281114599281, 34.207423409304795],
                  [-4.277701757452064, 34.207600865727684],
                  [-4.27805580904203, 34.208594614791295],
                  [-4.278678081533485, 34.20844377863412]]]),
            {
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.29367924190251, 34.207199431138235],
                  [-4.2929818675586375, 34.20696873661688],
                  [-4.292815570599714, 34.20721717684451],
                  [-4.292370323903242, 34.20807340273232],
                  [-4.29316425777165, 34.20821536680571]]]),
            {
              "system:index": "19"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.405815524492937, 34.13783581417513],
                  [-4.405391735468584, 34.13803117723996],
                  [-4.405528528128343, 34.138288700589904],
                  [-4.40598718586989, 34.13808889805904]]]),
            {
              "system:index": "20"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.418175429176358, 34.132012660436686],
                  [-4.417107909988431, 34.13195937585118],
                  [-4.417086452316312, 34.13240785339734],
                  [-4.418261259864835, 34.132461137700105]]]),
            {
              "system:index": "21"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.430303508242673, 34.13210060624079],
                  [-4.429329866370267, 34.13211170718034],
                  [-4.429348641833371, 34.13234260639207],
                  [-4.430300826033658, 34.132347046755356]]]),
            {
              "system:index": "22"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.454967478540993, 34.14513197779332],
                  [-4.4541413581644065, 34.14508758086768],
                  [-4.454195002344704, 34.14630404819151],
                  [-4.455031851557351, 34.146312927450644]]]),
            {
              "system:index": "23"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.622824624654868, 34.468978882704604],
                  [-4.622245267507651, 34.468890430621514],
                  [-4.621794656393149, 34.46998722982629],
                  [-4.62226672517977, 34.47019951187851],
                  [-4.622888997671225, 34.469102715463436]]]),
            {
              "system:index": "24"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.625142053243735, 34.46935038042996],
                  [-4.624734357473471, 34.46867814523966],
                  [-4.624412492391684, 34.4687665975477],
                  [-4.6232323204251315, 34.469474212637614],
                  [-4.623554185506919, 34.47000492001794],
                  [-4.624562696096518, 34.469580354383645]]]),
            {
              "system:index": "25"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.627888635274985, 34.464007730236716],
                  [-4.627663329717734, 34.46338852681075],
                  [-4.627416566488364, 34.463017002550565],
                  [-4.626032546636679, 34.46351236786337],
                  [-4.627234176275351, 34.46432617592449]]]),
            {
              "system:index": "26"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.649744397783479, 34.469167537728275],
                  [-4.648843175554475, 34.46930906054632],
                  [-4.649025565767488, 34.47037047403265],
                  [-4.649905330324373, 34.47022895301441]]]),
            {
              "system:index": "27"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.732459678730606, 34.446390506314756],
                  [-4.732051982960343, 34.4467444094373],
                  [-4.7325562382551425, 34.44733719380842],
                  [-4.733092680058121, 34.446956750591106]]]),
            {
              "system:index": "28"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.2771337844862956, 34.593243360416295],
                  [-5.276565156175138, 34.593009311728075],
                  [-5.275953612519743, 34.59318595230851],
                  [-5.276184282495024, 34.593578976252495],
                  [-5.277155242158415, 34.5932742724579]]]),
            {
              "system:index": "29"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.20747590455278, 34.66746702007608],
                  [-5.207599286167465, 34.66749790447358],
                  [-5.20772803220018, 34.667343482370974],
                  [-5.2078353205607755, 34.66708758225297],
                  [-5.207679752437912, 34.66689786268974],
                  [-5.207486633388839, 34.666915511039534]]]),
            {
              "system:index": "30"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.240254913495505, 34.750109488688565],
                  [-5.240769897626365, 34.74985825215356],
                  [-5.2405714141592625, 34.74961142253281],
                  [-5.24012616746279, 34.74979213714892],
                  [-5.240034972356284, 34.74993318242819],
                  [-5.240217362569297, 34.750091858079465]]]),
            {
              "system:index": "31"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.523199594430366, 34.67928225331616],
                  [-5.522502220086494, 34.67954693858997],
                  [-5.5228455428404, 34.68012042044752],
                  [-5.523585832528511, 34.67988220538892]]]),
            {
              "system:index": "32"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.552806771222208, 34.66152236508363],
                  [-5.551433480206583, 34.662051848292634],
                  [-5.551819718304728, 34.66293431278919],
                  [-5.553249979831435, 34.66247604918288]]]),
            {
              "system:index": "33"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.555377677351885, 34.67130079337606],
                  [-5.5550370368069935, 34.67140006001866],
                  [-5.555195287138872, 34.67162285805],
                  [-5.555517152220659, 34.67151256206979]]]),
            {
              "system:index": "34"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.629580545909903, 34.731732546533955],
                  [-5.628861713893912, 34.73148566275629],
                  [-5.628014135845206, 34.73203233298682],
                  [-5.629119205959341, 34.73226158071701]]]),
            {
              "system:index": "35"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.633446633812355, 34.80981901041527],
                  [-5.6324810385669934, 34.80954593326373],
                  [-5.631526172157692, 34.80943141676959],
                  [-5.630689322945045, 34.810391588601554],
                  [-5.632459580894874, 34.81078798655382]]]),
            {
              "system:index": "36"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.66422242858232, 34.85321914671405],
                  [-5.664791056893478, 34.852646866262745],
                  [-5.664265343926559, 34.8524355617053],
                  [-5.663750359795699, 34.8529902350112]]]),
            {
              "system:index": "37"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.384475879197339, 35.037011568567735],
                  [-5.384787015443067, 35.036923722810904],
                  [-5.385044507508496, 35.03660747730444],
                  [-5.384969405656079, 35.03631758451501],
                  [-5.384658269410352, 35.036335153804245],
                  [-5.38420765829585, 35.03641421555909],
                  [-5.384111098771314, 35.036967645701125]]]),
            {
              "system:index": "38"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.382086377121823, 35.07585063711603],
                  [-5.381965677716153, 35.07580893023568],
                  [-5.381598215081112, 35.0758550273127],
                  [-5.381547253109829, 35.076024049705644],
                  [-5.381971042134182, 35.07603283008013]]]),
            {
              "system:index": "39"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.2460788126643365, 35.06527222665942],
                  [-5.2458803291972345, 35.06527222665942],
                  [-5.245767676418609, 35.06532491583308],
                  [-5.245638930385894, 35.06530296201485],
                  [-5.2453546162303155, 35.06523270975684],
                  [-5.245258056705779, 35.06539077725235],
                  [-5.245612108295745, 35.065522499931426],
                  [-5.2457301254924005, 35.06543029407839],
                  [-5.246110999172515, 35.065439075592685],
                  [-5.246175372188873, 35.06532930659602]]]),
            {
              "system:index": "40"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.300880464455076, 35.14059072856937],
                  [-5.300767811676451, 35.14050299430697],
                  [-5.300617607971617, 35.140520541167],
                  [-5.300306471725889, 35.140560021588286],
                  [-5.300413760086485, 35.14093289128925],
                  [-5.300934108635374, 35.14083638400106]]]),
            {
              "system:index": "41"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.321954763137683, 35.15968295248648],
                  [-5.321718728744372, 35.1598013658043],
                  [-5.321675813400134, 35.159880307920425],
                  [-5.321817970477923, 35.16004038475405],
                  [-5.321868932449206, 35.16006450589345],
                  [-5.321949398719653, 35.16003380626026],
                  [-5.322118377887591, 35.15994170729111],
                  [-5.322188115321978, 35.15989127209717]]]),
            {
              "system:index": "42"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.320376282748953, 35.18486767985891],
                  [-5.319990044650808, 35.185086895731075],
                  [-5.320317274150625, 35.18544640848129],
                  [-5.320794707355276, 35.18523596218635]]]),
            {
              "system:index": "43"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.247428134508823, 35.22103985783686],
                  [-5.247208193369602, 35.22094782799324],
                  [-5.246923879214023, 35.22103547546569],
                  [-5.246977523394321, 35.221250211373174],
                  [-5.2473905835826145, 35.22105738731902]]]),
            {
              "system:index": "44"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.4918413876469, 33.8029818495995],
                  [-4.491272759335743, 33.80266090231923],
                  [-4.490511011975514, 33.80345435312724],
                  [-4.490918707745777, 33.803730721905914]]]),
            {
              "system:index": "45"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.6350038799701, 33.84896848366641],
                  [-4.63525064319947, 33.84873681316239],
                  [-4.63499315113404, 33.84862988810247],
                  [-4.634381607478645, 33.84882591727674],
                  [-4.634435251658942, 33.84913778094513]]]),
            {
              "system:index": "46"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.688086926133906, 33.850703006826016],
                  [-4.686885296495234, 33.8504891614943],
                  [-4.686391770036494, 33.851718764841095],
                  [-4.687335907609736, 33.85195042725827]]]),
            {
              "system:index": "47"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.704422832655837, 33.82203304035061],
                  [-4.703768373656203, 33.822282609595845],
                  [-4.703864933180739, 33.82262576611876],
                  [-4.70459449403279, 33.82234054520931]]]),
            {
              "system:index": "48"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.79571220523826, 33.80409603327883],
                  [-4.7952294076155795, 33.80356558500315],
                  [-4.794886084861673, 33.80393556187844],
                  [-4.795320602722086, 33.8043055371542],
                  [-4.7957323010273285, 33.804131693549145]]]),
            {
              "system:index": "49"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.899120287752567, 33.92436892810158],
                  [-4.898755507326541, 33.924440148230566],
                  [-4.898884253359256, 33.9248496628167],
                  [-4.899377779817996, 33.925419418966],
                  [-4.8997424451270035, 33.92499191117034]]]),
            {
              "system:index": "50"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.904828028536258, 33.919347758940056],
                  [-4.904162840700565, 33.919828521989466],
                  [-4.904849486208377, 33.920344894094974],
                  [-4.9055146740440705, 33.91989974591423]]]),
            {
              "system:index": "51"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-4.967892126894412, 33.89656313546553],
                  [-4.9673878715996125, 33.8965007974701],
                  [-4.96694798932117, 33.89759615846942],
                  [-4.967548804140506, 33.8977831699168]]]),
            {
              "system:index": "52"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.061620040779076, 33.94924320785384],
                  [-5.06151275241848, 33.94878931074904],
                  [-5.061094327812157, 33.94879821071552],
                  [-5.061153336410484, 33.94931885713596],
                  [-5.061636134033165, 33.94928770743969]]]),
            {
              "system:index": "53"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.543759389422007, 32.772447112421595],
                  [-5.5435769992089945, 32.772465154609996],
                  [-5.542965455553599, 32.77264557629292],
                  [-5.543115659258433, 32.77299739752264],
                  [-5.543898864290782, 32.772825997610106]]]),
            {
              "system:index": "54"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.637504750587709, 32.78990262782177],
                  [-5.636764460899599, 32.789866550512876],
                  [-5.636678630211122, 32.79016418787349],
                  [-5.637536937095888, 32.790186736117796]]]),
            {
              "system:index": "55"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.6730508125481265, 32.783856118006646],
                  [-5.672755769556488, 32.78371630884988],
                  [-5.67246072656485, 32.783973377130025],
                  [-5.672487548654999, 32.78409514605609],
                  [-5.672948888605561, 32.78427103421057],
                  [-5.673018626039948, 32.784068086309134]]]),
            {
              "system:index": "56"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.707384588042032, 32.738914879029394],
                  [-5.707116367140543, 32.73874341350813],
                  [-5.706740857878458, 32.73859902123436],
                  [-5.706397535124552, 32.73924878462399],
                  [-5.707019807616007, 32.73939317584497]]]),
            {
              "system:index": "57"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.799165396716148, 32.719358724062715],
                  [-5.798462657954246, 32.71910146922996],
                  [-5.798103241946251, 32.71988225792181],
                  [-5.798687963511497, 32.72009889172312]]]),
            {
              "system:index": "58"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.814938948727445, 32.69678471661272],
                  [-5.814477608776883, 32.69590892293842],
                  [-5.813758776760892, 32.69627007601021],
                  [-5.814241574383573, 32.69704655016637],
                  [-5.814853118038968, 32.69679374536873]]]),
            {
              "system:index": "59"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-5.8404945509777235, 32.70986537726478],
                  [-5.840312160764711, 32.70923345471061],
                  [-5.840097584043519, 32.70917026220903],
                  [-5.839872278486268, 32.70945011437627],
                  [-5.839979566846864, 32.70993759670023],
                  [-5.840483822141664, 32.70992856927402]]]),
            {
              "system:index": "60"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-6.50766946278236, 32.45868593062819],
                  [-6.5078035732331045, 32.45851392796956],
                  [-6.507100834471203, 32.458160868851884],
                  [-6.506752147299267, 32.45802960292959],
                  [-6.506575121504284, 32.45826950257394],
                  [-6.5072295805039175, 32.45855466547102]]]),
            {
              "system:index": "61"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-6.509269438178421, 32.46314858947301],
                  [-6.509661040694596, 32.46291775516126],
                  [-6.509017310531021, 32.462311246503184],
                  [-6.508604250342728, 32.462591870419836]]]),
            {
              "system:index": "62"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-6.620475997959147, 32.50076320881993],
                  [-6.619746437107096, 32.500803927203684],
                  [-6.6196445131645305, 32.501152294844275],
                  [-6.620374074016581, 32.50109347962303]]]),
            {
              "system:index": "63"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-6.6214040422783, 32.500681771997144],
                  [-6.621012439762126, 32.500681771997144],
                  [-6.620830049549113, 32.50073606322054],
                  [-6.620749583278666, 32.50105276137039],
                  [-6.6213182115898235, 32.50098489757501]]]),
            {
              "system:index": "64"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-6.667661043049634, 32.49795773998376],
                  [-6.6670226773040895, 32.497898922673365],
                  [-6.666668625714124, 32.49850519156616],
                  [-6.667339177967847, 32.49859567911013]]]),
            {
              "system:index": "65"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.416278967962171, 32.538655680690546],
                  [-8.415603051290418, 32.5382667570044],
                  [-8.414095649824048, 32.53949683546007],
                  [-8.414799639518606, 32.5399090446111]]]),
            {
              "system:index": "66"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.496463694628801, 32.28822272035235],
                  [-8.49625448232564, 32.28828620930721],
                  [-8.49647442346486, 32.28878051464974],
                  [-8.496715822276201, 32.288730630746606]]]),
            {
              "system:index": "67"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.610051943545386, 32.23590373395789],
                  [-8.609783722643897, 32.2357585325076],
                  [-8.609129263644263, 32.23564963126761],
                  [-8.608807398562476, 32.236266736568375],
                  [-8.60969789195542, 32.23661158770499]]]),
            {
              "system:index": "68"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.518256322238358, 32.144256263096445],
                  [-8.518427983615311, 32.14392014612488],
                  [-8.518095389697464, 32.14378842427109],
                  [-8.517988101336869, 32.14402915717033],
                  [-8.517988101336869, 32.14416996291116]]]),
            {
              "system:index": "69"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.552435577035794, 32.13262381931135],
                  [-8.551856219888577, 32.13263744738703],
                  [-8.551958143831143, 32.133291592625675],
                  [-8.552510678888211, 32.133237080701626]]]),
            {
              "system:index": "70"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.625589993003928, 32.09178123659442],
                  [-8.625619497303092, 32.09153354874776],
                  [-8.625619497303092, 32.09140175127124],
                  [-8.625391509536826, 32.091338124835254],
                  [-8.625337865356528, 32.09175396824051],
                  [-8.625587310794913, 32.09179714313043]]]),
            {
              "system:index": "71"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.631892890173617, 32.093422461498776],
                  [-8.631785601813021, 32.09344064007027],
                  [-8.631748050886813, 32.09357016228766],
                  [-8.631825834948245, 32.09380648305321],
                  [-8.632096738058749, 32.09362469790318]]]),
            {
              "system:index": "72"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.450436418696654, 32.071744731600056],
                  [-8.45042837206961, 32.07168563720351],
                  [-8.450329130336058, 32.07171063868363],
                  [-8.450254028483641, 32.07205384012896],
                  [-8.450363999053252, 32.0720652043932]]]),
            {
              "system:index": "73"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.362115248441114, 32.0492193638719],
                  [-8.36197577357234, 32.04921027018982],
                  [-8.361267670392408, 32.0492193638719],
                  [-8.361396416425123, 32.04980135764612],
                  [-8.36223326563777, 32.04972860862675]]]),
            {
              "system:index": "74"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.360581024884596, 32.04841911638909],
                  [-8.360066040753736, 32.04841911638909],
                  [-8.360355719327345, 32.04947398660355],
                  [-8.360881432294264, 32.04943761197096]]]),
            {
              "system:index": "75"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.52066603398157, 31.8977307270687],
                  [-8.520285160301455, 31.89790834659802],
                  [-8.520499737022647, 31.898186161071997],
                  [-8.520998627899417, 31.898022205090378]]]),
            {
              "system:index": "76"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.52440503334833, 31.899256422110607],
                  [-8.524018795250186, 31.899333844766932],
                  [-8.524238736389407, 31.899730065577007],
                  [-8.524565965889224, 31.899643534741074]]]),
            {
              "system:index": "77"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.048521640340368, 31.992944956302907],
                  [-8.047883274594824, 31.99299045263658],
                  [-8.047899367848913, 31.993454513950958],
                  [-8.048661115209143, 31.993358972107597]]]),
            {
              "system:index": "78"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.035956633528713, 31.977159458366895],
                  [-8.03526462360287, 31.977359676512336],
                  [-8.035489929160121, 31.97788297187519],
                  [-8.036122930487636, 31.977682754871385]]]),
            {
              "system:index": "79"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.991364365200866, 31.988600967025164],
                  [-7.9913750940369255, 31.98824607804135],
                  [-7.990559702496398, 31.98802768413813],
                  [-7.990087633709777, 31.988264277509835],
                  [-7.990055447201598, 31.98853726910354],
                  [-7.991289263348449, 31.988619166423216]]]),
            {
              "system:index": "80"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-9.234574531215799, 31.94470574502097],
                  [-9.23427412380613, 31.94474216122002],
                  [-9.233383630413186, 31.94483320165447],
                  [-9.233458732265603, 31.94599851124905],
                  [-9.234520887035501, 31.94599851124905]]]),
            {
              "system:index": "81"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-9.26119554874333, 31.95913828761575],
                  [-9.260841497153365, 31.959379506764908],
                  [-9.261088260382735, 31.959648032997066],
                  [-9.261517413825118, 31.959434122333366]]]),
            {
              "system:index": "82"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-9.281374427932292, 31.928810196352686],
                  [-9.280301544326335, 31.929028731118887],
                  [-9.280451748031169, 31.929921076023568],
                  [-9.281567546981364, 31.929666121220254]]]),
            {
              "system:index": "83"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-9.583428887964601, 31.655086832491843],
                  [-9.583230404497499, 31.655278617511378],
                  [-9.583536176325197, 31.655698716647294],
                  [-9.583729295374269, 31.655598258331025]]]),
            {
              "system:index": "84"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-9.517640741473429, 31.58075324191421],
                  [-9.517436893588297, 31.580360224242405],
                  [-9.517007740145914, 31.58031452440557],
                  [-9.516900451785318, 31.581091418584364],
                  [-9.517554910784952, 31.581146257928758]]]),
            {
              "system:index": "85"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-9.531828475266934, 31.556157130925005],
                  [-9.531603169709683, 31.555818863814935],
                  [-9.530905795365811, 31.555837148554954],
                  [-9.530734133988858, 31.55644968527435],
                  [-9.531742644578458, 31.55654110832039]]]),
            {
              "system:index": "86"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-9.385811540142868, 31.43585944678004],
                  [-9.386401626126144, 31.43531019879287],
                  [-9.385414573208664, 31.434678559628907],
                  [-9.384878131405685, 31.43531019879287]]]),
            {
              "system:index": "87"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-9.41995867510468, 31.377084230907716],
                  [-9.419829929071966, 31.376319381027276],
                  [-9.418950164515081, 31.376360600640645],
                  [-9.418907249170843, 31.37704759153448],
                  [-9.419931853014532, 31.37704759153448]]]),
            {
              "system:index": "88"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.192659616660762, 31.639626014348792],
                  [-8.192026615333248, 31.639566642365057],
                  [-8.19197833557098, 31.640137525253742],
                  [-8.192530870628048, 31.640265402540336]]]),
            {
              "system:index": "89"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.202615351095801, 31.64015698876641],
                  [-8.202534884825354, 31.639759654729858],
                  [-8.201456636801367, 31.63988296547461],
                  [-8.201483458891516, 31.64030313419187]]]),
            {
              "system:index": "90"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.798139951705934, 31.55067671079967],
                  [-7.7973889331817645, 31.55064013929342],
                  [-7.79749622154236, 31.551846991431532],
                  [-7.79850473213196, 31.551846991431532]]]),
            {
              "system:index": "91"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.967501006822658, 31.37312559919146],
                  [-7.9668250901509055, 31.373153079869816],
                  [-7.966878734331203, 31.37410573841722],
                  [-7.967490277986599, 31.37410573841722]]]),
            {
              "system:index": "92"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.972952634992112, 31.37098156810762],
                  [-7.972558350266922, 31.371077752641238],
                  [-7.972561032475937, 31.371506001631683],
                  [-7.97312697857808, 31.371386916546797]]]),
            {
              "system:index": "93"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.388018293366713, 31.39782478406029],
                  [-8.387267274842543, 31.39781104733111],
                  [-8.387186808572096, 31.398841296441315],
                  [-8.387894911752028, 31.39884587530101]]]),
            {
              "system:index": "94"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.431070645176533, 31.389176060664834],
                  [-8.430764873348835, 31.389244750607748],
                  [-8.430185516201618, 31.389469137404358],
                  [-8.43090434821761, 31.390581904819985],
                  [-8.431698282086018, 31.390279672999153]]]),
            {
              "system:index": "95"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.426282915240563, 31.4091926993],
                  [-8.425692829257287, 31.40878980321232],
                  [-8.424834522372521, 31.409568123642817],
                  [-8.425478252536095, 31.40986113672036]]]),
            {
              "system:index": "96"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.420498793489514, 31.419991078120574],
                  [-8.420252030260144, 31.420004811603075],
                  [-8.419983809358655, 31.420311525521512],
                  [-8.420793836481153, 31.420979883720356],
                  [-8.421303456193982, 31.420554149253945]]]),
            {
              "system:index": "97"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.390695186452035, 31.442312845150255],
                  [-8.389048310116891, 31.442244194055128],
                  [-8.388908835248117, 31.44306342717603],
                  [-8.390598626927499, 31.443100040779594]]]),
            {
              "system:index": "98"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.436158681606685, 31.455870647426114],
                  [-8.435450578426753, 31.456273341223312],
                  [-8.43577244350854, 31.45788409909787],
                  [-8.436630750393306, 31.457536324174477]]]),
            {
              "system:index": "99"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.486054590635604, 31.43272201963105],
                  [-8.484874418669051, 31.43279525490394],
                  [-8.484810045652694, 31.433674073716304],
                  [-8.485775640898055, 31.433783925488566]]]),
            {
              "system:index": "100"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.228464836192984, 31.25714539276433],
                  [-8.227692359996695, 31.257365508870485],
                  [-8.228271717143912, 31.258099225517185],
                  [-8.229194397045035, 31.257824082443015]]]),
            {
              "system:index": "101"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.230974733004814, 31.247194944531373],
                  [-8.23056703723455, 31.2469014246581],
                  [-8.230352460513359, 31.246818872029372],
                  [-8.230137883792167, 31.247094047177832],
                  [-8.230770885119682, 31.24780032638859],
                  [-8.231178580889946, 31.24763522263059]]]),
            {
              "system:index": "102"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-8.127603715856253, 31.245189206831142],
                  [-8.12749508639115, 31.24505161658186],
                  [-8.127229547698676, 31.245220164609627],
                  [-8.12734756489533, 31.245327943462883],
                  [-8.127383774717032, 31.245352021700526]]]),
            {
              "system:index": "103"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.1896463311609295, 31.785071831548066],
                  [-7.189402250140574, 31.785101470997603],
                  [-7.189463940947917, 31.785384185269525],
                  [-7.189657059996989, 31.785338586251868]]]),
            {
              "system:index": "104"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.186710844781146, 31.805828722667925],
                  [-7.186228047158465, 31.805929018239425],
                  [-7.185487757470355, 31.80614784456303],
                  [-7.185595045830951, 31.806722261196384],
                  [-7.18686104848598, 31.806494318515337]]]),
            {
              "system:index": "105"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.17702536499246, 31.818859391893163],
                  [-7.177754925844511, 31.818230351392774],
                  [-7.17727212822183, 31.817883921461352],
                  [-7.176606940386137, 31.818558546971087]]]),
            {
              "system:index": "106"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.188800886544868, 31.827000220863493],
                  [-7.187942579660103, 31.827018452249963],
                  [-7.187923804196998, 31.827419541841106],
                  [-7.188779428872749, 31.827383079223022]]]),
            {
              "system:index": "107"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.208096817852265, 31.799884067930215],
                  [-7.207581833721406, 31.799884067930215],
                  [-7.207694486500031, 31.800426609400805],
                  [-7.20822556388498, 31.800321748692628]]]),
            {
              "system:index": "108"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.220650847958041, 31.807213562489316],
                  [-7.220334347294283, 31.80717025365352],
                  [-7.220227058933688, 31.80742782695723],
                  [-7.220503326462222, 31.807462018049744]]]),
            {
              "system:index": "109"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.228873486537623, 31.804531418384652],
                  [-7.2284550619312995, 31.804422003373382],
                  [-7.228286082763361, 31.80493032618261],
                  [-7.228677685279536, 31.805021504866023]]]),
            {
              "system:index": "110"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.207607233558974, 31.812604142113976],
                  [-7.20697423223146, 31.812604142113976],
                  [-7.207049334083877, 31.8134292373764],
                  [-7.207698428665481, 31.81347482253513]]]),
            {
              "system:index": "111"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.209977998407226, 31.81909634094454],
                  [-7.209548844964843, 31.819089503588387],
                  [-7.209559573800902, 31.819622815848724],
                  [-7.2099806806162405, 31.81961825763734]]]),
            {
              "system:index": "112"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.24498913137711, 31.8090096090002],
                  [-7.244581435606847, 31.809000491529506],
                  [-7.244533155844579, 31.809570331718223],
                  [-7.244967673704991, 31.80962047748658]]]),
            {
              "system:index": "113"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.248217623066694, 31.794784464938232],
                  [-7.247466604542524, 31.79454737391084],
                  [-7.247091095280439, 31.795172016269582],
                  [-7.247901122402936, 31.79536351162165]]]),
            {
              "system:index": "114"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.269210768823768, 31.839986398227428],
                  [-7.26792330849662, 31.839667393272745],
                  [-7.26766581643119, 31.840205143844607],
                  [-7.268964005594398, 31.840606176129153]]]),
            {
              "system:index": "115"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.3242440243102465, 31.822699607565472],
                  [-7.323584200892583, 31.822617562459925],
                  [-7.32358595530377, 31.823036903344473],
                  [-7.324267236393553, 31.823068809638155]]]),
            {
              "system:index": "116"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.363186628474182, 31.869904446553193],
                  [-7.362746746195739, 31.870000116779057],
                  [-7.362757475031799, 31.87010945405843],
                  [-7.362923771990722, 31.87040557520535],
                  [-7.363433391703552, 31.87030079398522]]]),
            {
              "system:index": "117"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.311211832263552, 31.89251106552559],
                  [-7.311115272739016, 31.892602157670744],
                  [-7.310857780673587, 31.893039398713096],
                  [-7.311362035968386, 31.893312673310163],
                  [-7.311812647082888, 31.892948307000502]]]),
            {
              "system:index": "118"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.21550986659156, 31.88072462747867],
                  [-7.215064619895088, 31.880656299566777],
                  [-7.21502706896888, 31.880697296319997],
                  [-7.214887594100105, 31.88113914905787],
                  [-7.215359662886726, 31.881202921442945]]]),
            {
              "system:index": "119"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.17042381402257, 31.91819674599057],
                  [-7.169629880154162, 31.918597438905525],
                  [-7.170059033596544, 31.91933507357105],
                  [-7.17091734048131, 31.918907064053425]]]),
            {
              "system:index": "120"
            }),
        ee.Feature(
            ee.Geometry.Polygon(
                [[[-7.502895192418009, 32.048649576407286],
                  [-7.501672105107218, 32.048649576407286],
                  [-7.501736478123576, 32.04981356750158],
                  [-7.502895192418009, 32.04975900574976]]]),
            {
              "system:index": "121"
            })]),
    olive_site = ee.FeatureCollection("users/mahyouh/olive_site");
/***** End of imports. If edited, may not auto-convert in the playground. *****/

// Définir le Maroc dans la liste des pays du Monde

var Maroc = ee.FeatureCollection("users/mahyouh/Countries_WGS84").
  filter(ee.Filter.inList("CNTRY_NAME", ["Morocco"]));

//Map.addLayer(Maroc)

Map.centerObject(Maroc, 5);

// Sentinel-2 cloud mask function

function maskS2clouds(image) {
  var qa = image.select('QA60');

  // Bits 10 and 11 are clouds and cirrus, respectively.
  var cloudBitMask = 1 << 10;
  var cirrusBitMask = 1 << 11;

  // Both flags should be set to zero, indicating clear conditions.
  var mask = qa.bitwiseAnd(cloudBitMask).eq(0)
      .and(qa.bitwiseAnd(cirrusBitMask).eq(0));

  return image.updateMask(mask).divide(10000);}

 
 
  // Définir une table de couleurs (du rouge au vert)
 
var color =  ['d73027','f46d43','fdae61','fee08b','ffffbf','91cf60','27e87a', '1a9850'];



var S2 = ee.ImageCollection("COPERNICUS/S2")
.filterDate('2019-07-01','2019-07-16')
.filterBounds(Maroc)
.filter(ee.Filter.lte('CLOUDY_PIXEL_PERCENTAGE', 20))
.map(maskS2clouds)
.median();

var B = S2.select ('B2');
var G= S2.select ('B3');
var R = S2.select ('B4');
var VRD1 = S2.select ('B5');
var VRD2 = S2.select ('B6');
var VRD3 = S2.select ('B7');
var NIR = S2.select ('B8');


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Calculate MTCI (Meris Terrestrial Chlorophyll Index)= (B6 - B5)/(B5 - B4)

var MTCI = S2.expression(
 '(B6 - B5) / (B5 - B4)',{
 'B4': R,
 'B5': VRD1,
 'B6': VRD2
 });

 
// calcul de Modified Chlorophyll Absorption Ratio Index (MCARI)
 
var MCARI = S2.expression(
 '((B5 - B4) - 0.2 * (B5 - B3)) * (B5 - B4)',{
 'B3': G,  
 'B4': R,
 'B5': VRD1,
 'B6': VRD2
 });

//calcul  Red-Edge Inflection Point Index REIP

var REIP = S2.expression(
 '(700 + 40 * ((B4 + B7)/2 - B5) / (B6 - B5))',{
   
 'B4': R,
 'B5': VRD1,
 'B6': VRD2,
 'B7': VRD2,
 });
// Calcul Sentinel-2 Red-Edge Position Index S2REP

var S2REP = S2.expression(
 '(705 + 35 * ((B4 + B7)/2 - B5) / (B6 - B5))',{
   
 'B4': R,
 'B5': VRD1,
 'B6': VRD2,
 'B7': VRD2,
 });

// Calcul Inverted Red-Edge Chlorophyll Index IRECI

var IRECI = S2.expression(
 '(B7 - B4) / (B5 / B6)',{
   
 'B4': R,
 'B5': VRD1,
 'B6': VRD2,
 'B7': VRD2,
 });


// Calculate NDVI = (B8 - B4)/(B8+ B4)
//var NDVI= année_courante.normalizedDifference(['B8','B4']);
var NDVI = S2.expression(
 '(B8 - B4)/(B8+ B4)',{
   
 'B4': R,
 'B8': NIR,
 });

//cartographie de MTCI Année_courante, année de référence, LTA

Map.addLayer(MTCI.clip(Maroc) ,{min: 1, max: 7, palette: ['d73027','f46d43','fdae61','fee08b','ffffbf','91cf60','27e87a', '1a9850']}, 'mtci', false);
Map.addLayer(NDVI.clip(Maroc),{min: -0.2, max: 0.8, palette: ['d73027','f46d43','fdae61','fee08b','ffffbf','91cf60','27e87a', '1a9850']}, 'ndvi', false);
Map.addLayer(MCARI.clip(Maroc) ,{min: -1, max: 0.002, palette: ['d73027','f46d43','fdae61','fee08b','ffffbf','91cf60','27e87a', '1a9850']}, 'mcari', false);
Map.addLayer(REIP.clip(Maroc),{min: 705, max: 721, palette: ['d73027','f46d43','fdae61','fee08b','ffffbf','91cf60','27e87a', '1a9850']}, 'REIP', false);
Map.addLayer(S2REP.clip(Maroc) ,{min: 705, max: 721, palette: ['d73027','f46d43','fdae61','fee08b','ffffbf','91cf60','27e87a', '1a9850']}, 'S2REP', false);
Map.addLayer(IRECI.clip(Maroc),{min: 0, max: 0.3, palette: ['d73027','f46d43','fdae61','fee08b','ffffbf','91cf60','27e87a', '1a9850']}, 'IRECI', false);


Map.addLayer(olivier, {color: 'FF0000'}, 'olivier');



// création d'une image multibande
  
  var N_stack = MTCI.addBands(NDVI).addBands(MCARI).addBands(REIP)
  .addBands(S2REP).addBands(IRECI);
  
 
// Renommer les noms des bandes
var N_indices = N_stack.select(N_stack.bandNames(), ['MTCI', 'NDVI', 'MCARI', 'REIP', 'S2REP',
'IRECI']);

print(N_indices)
  
 //Province

var N_olive = N_indices.reduceRegions({collection: olive_site, reducer: ee.Reducer.median(),  scale: 20}); 

// Export ---------------------------------------------------------------------
// NDVIp_2003
Export.table.toDrive({
  collection: N_olive,
  description: 'N_olive_1J',
  folder: 'modis_ndvi',
  fileFormat: 'CSV'
});        


// Export the FeatureCollection to a KML file.
//Export.table.toDrive({
//  collection: site_poly,
//  description:'site_poly',
//  fileFormat: 'SHP'});








