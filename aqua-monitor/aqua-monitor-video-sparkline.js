/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var scale = ee.Image("users/gena/AquaMonitor/water_changes_1985_240_2013_48"),
    noise = /* color: d63000 */ee.Geometry.MultiPolygon(
        [[[[95.7568359375, 70.48089578887483],
           [93.515625, 72.12119180464839],
           [93.251953125, 72.0739114882038],
           [95.42724609375, 70.46620742226558]]],
         [[[90.8349609375, 69.7561553934614],
           [91.0546875, 69.78654510363337],
           [88.41796875, 71.3500412872444],
           [88.26416015625, 71.29374720578107]]],
         [[[99.47021484375, 66.40795547978847],
           [101.5576171875, 68.31002672261663],
           [100.4150390625, 70.4367988185464],
           [96.26220703125, 70.31873847853122],
           [92.5048828125, 70.04309814378466],
           [91.69189453125, 69.41124235697256],
           [92.30712890625, 68.15520923883975],
           [92.9443359375, 66.86971519466502],
           [95.09765625, 66.133854089549]]],
         [[[132.088623046875, 52.46939684276206],
           [132.1820068359375, 52.54963607438228],
           [132.308349609375, 52.70634714950863],
           [132.3468017578125, 52.84259457223949],
           [132.2698974609375, 52.87907622876888],
           [132.3028564453125, 52.948637884883205],
           [132.4456787109375, 53.02469631686729],
           [132.637939453125, 53.11710851455023],
           [133.0499267578125, 54.05616356873161],
           [129.4024658203125, 54.13347814286039],
           [129.74853515625, 53.51418452077113],
           [131.055908203125, 52.90227586168311],
           [132.1710205078125, 52.89896238858777],
           [132.1435546875, 52.80940281068805],
           [131.9403076171875, 52.48947038534303]]],
         [[[132.5830078125, 54.61661705439048],
           [133.8134765625, 55.021724521530594],
           [134.395751953125, 56.49889156789073],
           [134.208984375, 58.16490792851806],
           [131.561279296875, 58.17649609452154],
           [127.430419921875, 56.401744392758964],
           [127.6171875, 55.912272930063615],
           [129.814453125, 54.788017348178926],
           [131.484375, 54.749990970226925]]],
         [[[129.287109375, 65.54936668811528],
           [128.7158203125, 66.7745857647255],
           [128.759765625, 67.59247495012802],
           [129.0673828125, 68.5924865825295],
           [129.4189453125, 69.58056349224898],
           [127.1337890625, 69.64180371719553],
           [126.3427734375, 67.7760253890732],
           [126.650390625, 66.33750501996519],
           [128.2763671875, 65.36683689226321]]],
         [[[142.00602408104987, 65.2533392722745],
           [140.27505257483745, 67.1263836724522],
           [138.16687512300223, 68.09737360595437],
           [137.427978515625, 67.79679286550042],
           [137.900390625, 67.067433351083],
           [138.2080078125, 65.87472467098549],
           [138.8671875, 65.10914820386473],
           [140.4931640625, 64.56731900988225]]],
         [[[-50.800783250000165, 55.97379820507665],
           [-15.719299365190409, 63.08027821242223],
           [-6.855470750000222, 81.69784444971418],
           [-79.8798762022256, 83.29518769984901],
           [-126.82617587500033, 74.16408546675687],
           [-70.83984575000017, 75.78054535323862],
           [-61.611328125, 74.913708156753]]],
         [[[-67.91748046875, 70.34831755984781],
           [-70.3564453125, 71.24435551310671],
           [-78.93691099123839, 76.68778101358659],
           [-91.08978701746162, 76.07215139289495],
           [-82.59521484375, 69.93030017617484],
           [-74.46533203125, 68.48798437299908],
           [-70.15869140625, 67.26355190165563]]],
         [[[-84.814453125, 65.54027041907463],
           [-84.96826171875, 64.90491004905083],
           [-84.26513671875, 64.44437240555092],
           [-82.37548828125, 64.26368374017734],
           [-80.52978515625, 64.98865082457425]]],
         [[[-84.19921875, 68.43958884179992],
           [-85.3857421875, 68.67254350285471],
           [-86.98974609375, 67.6343168308615],
           [-86.572265625, 67.09310451852075],
           [-85.0341796875, 67.48333834982645]]],
         [[[-75.95947265625, 65.52206835254366],
           [-76.83837890625, 65.5129625532949],
           [-78.06884765625, 64.61445899874353],
           [-77.255859375, 64.20637724320852],
           [-76.1572265625, 64.35893097894458]]],
         [[[-71.25732421875, 62.73460087706359],
           [-69.3896484375, 63.03503931552975],
           [-66.33544921875, 66.08045694353868],
           [-68.642578125, 66.46943736242146],
           [-71.455078125, 63.411197723659235],
           [-71.2353515625, 62.80497854914798]]],
         [[[-69.9169921875, 60.73768583450925],
           [-73.564453125, 62.88520467163244],
           [-77.6513671875, 63.975960909183385],
           [-77.62939453125, 61.386197865704695],
           [-75.43212890625, 59.98799763121222],
           [-73.30078125, 59.22093407615045],
           [-71.279296875, 60.14150473479339]]],
         [[[-134.40673828125, 64.51064316846676],
           [-134.75830078125, 65.23830662451157],
           [-135.41748046875, 65.33017791526855],
           [-137.98828125, 65.43086722230728],
           [-138.49365234375, 66.70951301313733],
           [-140.34889061841147, 66.86328521632866],
           [-142.20703125, 65.54936668811528],
           [-144.744873046875, 65.51751585017615],
           [-145.799560546875, 64.9188850328549],
           [-144.832763671875, 64.21593657413428],
           [-141.185302734375, 63.47505152377611],
           [-136.702880859375, 63.690117922947515]]],
         [[[-137.30712890625, 59.98250201795759],
           [-135.758056640625, 59.84481485969105],
           [-134.560546875, 60.500525410511315],
           [-132.49715000302842, 61.15476785068821],
           [-137.098388671875, 62.29347354705664],
           [-137.5927734375, 62.608508075133734],
           [-141.3720703125, 63.084813777017395],
           [-142.899169921875, 63.05495931065108],
           [-144.085693359375, 62.375090868569195],
           [-143.41552734375, 61.944118091023746],
           [-143.382568359375, 60.694695372877476],
           [-142.53662109375, 60.59236229839579],
           [-140.25146484375, 60.70544838111038]]],
         [[[-167.266845703125, 59.706555811426135],
           [-167.1240234375, 60.07306302517328],
           [-167.3822021484375, 60.29974250173089],
           [-168.365478515625, 60.48158544292342],
           [-168.85986328125, 60.06484046010452],
           [-168.4478759765625, 59.75362815131911],
           [-167.4700927734375, 59.7037847864095]]],
         [[[-70.653076171875, 53.61532092575061],
           [-70.4168701171875, 54.178511788181325],
           [-70.29052734375, 54.537019638851795],
           [-70.751953125, 54.6992335284814],
           [-71.1199951171875, 54.08517342088679],
           [-71.47705078125, 53.48804553605621],
           [-72.158203125, 52.093007639638245],
           [-71.795654296875, 52.045734040341316]]],
         [[[24.7357177734375, 60.721571151655816],
           [26.334228515625, 60.82884973756657],
           [28.0535888671875, 61.35198012139041],
           [28.663330078125, 62.431074232920906],
           [28.740234375, 63.675505883656584],
           [25.77392578125, 63.792191443824485],
           [22.4395751953125, 61.00773834903184],
           [20.9454345703125, 61.044991332276346],
           [19.75341796875, 60.59775635343141],
           [20.4345703125, 59.52874722863427],
           [21.97265625, 59.32758544549428],
           [23.8238525390625, 59.56215805601119]]],
         [[[28.135986328125, 59.65664225341024],
           [28.4326171875, 59.78405142812333],
           [28.861083984375, 59.82273188377389],
           [29.256591796875, 59.85585085709834],
           [29.3280029296875, 59.91648345450877],
           [29.564208984375, 60.0017326727934],
           [29.959716796875, 60.094979847052144],
           [29.77294921875, 60.19888593179812],
           [29.2071533203125, 60.24253770324797],
           [28.2183837890625, 60.02095215374802],
           [26.883544921875, 59.684381187518156],
           [26.839599609375, 59.50366735715106],
           [27.3614501953125, 59.47856883192639],
           [28.1414794921875, 59.50087955346417]]],
         [[[96.0205078125, 51.67936786087718],
           [96.778564453125, 51.883272964437474],
           [95.82275390625, 52.34205163638784],
           [95.064697265625, 52.38901106223458],
           [94.515380859375, 52.52958999943302],
           [93.955078125, 52.92215137976296],
           [93.328857421875, 52.87576098184731],
           [93.394775390625, 52.335339071889386],
           [94.3505859375, 52.10650519075632],
           [95.625, 51.801821500783056]]],
         [[[97.349853515625, 52.83595824834852],
           [97.613525390625, 52.032218104145294],
           [97.470703125, 50.51342652633956],
           [98.250732421875, 50.324422739309384],
           [98.997802734375, 50.59021193935192],
           [99.173583984375, 51.50190410761811],
           [99.4921875, 51.57024144581124],
           [99.7119140625, 51.34433866059924],
           [100.21728515625, 50.98609893339354],
           [101.239013671875, 51.6248374617432],
           [102.359619140625, 51.78823192706476],
           [101.656494140625, 52.59637465946704],
           [100.92041015625, 53.45534913802113],
           [98.865966796875, 53.87196345747181],
           [95.5810546875, 54.62933821655576],
           [94.713134765625, 54.39335222384589],
           [94.74609375, 53.86548550842128],
           [94.2626953125, 53.45534913802113],
           [94.94384765625, 53.3177490474909],
           [95.921630859375, 53.05442186546102]]],
         [[[125.04638671875, 53.68369534495075],
           [126.5625, 53.87844040332884],
           [127.9248046875, 53.48804553605621],
           [128.12255859375, 53.86548550842128],
           [127.11181640625, 54.521081495443596],
           [125.595703125, 55.07836723201514],
           [124.0576171875, 54.686534234529695],
           [122.98095703125, 56.26776108757582],
           [120.76171875, 57.7041472343419],
           [117.66357421875, 58.893295755879514],
           [115.9716796875, 58.321029869251966],
           [116.1474609375, 57.338381265528966],
           [118.125, 55.801280971180454],
           [119.42138671875, 56.98091142454479],
           [119.091796875, 53.86548550842128],
           [119.11376953125, 51.56341232867588],
           [120.52001953125, 50.20503326494332],
           [122.080078125, 51.69979984974196]]],
         [[[151.32568359375, 61.433514513299485],
           [151.50146484375, 61.78870733190915],
           [150.545654296875, 62.02668187811478],
           [149.996337890625, 61.88204837973591],
           [149.83154296875, 61.76792628648649],
           [150.99609375, 61.37567331572747]]],
         [[[150.09521484375, 62.226996036319754],
           [149.65576171875, 62.46664555258511],
           [148.86474609375, 62.27303454787818],
           [149.095458984375, 61.8665112570728],
           [149.3701171875, 61.80947433658818],
           [149.490966796875, 61.95961583829658]]],
         [[[158.214111328125, 61.80947433658818],
           [159.620361328125, 62.201388691814294],
           [161.026611328125, 62.492027730426905],
           [161.971435546875, 62.890211535509664],
           [162.9052734375, 63.33734318229696],
           [162.652587890625, 64.11060221954631],
           [161.630859375, 64.21115732127653],
           [159.8291015625, 63.74363097533545],
           [158.9501953125, 62.89521754488204],
           [156.785888671875, 62.573105784499774],
           [155.80810546875, 61.53840616716745],
           [156.29150390625, 61.28607149103046]]],
         [[[162.3779296875, 61.74193022461818],
           [162.39990234375, 62.11929912110062],
           [160.301513671875, 61.70029083832628],
           [161.03759765625, 61.30190220337446]]],
         [[[11.29119873046875, 46.89210855010365],
           [11.37908935546875, 47.09817500706038],
           [11.16485595703125, 47.284818765649284],
           [10.71441650390625, 47.04018214480667],
           [10.70068359375, 46.78313532151751],
           [11.0906982421875, 46.76808718675661]]],
         [[[12.3980712890625, 46.758679967095574],
           [12.60406494140625, 46.87709089874481],
           [12.804350675098249, 46.85097936981182],
           [13.03802490234375, 46.98212617904094],
           [12.908935546875, 47.1355562723592],
           [12.337646484375, 47.11313066447019],
           [11.51092529296875, 46.73797830155204],
           [11.38458251953125, 46.502173483540716],
           [11.63726806640625, 46.47002468938531]]],
         [[[55.21728515625, 68.17155518732503],
           [56.9970703125, 69.17818443567214],
           [52.93212890625, 69.64180371719553],
           [50.29541015625, 68.55235079759059],
           [50.29541015625, 67.99934114512355],
           [53.525390625, 67.91688129785506]]],
         [[[121.57470703125, 73.75735240210412],
           [126.298828125, 74.3014092218982],
           [121.00372984397836, 75.15944738422974],
           [114.5654296875, 75.4585892414553],
           [112.91748046875, 74.93656682526164],
           [112.56591796875, 74.77584300649237],
           [114.169921875, 74.35482803013984],
           [115.99365234375, 74.78737860165961],
           [114.63134765625, 74.07992472707889],
           [118.27880859375, 73.70194774691714],
           [119.42138671875, 73.52839948765174]]],
         [[[133.330078125, 71.48308562053703],
           [138.251953125, 73.1758971742261],
           [140.361328125, 73.83705790733424],
           [141.8115234375, 74.1160468394894],
           [144.228515625, 73.56573904345419],
           [141.064453125, 72.72495784202393],
           [151.69921875, 74.3192352189468],
           [155.126953125, 76.39331166244496],
           [146.1181640625, 77.29320180280091],
           [134.912109375, 76.63922560965885],
           [124.4091796875, 74.52575231463916],
           [125.650634765625, 73.89811065820952],
           [127.08984375, 73.36249421421914],
           [128.067626953125, 73.3719282862579],
           [128.594970703125, 73.10579967373414],
           [129.1497802734375, 72.64156989646774],
           [129.122314453125, 72.32746220331909],
           [128.155517578125, 72.46203877644956],
           [127.562255859375, 72.41231171605129],
           [127.08984375, 72.36244812858165],
           [127.59521484375, 72.0908111817211],
           [130.18798828125, 71.53187073776816]]],
         [[[171.134033203125, 60.51675086553633],
           [173.353271484375, 60.925093815014655],
           [176.824951171875, 62.083314862947944],
           [178.736572265625, 62.54272737585266],
           [178.681640625, 63.213829705155625],
           [176.15478515625, 63.616982339758295],
           [174.61669921875, 63.342272727869],
           [172.869873046875, 63.06491420208558],
           [172.979736328125, 63.28306240110864],
           [174.364013671875, 63.966318784384235],
           [172.869873046875, 64.13936944203154],
           [170.518798828125, 63.79704289805786],
           [166.629638671875, 60.94644199944751],
           [167.607421875, 60.764525674175374],
           [169.4091796875, 60.76989094827325],
           [170.068359375, 60.66241476534369],
           [170.17822265625, 61.05828537037917]]],
         [[[165.618896484375, 64.57203668350101],
           [167.222900390625, 65.78475783804785],
           [166.585693359375, 66.38596097983562],
           [167.3876953125, 66.27127767491217],
           [169.573974609375, 66.5482634621744],
           [171.947021484375, 67.35678538806071],
           [171.6943359375, 67.5337715714045],
           [170.0244140625, 68.06509825098964],
           [167.84912109375, 68.48395536734631],
           [167.310791015625, 68.45573219584728],
           [168.046875, 67.69694069305432],
           [167.49755859375, 67.71361226740302],
           [167.047119140625, 67.75939813204413],
           [165.728759765625, 67.75108007583425],
           [166.717529296875, 67.46229284609464],
           [166.761474609375, 67.18699968023049],
           [165.992431640625, 66.99025646736109],
           [166.058349609375, 66.83948674792073],
           [166.585693359375, 66.39915999849539],
           [164.498291015625, 66.34191397701721],
           [161.224365234375, 66.28453710088559],
           [161.224365234375, 65.95094930095703],
           [161.949462890625, 65.78025122941293],
           [162.39990234375, 65.60387765860433],
           [161.795654296875, 65.61295172126665],
           [160.59814453125, 65.87023380203186],
           [160.015869140625, 65.70803822968016],
           [161.12548828125, 65.06286750655634],
           [161.510009765625, 64.3541764315921],
           [163.157958984375, 63.74363097533545],
           [163.7841796875, 63.78248603116502],
           [164.058837890625, 64.36843760829052]]],
         [[[172.012939453125, 66.03587344492607],
           [171.705322265625, 66.19600891267761],
           [171.112060546875, 65.93303449689425],
           [171.441650390625, 65.80277639340238]]],
         [[[-176.759033203125, 66.38596097983562],
           [-176.5283203125, 66.99884379185184],
           [-179.67041015625, 67.25505812564363],
           [-178.30810546875, 68.28565146003619],
           [-179.7802734375, 68.85559244803395],
           [177.528076171875, 69.08033463864336],
           [175.58349609375, 69.166465590243],
           [173.14453125, 68.74435062211467],
           [173.023681640625, 68.44362575999952],
           [174.13330078125, 67.5421666883853],
           [174.671630859375, 66.83948674792073],
           [174.5068359375, 65.5766364488888]]],
         [[[-168.486328125, 66.07154649351564],
           [-172.3974609375, 67.22105296735408],
           [-177.451171875, 65.25670649344259],
           [-173.0126953125, 63.09475846224106],
           [-170.5078125, 63.194018438087845],
           [-172.3095703125, 64.14895190024562]]],
         [[[-69.697265625, -55.89995614406812],
           [-69.334716796875, -54.788017348178926],
           [-69.3017578125, -54.438102809740165],
           [-71.246337890625, -53.54683559190011],
           [-72.61962890625, -51.34433866059923],
           [-72.7294921875, -50.1909677655856],
           [-72.66357421875, -49.553725513475776],
           [-72.454833984375, -49.14578361775003],
           [-72.0263671875, -48.327039130634766],
           [-71.949462890625, -47.798396672955235],
           [-71.78466796875, -47.36859434521338],
           [-71.817626953125, -47.025206001585374],
           [-71.78466796875, -46.65697731621612],
           [-71.773681640625, -45.89765453434689],
           [-71.9384765625, -45.66012730272194],
           [-71.817626953125, -44.96479793033101],
           [-71.927490234375, -44.134913443750726],
           [-71.488037109375, -43.59630591596548],
           [-71.30126953125, -42.20410749373318],
           [-71.202392578125, -41.50034959128927],
           [-71.34521484375, -39.73253798438172],
           [-71.43310546875, -39.18969082109678],
           [-72.31201171875, -40.15368685779403],
           [-72.432861328125, -40.58475654701268],
           [-72.7130126953125, -41.207588981810225],
           [-72.57568359375, -41.86956082699456],
           [-72.5042724609375, -42.15118709351197],
           [-72.6416015625, -42.51260171573666],
           [-72.8778076171875, -42.92827401776912],
           [-72.8009033203125, -43.09296067711628],
           [-72.8173828125, -43.28520334369382],
           [-72.8887939453125, -43.48481212891602],
           [-72.8009033203125, -43.782992628905795],
           [-72.9327392578125, -43.99676629896823],
           [-74.212646484375, -44.35527821160296],
           [-74.498291015625, -44.42201131423663],
           [-74.4049072265625, -44.77013681219716],
           [-74.564208984375, -45.46783598133374],
           [-74.9432373046875, -45.84028105450087],
           [-75.2838134765625, -46.18743678432542],
           [-75.7672119140625, -46.52485531103341],
           [-75.860595703125, -46.95401192579361],
           [-75.0421142578125, -46.95776134668865],
           [-74.564208984375, -46.91275095637892],
           [-74.44061279296875, -46.82449601026204],
           [-74.40216064453125, -46.719151706041224],
           [-74.168701171875, -46.68901548485151],
           [-74.03411865234375, -46.713502445999936],
           [-74.00390625, -46.77184961467733],
           [-74.07806396484375, -46.92025531537452],
           [-74.02587890625, -46.97088225099077],
           [-74.05609130859375, -47.008352816937034],
           [-74.4158935546875, -47.02707824931894],
           [-74.56695556640625, -47.35371061951362],
           [-74.8828125, -47.619124098197304],
           [-75.443115234375, -47.76702233051034],
           [-75.69854736328125, -48.195387408333374],
           [-75.750732421875, -48.77067246880508],
           [-75.8551025390625, -49.53946900793533],
           [-75.8111572265625, -50.62855775525791],
           [-75.52001953125, -51.82898836366912],
           [-75.1904296875, -52.95525697845466],
           [-73.80615234375, -54.15600109028491],
           [-71.69677734375, -55.31976875501021]]],
         [[[-109.57763671875, 71.61521389461222],
           [-109.35791015625, 71.86306997499314],
           [-109.84130859375, 72.23551372557404],
           [-112.30224609375, 72.21539079680856],
           [-113.88427734375, 71.8219859969296],
           [-113.75244140625, 71.42717893107371],
           [-113.203125, 71.30079291637452],
           [-111.37939453125, 71.52490903732816]]],
         [[[-122.7777099609375, 73.93767449179174],
           [-121.124267578125, 73.72967302053397],
           [-120.531005859375, 73.84928645675248],
           [-120.4156494140625, 74.04221243722003],
           [-121.981201171875, 74.44493890136494],
           [-123.0908203125, 74.44051907759072],
           [-124.1949462890625, 74.37407456738714],
           [-124.3377685546875, 74.28207543207257]]],
         [[[178.2147216796875, 70.96865539856438],
           [178.4454345703125, 70.75072302031474],
           [179.8681640625, 70.72716643272548],
           [-178.297119140625, 70.83926448002445],
           [-177.42919921875, 71.10610062134981],
           [-177.9620361328125, 71.36233382140517],
           [-178.5003662109375, 71.49878009764515],
           [-178.8134765625, 71.53882990638357],
           [-179.2034912109375, 71.53187073776816],
           [-179.7857666015625, 71.52490903732816],
           [179.93408203125, 71.45165811785856],
           [179.5001220703125, 71.4586464518894]]],
         [[[-141.95709228515625, 68.37085098819867],
           [-139.45585783146782, 68.61326776662716],
           [-138.944091796875, 68.9781050031802],
           [-140.020751953125, 69.53835857874444],
           [-141.185302734375, 69.36870264876849],
           [-142.71240234375, 69.565225901491],
           [-144.03076171875, 69.53067599275342],
           [-144.678955078125, 69.67998950911426],
           [-145.228271484375, 69.74094412836399],
           [-145.338134765625, 69.61120561869633],
           [-145.634765625, 69.48837239932325],
           [-146.40380859375, 69.39191653683379],
           [-147.117919921875, 69.29891084475162],
           [-147.98583984375, 69.22109966424794],
           [-147.81005859375, 69.0567854089922],
           [-148.095703125, 68.86747821724371],
           [-148.590087890625, 68.61252762353008],
           [-149.227294921875, 68.45169743691484],
           [-150.4248046875, 68.50811862333943],
           [-150.75439453125, 68.13066848687792],
           [-149.30419921875, 67.95814786101579]]],
         [[[-136.922607421875, 67.51277075847912],
           [-136.5380859375, 67.11020352269666],
           [-136.219482421875, 66.25358757512083],
           [-135.615234375, 65.9195901580262],
           [-135.15380859375, 66.05371622067922],
           [-135.087890625, 66.15606976270817],
           [-135.516357421875, 66.50888160186884],
           [-135.59326171875, 66.95587684341999],
           [-135.692138671875, 67.38637455894808],
           [-135.615234375, 67.89622050259646],
           [-135.670166015625, 68.04867651098903],
           [-136.25244140625, 68.19197126323203],
           [-136.6259765625, 68.3140867336998],
           [-136.9775390625, 68.51214331858073],
           [-137.57080078125, 68.40322416624196],
           [-137.724609375, 68.05278304131106],
           [-137.74658203125, 67.65103282074831],
           [-137.26318359375, 67.55475378638546]]],
         [[[62.9296875, 70.08056215839737],
           [66.796875, 72.44879155730672],
           [69.78515625, 73.77577986189993],
           [72.7734375, 74.06786624952264],
           [77.080078125, 73.72659470212254],
           [81.03515625, 74.1160468394894],
           [83.3203125, 74.68325030051864],
           [95.09765625, 77.42782352730111],
           [106.44663094404018, 77.94553885921901],
           [108.78766808981106, 77.21485767383132],
           [116.31457151400184, 76.22715954821008],
           [120.34972406325153, 76.45787450872415],
           [98.61328125, 81.54415925941508],
           [67.67578125, 78.45542534118533],
           [56.953125, 77.61770905279676],
           [46.40625, 74.21198251594369],
           [46.40625, 71.52490903732816],
           [51.15234375, 70.37785394109227],
           [56.25, 70.14036427207171],
           [58.7109375, 70.90226826757711]]],
         [[[5.178680419921875, 5.605052121404784],
           [5.18829345703125, 5.606418844830032],
           [5.21575927734375, 5.6187192115515465],
           [5.195159912109375, 5.576350191571288],
           [5.174560546875, 5.547646857881998],
           [5.185546875, 5.51620827103881],
           [5.206146240234375, 5.483401012975597],
           [5.230865478515625, 5.513474402007618],
           [5.2679443359375, 5.569516191569189],
           [5.28167724609375, 5.7184792043553365],
           [5.38604736328125, 6.029945016071819],
           [5.37506103515625, 6.25387182486021],
           [5.153961181640625, 6.296188782911237],
           [5.104522705078125, 6.25660205479493],
           [5.1031494140625, 6.192437893691238],
           [5.08941650390625, 6.150112578753815],
           [5.064697265625, 6.084569967945615],
           [5.077056884765625, 5.961656095137535],
           [5.104522705078125, 5.8141231418985],
           [5.130615234375, 5.6993484895144695],
           [5.148468017578125, 5.625552636402149]]],
         [[[5.442352294921875, 5.101887070062321],
           [5.33935546875, 5.066321981043081],
           [5.305023193359375, 4.9007819961205135],
           [5.33935546875, 4.725620698589213],
           [5.535736083984375, 4.770783772016471],
           [5.997161865234375, 4.861100978309971],
           [6.0809326171875, 4.893940608902126],
           [5.587921142578125, 5.1278756972037245]]],
         [[[6.767578125, 5.37539777447476],
           [6.229248046875, 5.267375376100507],
           [6.150970458984375, 5.240024939514719],
           [6.1358642578125, 5.186688149704451],
           [6.68243408203125, 5.074529483496559]]]]),
    scaleLand = ee.Image("users/gena/AquaMonitor/water_changes_1985_240_2013_48_land_300m"),
    scaleWater = ee.Image("users/gena/AquaMonitor/water_changes_1985_240_2013_48_water_300m"),
    ne = ee.Image("users/gena/NE1_HR_LC_SR_W"),
    flowAccumulation = ee.Image("WWF/HydroSHEDS/15ACC"),
    vs_dubai = /* color: 98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[55.038878001123635, 24.85529177364027],
                  [55.14862060546875, 24.68695241199918],
                  [55.3436279296875, 25.10549737301469],
                  [55.5413818359375, 25.3688458240828],
                  [55.90118408203125, 25.45319497952489],
                  [55.82427978515625, 25.527571660479637],
                  [55.82573451039116, 25.616698932775044],
                  [55.793508181898915, 25.629127911963337],
                  [55.5908203125, 25.792472545052068],
                  [54.806671142578125, 25.04081549894912],
                  [54.7998046875, 24.930030819509216],
                  [54.8876953125, 24.91633140459907]]]),
            {
              "system:index": "0"
            })]),
    vs_yellowsea = /* color: 0B4A8B */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[119.9667864169121, 34.06099983193963],
                  [120.69797855102343, 32.55314828034542],
                  [121.29825359944243, 32.058554956670335],
                  [121.83305477155432, 31.661950466626028],
                  [122.06924565225154, 31.63376319605038],
                  [121.07413026358051, 32.77624084727284],
                  [120.58490415484914, 33.7334480673562],
                  [120.21059911115321, 34.54083477800101],
                  [119.38832491843596, 34.975442672254715],
                  [120.02571219868923, 35.610010053235854],
                  [121.02545955361165, 36.350122923735995],
                  [122.58014678392306, 36.85840983182864],
                  [122.80544849310559, 37.50073225706402],
                  [121.58977237107399, 37.73534973542739],
                  [120.73978591651564, 38.06518739823335],
                  [119.42127764361703, 37.30871913721531],
                  [119.1934431432079, 37.454248885435554],
                  [119.39690053086213, 37.80563285218114],
                  [118.84225556592855, 38.3774975191143],
                  [118.33062218970178, 38.30009597229435],
                  [117.83905419087796, 38.65105427478521],
                  [117.96600493648793, 38.907733171769294],
                  [118.47106615492658, 38.83909345633572],
                  [119.20741160858347, 39.25514795943834],
                  [119.64574723717101, 39.73147585109893],
                  [120.5181131830168, 40.13698559373588],
                  [121.2148650264462, 40.75483552624152],
                  [121.68426994137621, 40.70472675425918],
                  [122.02002200684569, 40.453185807329454],
                  [121.22839085511782, 39.69140419858109],
                  [121.05567459794759, 39.389544587454886],
                  [121.34393992744492, 39.15556608193043],
                  [120.9640006481892, 38.95910122431531],
                  [121.05840041352735, 38.65963939552216],
                  [122.10294382382381, 38.91273752198012],
                  [122.78043466648035, 39.19370064326876],
                  [123.17738681336232, 39.5396132089709],
                  [123.55564870151761, 39.78253181684751],
                  [124.45585280691955, 39.5701039299141],
                  [125.09037091371079, 39.37124119693306],
                  [124.93461190521907, 38.87242707648341],
                  [124.59635363063194, 38.39321831518916],
                  [124.52165900674527, 37.850117785739485],
                  [125.27289785002517, 37.595325876644445],
                  [125.91352812009359, 37.771047867220304],
                  [126.27566698274791, 37.52672635142222],
                  [126.32789261074345, 37.15106169966175],
                  [126.02853287485436, 36.7664394336356],
                  [126.43179485573228, 36.061956450038025],
                  [125.47532065486507, 34.38816866673617],
                  [126.38730225227641, 34.19754616928131],
                  [126.94769519634997, 35.80839849549581],
                  [126.73594912920646, 36.57053644918856],
                  [127.05228602607724, 36.90854902024525],
                  [126.41685074448105, 37.901893903531324],
                  [125.70615202162492, 38.16023244370411],
                  [125.09925941549102, 38.32379279858557],
                  [125.64020482219439, 38.697923900271896],
                  [125.36937804490299, 38.96897095968736],
                  [125.64720186701652, 39.69225908057712],
                  [124.51955292492323, 40.052861775892694],
                  [123.29633339923885, 39.9478962203509],
                  [122.34506272968929, 39.529240811143204],
                  [121.69570594699292, 39.61414416185594],
                  [122.25748367228493, 40.18110897599033],
                  [122.81676834141774, 40.67707121425322],
                  [122.42944913661438, 41.0655651694119],
                  [121.72866078829429, 41.38521829849187],
                  [120.96001038316865, 41.08101846017138],
                  [120.43553197452434, 40.823042673931035],
                  [119.35810870123487, 40.015235940953886],
                  [118.67026243874125, 39.47966418610779],
                  [117.96216819694985, 39.49681672902784],
                  [117.15781372891911, 39.21515000814097],
                  [116.98664069326924, 38.625872911163505],
                  [117.38514070766837, 38.15661571315012],
                  [117.86641777717273, 37.72001429296746],
                  [118.34402979130618, 37.594024386947176],
                  [118.4448696260398, 37.17999588748002],
                  [118.78526754280313, 36.85307641751715],
                  [119.71365222101008, 36.794017709007974],
                  [120.33865810543182, 37.41586274859616],
                  [121.36484909935143, 37.15315325750721],
                  [119.77979214455422, 36.38101305736247],
                  [118.8829031545165, 34.741026236676134]]]),
            {
              "system:index": "0"
            })]),
    vs_ganges = /* color: ffc82d */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[88.19848230804894, 21.463364958901497],
                  [88.76973155665848, 21.463363039660663],
                  [89.53872093093958, 21.545128923747523],
                  [90.14292647396906, 21.64727322015637],
                  [90.86797254848625, 21.76975246319972],
                  [91.60400138434738, 22.187428366743642],
                  [91.57494716730673, 22.50158770300682],
                  [91.41353904086554, 22.93746324919442],
                  [90.75811026745453, 23.34218929585309],
                  [90.46071559240386, 23.248978578178914],
                  [90.3784989501072, 22.81776385210438],
                  [90.03612827651148, 22.7843594827965],
                  [89.58433500854176, 22.6689353421845],
                  [88.96793475278082, 22.419561451346937],
                  [88.26440061247786, 22.512552856060005],
                  [87.82979579214475, 22.420420171068105],
                  [88.04719986714576, 22.10991002495347],
                  [87.87990130109392, 21.514476154842832]]]),
            {
              "system:index": "0"
            })]),
    vs_taji_najer = /* color: 00ffff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[92.87872603320204, 37.96340239513089],
                  [93.10659012730866, 37.876770216974954],
                  [93.18215701918143, 37.774773690896204],
                  [93.18619363743653, 37.6553950265681],
                  [93.30424406040765, 37.54448603490283],
                  [93.4936401100141, 37.54014183903644],
                  [93.65570548832034, 37.51409264855658],
                  [93.85057459687175, 37.38539107860945],
                  [94.12205414348523, 37.34286904603626],
                  [94.19374642547746, 37.457344397033424],
                  [93.88677126579978, 37.62851905446607],
                  [93.57878137373882, 37.703196382077124],
                  [93.39106976106132, 37.877810814838796],
                  [93.2520839452859, 38.0499169309407],
                  [93.0618745873353, 38.088501602263094],
                  [92.86619479732747, 38.09655638316788],
                  [92.8395071252354, 38.02132523988708]]]),
            {
              "system:index": "0"
            })]),
    vs_korea = /* color: bf04c2 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[126.8096923828125, 38.48261976950729],
                  [126.80557250976562, 38.447135775082444],
                  [126.81793212890625, 38.42454596250916],
                  [126.79046630859375, 38.42669767774885],
                  [126.76437377929688, 38.38688056984749],
                  [126.77536010742188, 38.35027253825765],
                  [126.83578491210938, 38.35350340353833],
                  [126.86599731445312, 38.39441521865828],
                  [126.8646240234375, 38.42777351132905],
                  [126.8536376953125, 38.45681495946778],
                  [126.89620971679688, 38.489069529053474],
                  [126.84814453125, 38.50948995925553]]]),
            {
              "system:index": "0"
            })]),
    vs_myanmar = /* color: ff0000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[92.55116023872108, 20.013104796967443],
                  [93.20844752239282, 19.668903346054194],
                  [93.51039030684353, 18.70235874729017],
                  [94.24475704447582, 17.827472374439548],
                  [93.96572021094403, 16.3663799373633],
                  [94.02057378393204, 15.780659221541992],
                  [94.55742035716435, 15.49034856985479],
                  [95.66431216864567, 15.57447088158256],
                  [96.46811095468911, 16.140690426191153],
                  [97.03137021532154, 16.68209446385884],
                  [97.41896534120497, 16.168908731173754],
                  [97.57843646648973, 15.529891630099296],
                  [97.51793184865414, 14.890861481440316],
                  [97.92141293629675, 13.570083270965345],
                  [98.41710187495653, 13.228201036445196],
                  [98.14033045581687, 12.509842931531459],
                  [98.13425937355487, 10.752481697006138],
                  [98.60939206349542, 9.943837868359195],
                  [98.75800541155547, 10.623138739226611],
                  [99.21744530010255, 11.146207844970972],
                  [99.61260344775724, 11.733341844274554],
                  [99.41618418329676, 12.611341363394569],
                  [99.15265634505613, 13.081577810908746],
                  [99.31711006573983, 13.45591005812945],
                  [99.1300414957102, 13.872956148201505],
                  [98.24842798090458, 14.963294332394765],
                  [98.57484458005922, 15.275205467756562],
                  [98.59448224300809, 15.883542478258265],
                  [98.95637226780184, 16.321090696568717],
                  [98.58047197554299, 16.860576931676412],
                  [97.91617482303536, 17.427723533119543],
                  [97.51125095589555, 18.286729454666165],
                  [97.73384255236567, 18.531576671194],
                  [98.06401164789077, 19.63005879664455],
                  [98.98654849391096, 19.754166368303796],
                  [100.17263137333032, 20.414352440306914],
                  [100.69971547880164, 21.481040284007715],
                  [100.26042243675943, 21.52188684283011],
                  [99.99682128143695, 21.99106750645029],
                  [99.18413769413223, 22.092826911073214],
                  [99.49159188912154, 23.02586288923589],
                  [98.94248750191002, 23.227829969141727],
                  [98.459262037999, 23.992560995557728],
                  [97.66857913958529, 23.912258563039337],
                  [97.6026821241669, 24.433230526554468],
                  [97.93211511213735, 25.25039008275682],
                  [98.70079981498384, 25.726210532688064],
                  [98.74465828841983, 27.551775509846074],
                  [98.32738290556017, 27.551764723975598],
                  [98.10775121711254, 28.095592581102185],
                  [97.5806683083888, 28.424430428416265],
                  [96.89986203528758, 27.53227649082704],
                  [97.1414444586054, 27.02477041529425],
                  [96.68024164017038, 27.239768481854767],
                  [95.12091110068468, 26.49532905425971],
                  [94.48393747340833, 25.190825035869793],
                  [94.74748466631945, 25.011816107586906],
                  [94.17638241651821, 23.852069311284072],
                  [93.45159326300825, 23.95250606716893],
                  [93.14396835861305, 22.11325623651305],
                  [92.68270879782767, 21.99114234568016],
                  [92.68264903082661, 21.256075188621466],
                  [92.37516201799724, 21.46065814841206],
                  [92.13352772911867, 21.1946923369115],
                  [92.33117028577237, 20.74345618886142]]]),
            {
              "system:index": "0"
            })]),
    vs_aral_lake = /* color: 00ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[58.359375, 45.644768217751924],
                  [58.095703125, 45.058001435398296],
                  [58.02978515625, 44.54350521320822],
                  [58.4033203125, 44.024421519659334],
                  [58.90869140625, 43.8503744993026],
                  [59.34814453125, 43.8503744993026],
                  [59.65576171875, 43.72347489611479],
                  [60.205078125, 43.977004674964085],
                  [60.64453125, 44.30812668488613],
                  [61.01806640625, 44.512176171071054],
                  [61.06201171875, 44.98034238084972],
                  [60.84228515625, 45.67548217560647],
                  [61.01806640625, 46.042735653846506],
                  [61.41357421875, 46.28622391806708],
                  [61.611328125, 46.815098645992435],
                  [60.4248046875, 46.92025531537451],
                  [59.69970703125, 46.619261036171515],
                  [58.68896484375, 46.057985244793024]]]),
            {
              "system:index": "0"
            })]),
    vs_lake_mead = /* color: 0000ff */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[-114.873046875, 36.08462129606931],
                  [-114.8291015625, 36.02911059663187],
                  [-114.77142333984375, 35.99800750540412],
                  [-114.7027587890625, 36.00467348670187],
                  [-114.68353271484375, 36.049098959065645],
                  [-114.6533203125, 36.08018188118015],
                  [-114.56817626953125, 36.117908916563685],
                  [-114.5159912109375, 36.07130229942241],
                  [-114.510498046875, 36.03133177633189],
                  [-114.44732666015625, 36.02466804934357],
                  [-114.378662109375, 36.082401619958524],
                  [-114.37591552734375, 36.04243673532787],
                  [-114.312744140625, 35.99800750540412],
                  [-114.2138671875, 35.98245135784044],
                  [-114.12872314453125, 35.98911865383744],
                  [-114.09027099609375, 36.02022525154813],
                  [-114.08203125, 36.082401619958524],
                  [-114.04083251953125, 36.13787471840729],
                  [-114.027099609375, 36.09127994838079],
                  [-113.9556884765625, 36.09349937380574],
                  [-113.91998291015625, 36.04687828046171],
                  [-113.83209228515625, 36.01578220325809],
                  [-113.7579345703125, 35.93354064249312],
                  [-113.763427734375, 35.85121343450061],
                  [-113.69476318359375, 35.782170703266075],
                  [-113.609619140625, 35.697455807258045],
                  [-113.55743408203125, 35.74205383068035],
                  [-113.5052490234375, 35.860117799832544],
                  [-113.6151123046875, 35.86456960744962],
                  [-113.6700439453125, 35.922420347285055],
                  [-113.73046875, 36.00467348670187],
                  [-113.7689208984375, 36.04243673532787],
                  [-113.87054443359375, 36.12234620030521],
                  [-113.9447021484375, 36.17557404062257],
                  [-113.97491455078125, 36.26199220445664],
                  [-114.0216064453125, 36.268635800737876],
                  [-114.158935546875, 36.12900165569653],
                  [-114.17266845703125, 36.06242171510889],
                  [-114.2193603515625, 36.06686213257888],
                  [-114.32098388671875, 36.15783544102625],
                  [-114.3621826171875, 36.22433448531432],
                  [-114.3402099609375, 36.34167804918316],
                  [-114.2852783203125, 36.40138898484862],
                  [-114.29351806640625, 36.47209813242351],
                  [-114.3182373046875, 36.5471559864337],
                  [-114.3896484375, 36.54274283354783],
                  [-114.44183349609375, 36.50522086338427],
                  [-114.400634765625, 36.43012234551579],
                  [-114.47479248046875, 36.35495110643483],
                  [-114.45831298828125, 36.246488282126535],
                  [-114.52972412109375, 36.18665862660457],
                  [-114.71923828125, 36.1733569352216],
                  [-114.9005126953125, 36.15118243124803]]]),
            {
              "system:index": "0"
            })]),
    vs_singapore = /* color: 999900 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Polygon(
                [[[103.60931396484375, 1.095819417591082],
                  [103.87710571289062, 1.1878116357033526],
                  [104.1229248046875, 1.2331201247998471],
                  [104.1943359375, 1.2427309182355817],
                  [104.09133911132812, 1.3319722944135324],
                  [104.07623291015625, 1.3608034433485081],
                  [104.08996689762455, 1.39958743435059],
                  [104.07348844065609, 1.432879896075835],
                  [104.03366226158232, 1.4502134336233794],
                  [103.98731311629194, 1.4253308676106824],
                  [103.95813050625031, 1.4261030901197935],
                  [103.93341100378439, 1.4306503324907212],
                  [103.91384142432025, 1.4290194772262779],
                  [103.88671875, 1.4335662226731434],
                  [103.86131326915006, 1.465828419764851],
                  [103.81118774414062, 1.4816158541987936],
                  [103.78335678946542, 1.4677591532913787],
                  [103.76239259965973, 1.4532157661571905],
                  [103.74587019259684, 1.45433136496683],
                  [103.7272449166137, 1.4613671714677576],
                  [103.69617462158203, 1.4493540716333067],
                  [103.66870806450879, 1.4217249694071374],
                  [103.65308677099347, 1.4044781623913474],
                  [103.64776532072915, 1.3858584298567347],
                  [103.61618041992188, 1.3278535311439326],
                  [103.58734130859375, 1.205660524693437]]]),
            {
              "system:index": "0"
            })]),
    coastline = ee.Image("users/gena/coastline_buffer_40km");
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// Some ugly hackery to render text
var _0x6469=["\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65","\x31\x36","\x66\x6F\x6E\x74\x53\x69\x7A\x65","\x75\x73\x65\x72\x73\x2F\x67\x65\x6E\x61\x2F\x66\x6F\x6E\x74\x73\x2F\x41\x72\x69\x61\x6C","\x70\x72\x6F\x6A\x65\x63\x74\x69\x6F\x6E","\x73\x63\x61\x6C\x65","\x63\x68\x61\x6E\x67\x65\x50\x72\x6F\x6A","\x68\x65\x69\x67\x68\x74","\x67\x65\x74","\x77\x69\x64\x74\x68","\x63\x65\x6C\x6C\x5F\x68\x65\x69\x67\x68\x74","\x63\x65\x6C\x6C\x5F\x77\x69\x64\x74\x68","\x70\x61\x72\x73\x65","\x4E\x75\x6D\x62\x65\x72","\x6D\x61\x70","\x2C","\x73\x70\x6C\x69\x74","\x63\x68\x61\x72\x5F\x77\x69\x64\x74\x68\x73","\x63\x6F\x6C\x75\x6D\x6E\x73","\x63\x65\x6C\x6C\x57\x69\x64\x74\x68","\x64\x69\x76\x69\x64\x65","\x72\x6F\x77\x73","\x63\x65\x6C\x6C\x48\x65\x69\x67\x68\x74","\x61\x64\x64","\x69\x74\x65\x72\x61\x74\x65","\x73\x6C\x69\x63\x65","","\x70\x69\x78\x65\x6C\x4C\x6F\x6E\x4C\x61\x74","\x49\x6D\x61\x67\x65","\x72\x6F\x75\x6E\x64","\x66\x6C\x6F\x6F\x72","\x73\x65\x6C\x65\x63\x74","\x6C\x74","\x61\x6E\x64","\x67\x74\x65","\x6D\x75\x6C\x74\x69\x70\x6C\x79","\x73\x75\x62\x74\x72\x61\x63\x74","\x74\x72\x61\x6E\x73\x6C\x61\x74\x65","\x6D\x61\x73\x6B","\x63\x68\x61\x72\x57\x69\x64\x74\x68\x73","\x73\x69\x7A\x65","\x73\x65\x71\x75\x65\x6E\x63\x65","\x4C\x69\x73\x74","\x7A\x69\x70","\x6D\x6F\x64","\x63\x6F\x6F\x72\x64\x69\x6E\x61\x74\x65\x73","\x74\x72\x61\x6E\x73\x66\x6F\x72\x6D","\x6D\x6F\x73\x61\x69\x63","\x74\x65\x78\x74\x43\x6F\x6C\x6F\x72","\x66\x66\x66\x66\x66\x66","\x6F\x75\x74\x6C\x69\x6E\x65\x43\x6F\x6C\x6F\x72","\x30\x30\x30\x30\x30\x30","\x6F\x75\x74\x6C\x69\x6E\x65\x57\x69\x64\x74\x68","\x74\x65\x78\x74\x4F\x70\x61\x63\x69\x74\x79","\x74\x65\x78\x74\x57\x69\x64\x74\x68","\x6F\x75\x74\x6C\x69\x6E\x65\x4F\x70\x61\x63\x69\x74\x79","\x76\x69\x73\x75\x61\x6C\x69\x7A\x65","\x66\x6F\x63\x61\x6C\x5F\x6D\x61\x78","\x66\x72\x6F\x6D\x49\x6D\x61\x67\x65\x73","\x49\x6D\x61\x67\x65\x43\x6F\x6C\x6C\x65\x63\x74\x69\x6F\x6E"];var Text={draw:function(_0xc192x2,_0xc192x3,_0xc192x4,_0xc192x5){_0xc192x2=ee.String(_0xc192x2);var _0xc192x6={};for(var _0xc192x7=32;_0xc192x7<128;_0xc192x7++){_0xc192x6[String[_0x6469[0]](_0xc192x7)]=_0xc192x7};_0xc192x6=ee.Dictionary(_0xc192x6);var _0xc192x8=_0x6469[1];if(_0xc192x5&&_0xc192x5[_0x6469[2]]){_0xc192x8=_0xc192x5[_0x6469[2]]};var _0xc192x9=ee.Image(_0x6469[3]+_0xc192x8);var _0xc192xa=_0xc192x9[_0x6469[4]]();_0xc192x9=_0xc192x9[_0x6469[6]](_0xc192xa,_0xc192xa[_0x6469[5]](1,-1));var _0xc192xb={height:ee.Number(_0xc192x9[_0x6469[8]](_0x6469[7])),width:ee.Number(_0xc192x9[_0x6469[8]](_0x6469[9])),cellHeight:ee.Number(_0xc192x9[_0x6469[8]](_0x6469[10])),cellWidth:ee.Number(_0xc192x9[_0x6469[8]](_0x6469[11])),charWidths:ee.String(_0xc192x9[_0x6469[8]](_0x6469[17]))[_0x6469[16]](_0x6469[15])[_0x6469[14]](ee[_0x6469[13]][_0x6469[12]])};_0xc192xb[_0x6469[18]]=_0xc192xb[_0x6469[9]][_0x6469[20]](_0xc192xb[_0x6469[19]]);_0xc192xb[_0x6469[21]]=_0xc192xb[_0x6469[7]][_0x6469[20]](_0xc192xb[_0x6469[22]]);function _0xc192xc(_0xc192x2){return ee.List(_0xc192x2[_0x6469[16]](_0x6469[26])[_0x6469[25]](1)[_0x6469[24]](function(_0xc192xd,_0xc192xe){return ee.List(_0xc192xe)[_0x6469[23]](_0xc192x6[_0x6469[8]](_0xc192xd))},ee.List([])))}function _0xc192xf(_0xc192x10,_0xc192x11,_0xc192x12,_0xc192x13,_0xc192x14,_0xc192x15,_0xc192x16){var _0xc192x17=ee[_0x6469[28]][_0x6469[27]]();var _0xc192x18=_0xc192x17[_0x6469[30]]()[_0x6469[29]]()[_0x6469[6]](_0xc192x17[_0x6469[4]](),_0xc192x10[_0x6469[4]]());var _0xc192x19=_0xc192x18[_0x6469[31]](0);var _0xc192x1a=_0xc192x18[_0x6469[31]](1);var _0xc192x1b=_0xc192x19[_0x6469[34]](_0xc192x11)[_0x6469[33]](_0xc192x19[_0x6469[32]](_0xc192x12))[_0x6469[33]](_0xc192x1a[_0x6469[34]](_0xc192x13))[_0x6469[33]](_0xc192x1a[_0x6469[32]](_0xc192x14));return _0xc192x10[_0x6469[38]](_0xc192x1b)[_0x6469[37]](ee.Number(_0xc192x11)[_0x6469[35]](-1)[_0x6469[23]](_0xc192x15),ee.Number(_0xc192x13)[_0x6469[35]](-1)[_0x6469[36]](_0xc192x16))}var _0xc192x1c=_0xc192xc(_0xc192x2);var _0xc192x1d=_0xc192x1c[_0x6469[14]](function(_0xc192x1e){return ee.Number(_0xc192xb[_0x6469[39]][_0x6469[8]](ee.Number(_0xc192x1e)))});var _0xc192x1f=ee.List(_0xc192x1d[_0x6469[24]](function(_0xc192x20,_0xc192x21){_0xc192x21=ee.List(_0xc192x21);var _0xc192x22=ee.Number(_0xc192x21[_0x6469[8]](-1));var _0xc192x15=_0xc192x22[_0x6469[23]](_0xc192x20);return _0xc192x21[_0x6469[23]](_0xc192x15)},ee.List([0])))[_0x6469[25]](0,-1);var _0xc192x23=_0xc192x1f[_0x6469[43]](ee[_0x6469[42]][_0x6469[41]](0,_0xc192x1f[_0x6469[40]]()));var _0xc192x24=_0xc192x1c[_0x6469[14]](function(_0xc192x1e){_0xc192x1e=ee.Number(_0xc192x1e)[_0x6469[36]](32);var _0xc192x16=_0xc192x1e[_0x6469[20]](_0xc192xb[_0x6469[18]])[_0x6469[30]]()[_0x6469[35]](_0xc192xb[_0x6469[22]]);var _0xc192x15=_0xc192x1e[_0x6469[44]](_0xc192xb[_0x6469[18]])[_0x6469[35]](_0xc192xb[_0x6469[19]]);return [_0xc192x15,_0xc192x16]});var _0xc192x25=_0xc192x24[_0x6469[43]](_0xc192x1d)[_0x6469[43]](_0xc192x23);_0xc192x3=ee.Geometry(_0xc192x3)[_0x6469[46]](_0xc192xa)[_0x6469[45]]();var _0xc192x26=ee.Number(_0xc192x3[_0x6469[8]](0));var _0xc192x27=ee.Number(_0xc192x3[_0x6469[8]](1));var _0xc192x28=ee.ImageCollection(_0xc192x25[_0x6469[14]](function(_0xc192x29){_0xc192x29=ee.List(_0xc192x29);var _0xc192x2a=ee.List(_0xc192x29[_0x6469[8]](0));var _0xc192x2b=ee.Number(_0xc192x2a[_0x6469[8]](1));var _0xc192x2c=ee.List(_0xc192x2a[_0x6469[8]](0));var _0xc192x2d=ee.Number(_0xc192x2c[_0x6469[8]](0));var _0xc192x2e=ee.Number(_0xc192x2c[_0x6469[8]](1));var _0xc192x23=ee.List(_0xc192x29[_0x6469[8]](1));var _0xc192x15=ee.Number(_0xc192x23[_0x6469[8]](0));var _0xc192x7=ee.Number(_0xc192x23[_0x6469[8]](1));var _0xc192x2f=_0xc192xf(_0xc192x9,_0xc192x2d,_0xc192x2d[_0x6469[23]](_0xc192x2b),_0xc192x2e,_0xc192x2e[_0x6469[23]](_0xc192xb[_0x6469[22]]),_0xc192x15,0,_0xc192xa);return _0xc192x2f[_0x6469[6]](_0xc192xa,_0xc192xa[_0x6469[37]](_0xc192x26,_0xc192x27)[_0x6469[5]](_0xc192x4,_0xc192x4))}))[_0x6469[47]]();_0xc192x28=_0xc192x28[_0x6469[38]](_0xc192x28);if(_0xc192x5){_0xc192x5={textColor:_0xc192x5[_0x6469[48]]||_0x6469[49],outlineColor:_0xc192x5[_0x6469[50]]||_0x6469[51],outlineWidth:_0xc192x5[_0x6469[52]]||0,textOpacity:_0xc192x5[_0x6469[53]]||1.0,textWidth:_0xc192x5[_0x6469[54]]||1,outlineOpacity:_0xc192x5[_0x6469[55]]||0.4};var _0xc192x30=_0xc192x28[_0x6469[56]]({opacity:_0xc192x5[_0x6469[53]],palette:[_0xc192x5[_0x6469[48]]],forceRgbOutput:true});if(_0xc192x5[_0x6469[54]]>1){_0xc192x30=_0xc192x30[_0x6469[57]](_0xc192x5[_0x6469[54]])};if(!_0xc192x5||(_0xc192x5&&!_0xc192x5[_0x6469[52]])){return _0xc192x30};var _0xc192x31=_0xc192x28[_0x6469[57]](_0xc192x5[_0x6469[52]])[_0x6469[56]]({opacity:_0xc192x5[_0x6469[55]],palette:[_0xc192x5[_0x6469[50]]],forceRgbOutput:true});return ee[_0x6469[59]][_0x6469[58]](ee.List([_0xc192x31,_0xc192x30]))[_0x6469[47]]()}else {return _0xc192x28}}}
// Some minified javascript pasted in (lack of modules), exports several functions
function createTimeBand(e){
  var a=ee.Date(e.get("system:time_start")),t=a.get("year").subtract(1970);return ee.Image(t)["byte"]().addBands(e)}function getWaterTrendChangeRatio(e,a){return 15/(a-e)}function renderWaterTrend(e){function a(a){var t=z.gt(v),r=C.lt(g);if(e.debugMapLayers){var s=x.unmask().abs().gt(a),d=x.mask(s).visualize({min:-n*i,max:n*i,palette:["00ff00","000000","00d8ff"]});Map.addLayer(d,{},"scale thresholded, unmasked",!1)}var o=x.unmask().abs().gt(a).multiply(t).multiply(r);if(m>-1){var c=E.lt(m);o=o.multiply(c)}if(l>0){var u=h.select("count").min().gt(l);o=o.multiply(u)}e.useSwbdMask&&(o=o.multiply(O));var p=A.focal_min(1e4,"square","meters").reproject("EPSG:4326",null,1e3);return o=o.multiply(p),e.debugMapLayers&&(Map.addLayer(t.not().mask(t.not()),{},"min water mask",!1),Map.addLayer(r.not().mask(r.not()),{},"max land mask",!1),m>-1&&Map.addLayer(c.not().mask(c.not()),{},"ndvi mask",!1),l>0&&Map.addLayer(u.not().mask(u.not()),{},"count mask",!1),e.useSwbdMask&&Map.addLayer(O.not().mask(O.not()),{},"swbd mask",!1),Map.addLayer(p.not().mask(p.not()),{},"scale original mask (eroded)",!1)),o}var t=e.dateIntervals,r=e.percentile,n=e.slopeThreshold,i=e.slopeThresholdRatio,s=e.refine,d=e.slopeThresholdRefined,m=e.ndviFilter,l=e.filterCount,o=e.showEdges,c=e.smoothen,u=e.includeBackgroundSlope,p=e.backgroundSlopeOpacity,f=e.refineFactor,g=e.ndwiMaxLand,v=e.ndwiMinWater,y=["green","swir1"],L=["B3","B6"],M=["B2","B5"];m>-1&&(y=["green","swir1","nir","red"],L=["B3","B6","B5","B4"],M=["B2","B5","B4","B3"]);var w=new ee.ImageCollection([]),k=new ee.ImageCollection("LANDSAT/LC8_L1T_TOA").select(L,y);w=new ee.ImageCollection(w.merge(k));var I=new ee.ImageCollection("LANDSAT/LE7_L1T_TOA").select(M,y);w=new ee.ImageCollection(w.merge(I));var _=new ee.ImageCollection("LANDSAT/LT5_L1T_TOA").select(M,y);w=new ee.ImageCollection(w.merge(_));var b=new ee.ImageCollection("LANDSAT/LT4_L1T_TOA").select(M,y);w=new ee.ImageCollection(w.merge(b));var T=ee.List(t);e.debugMapLayers&&T.getInfo().map(function(e){var a=ee.Date(e[0].value),t=ee.Date(e[1].value),r=ee.List.sequence(0,100,1),n=w.filterDate(a,t).map(function(e){var a=ee.Image.constant(e.get("SUN_AZIMUTH")).toFloat().rename("sun_azimuth").divide(100),t=ee.Image.constant(e.get("SUN_ELEVATION")).toFloat().rename("sun_elevation").divide(100);return e.addBands(a).addBands(t).addBands(e.normalizedDifference(["green","swir1"]).rename("mndwi"))});Map.addLayer(n,{},"all "+a.format("YYYY-MM-dd").getInfo(),!1);var i=n.reduce(ee.Reducer.percentile(r)).set("system:time_start",a);Map.addLayer(i,{},"all percentiles "+a.format("YYYY-MM-dd").getInfo(),!1)});var h=ee.ImageCollection(T.map(function(e){var a=ee.List(e),t=a.get(0),n=a.get(1),i=w.filterDate(t,n);c&&(i=i.map(function(e){return e.resample("bicubic")}));var s=i.reduce(ee.Reducer.percentile([r])).rename(y),d=s.normalizedDifference(["green","swir1"]).rename("mndwi").set("system:time_start",t);if(m>-1){var o=s.normalizedDifference(["nir","red"]).rename("ndvi");d=d.addBands(o)}if(l>0){var u=i.select(0).count().rename("count");d=d.addBands(u)}return d})),B=h.select("mndwi");if(m>-1)var S=h.select("ndvi");var D=B.map(function(e){return rescale(e,[-.6,.6])}).map(createTimeBand).reduce(ee.Reducer.linearFit().unweighted()),x=D.select("scale"),A=x.mask();e.debugMapLayers&&(Map.addLayer(A,{},"scale original mask",!1),Map.addLayer(x,{min:-n*i,max:n*i,palette:["00ff00","000000","00d8ff"]},"scale",!1));var C=B.min(),z=B.max();if(m>-1)var E=S.min();if(e.debugMapLayers&&(Map.addLayer(ee.Image(B.first()),{},"mndwi first (raw)",!1),Map.addLayer(ee.Image(B.toList(1,1).get(0)),{},"mndwi last (raw)",!1),Map.addLayer(C,{},"mndwi min (raw)",!1),Map.addLayer(z,{},"mndwi max (raw)",!1),m>-1&&(Map.addLayer(S.min(),{},"ndvi min (raw)",!1),Map.addLayer(S.max(),{},"ndvi max (raw)",!1))),e.useSwbdMask)var N=ee.Image("MODIS/MOD44W/MOD44W_005_2000_02_24").select("water_mask"),O=N.unmask().not().focal_max(15e3,"circle","meters").reproject("EPSG:4326",null,500);var R=a(i*n);if(s){var R=R.reproject("EPSG:4326",null,30),Y=R.projection(),F=R.reduceResolution(ee.Reducer.max(),!0).focal_max(f).reproject(Y.scale(f,f)).focal_mode(ee.Number(f).multiply(30),"circle","meters");var j=a(d*i).mask(F);e.debugMapLayers&&(Map.addLayer(R.mask(R),{},"mask (raw)",!1),Map.addLayer(F.mask(F),{},"mask buffer (raw)",!1),Map.addLayer(j.mask(j),{},"mask refined (raw)",!1)),c&&(x=x.focal_median(25,"circle","meters",3),R=R.focal_mode(35,"circle","meters",3))}e.debugMapLayers&&Map.addLayer(x,{},"scale (raw)",!1);var P=[],W=ee.Image(1).toInt().visualize({palette:"000000",opacity:.4});if(u&&(W=x.visualize({min:-n*i,max:n*i,palette:["00ff00","000000","00d8ff"],opacity:p}),W=W.mask(ee.Image(p).toFloat().multiply(C.gt(.4).focal_mode(1).not()))),l>0&&(W=W.multiply(h.select("count").min().gt(l))),e.useSwbdMask&&(W=W.multiply(O.gt(0))),P.push(W),s){if(e.debug){var G=F.mask(F).visualize({palette:["ffffff","000000"],opacity:.5});P.push(G)}var U=getEdge(R.mask(x.gt(0))).visualize({palette:"00d8ff"}),q=getEdge(R.mask(x.lt(0))).visualize({palette:"00ff00"});x=x.mask(j);var V=x.visualize({min:-n*i,max:n*i,palette:["00ff00","000000","00d8ff"],opacity:o?.3:1});P.push(V),o&&P.push(U,q)}else{x=x.mask(R);var H=x.visualize({min:-n*i,max:n*i,palette:["00ff00","000000","00d8ff"]});P.push(H)}return{changeVis:ee.ImageCollection.fromImages(P).mosaic(),change:x}}var rescale=function(e,a){return e.subtract(a[0]).divide(ee.Number(a[1]).subtract(a[0])).copyProperties(e).copyProperties(e,["system:time_start"])};


function renderLandsatPercentile(options) {
  var percentile = options.percentile;
  var start = options.start;
  var stop = options.stop;
  var sharpen = options.sharpen;
  var smoothen = options.smoothen;
  var filterCount = options.filterCount;
  var isRgb = options.isRgb;
  
  var bands = ['red', 'green', 'blue'];
  var bandsL8 = ['B6', 'B5', 'B3']
  var bandsL7 = ['B5', 'B4', 'B2']

  if(isRgb) {
    bands = ['swir1', 'nir', 'green'];
    bandsL8 = ['B4', 'B3', 'B2']
    bandsL7 = ['B3', 'B2', 'B1']
  }
  
  // the images from different missions
  var l8 = new ee.ImageCollection('LANDSAT/LC8_L1T_TOA').filterDate(start, stop).select(bandsL8, bands);
  var l7 = new ee.ImageCollection('LANDSAT/LE7_L1T_TOA').filterDate(start, stop).select(bandsL7, bands);
  var l5 = new ee.ImageCollection('LANDSAT/LT5_L1T_TOA').filterDate(start, stop).select(bandsL7, bands);
  var l4 = new ee.ImageCollection('LANDSAT/LT4_L1T_TOA').filterDate(start, stop).select(bandsL7, bands);
  // combine into 1
  var images = ee.ImageCollection(l8.merge(l7).merge(l5).merge(l4))
    .map(function(i) { return i.mask(i.gt(0.0001).and(i.lt(1)))}) // filter-out crappy TOA images
    
  //images = ee.ImageCollection(images.limit(100))
  //var images = ee.ImageCollection(l7.merge(l5).merge(l4))

  if(smoothen) {
    images = images.map(function(i) { return i.resample('bicubic'); })
  }

  // compute the percentile
  var image = images
    // TODO: we already did this
    .map(function(i) { return i.mask(i.gt(0.0001).and(i.lt(1)))})
    //.filterMetadata('SUN_AZIMUTH', 'greater_than', 5) // almost empty
    .reduce(ee.Reducer.percentile([percentile]))
    .rename(bands)

  if(filterCount > 0) {
    image = image.mask(images.select(0).count().gt(filterCount));
    Map.addLayer(images.select(0).count(), {min:filterCount, max:200, palette:['d7191c','fdae61','ffffbf','a6d96a','1a9641']}, 'count', false)
  }

  if(sharpen) {
    // LoG
    image = image.subtract(image.convolve(ee.Kernel.gaussian(40, 30, 'meters')).convolve(ee.Kernel.laplacian8(0.4)))
  }

  return image.visualize({min: 0.05, max: [0.4, 0.4, 0.5], gamma: 1.4})
}

/***
 * Computes export video / image parameters: scale, rect.
 */
function generateExportParameters(bounds, w, h) {
  bounds = ee.Geometry(bounds).bounds()
  w = ee.Number(w)
  h = ee.Number(h)
  
  // get width / height
  var coords = ee.List(bounds.coordinates().get(0))
  var ymin = ee.Number(ee.List(coords.get(0)).get(1))
  var ymax = ee.Number(ee.List(coords.get(2)).get(1))
  var xmin = ee.Number(ee.List(coords.get(0)).get(0))
  var xmax = ee.Number(ee.List(coords.get(1)).get(0))
  var width = xmax.subtract(xmin)
  var height = ymax.subtract(ymin)

  // compute new height, ymin, ymax and bounds
  var ratio = w.divide(h)
  var ycenter = ymin.add(height.divide(2.0))

  height = width.divide(ratio)
  ymin = ycenter.subtract(height.divide(2.0))
  ymax = ycenter.add(height.divide(2.0))
  
  bounds = ee.Geometry.Rectangle(xmin, ymin, xmax, ymax)
  
  var scale = bounds.projection().nominalScale().multiply(width.divide(w))

  return {scale: scale, bounds: bounds}  
}

function getEdge(i) {
  var canny = ee.Algorithms.CannyEdgeDetector(i, 0.99, 0);
  canny = canny.mask(canny)
  return canny;
}

var areaOfInterest = [
  vs_dubai, 
  vs_yellowsea, 
  vs_ganges, 
  vs_taji_najer, 
  vs_korea, 
  vs_myanmar, 
  vs_aral_lake, 
  vs_lake_mead,
  vs_singapore
];

var startYear = 2000
var startIntervalLength = 48
var stopYear = 2013
var stopIntervalLength = 48

var time0 = [ee.Date.fromYMD(startYear, 1, 1), startIntervalLength];
var time1 = [ee.Date.fromYMD(stopYear, 1, 1), stopIntervalLength];

var options = {
  // intervals used for averaging and linear regression (web site may use multiple intervals here)  
  dateIntervals: [
    [time0[0], time0[0].advance(time0[1], 'month')],
    //[time0[0].advance(12, 'month'), time0[0].advance(time0[1]+12, 'month')], 
    //[time1[0].advance(-12, 'month'), time1[0].advance(time1[1]-12, 'month')], 
    [time1[0], time1[0].advance(time1[1], 'month')]
  ],

  percentile: 15,

  slopeThreshold: 0.025,
  slopeThresholdRatio: getWaterTrendChangeRatio(startYear, stopYear),

  slopeThresholdRefined: 0.015,

  refine: true, // more expensive
  //refine: false,
  refineFactor: 5,

  //ndviFilter: 0.15, // the highest NDVI value for water
  ndviFilter: -1,

  ndwiMinWater: -0.05, // minimum value of NDWI to assume as water
  ndwiMaxLand: 0.5, // maximum value of NDWI to assume as land

  //filterCount: 10,
  filterCount: 0,
  
  //useSwbdMask: true,
  useSwbdMask: false,
  
  showEdges: true,
  //showEdges: false,

  includeBackgroundSlope: false,
  //includeBackgroundSlope: true,

  // backgroundSlopeOpacity: 0.3,

  smoothen: false,
  //smoothen: true,

  //debug: false, // shows a buffer used to refine changes
  debug: false,
  //debugMapLayers: true,
  debugMapLayers: false,

  sharpen: true,
  //sharpen: false,
}
// Let's see the big picture (300dpi for print)
var w = 1920
var h = 1080
var bounds = vs_singapore.geometry().bounds() // Map.getBounds(true)
var params = generateExportParameters(bounds, w, h)
bounds = params.bounds
var textScale = params.scale

var offset = 30 * textScale / ee.Projection('EPSG:4326').nominalScale().getInfo()
var b = bounds.coordinates().get(0).getInfo()
var textLocation = ee.Geometry.Point(b[0][0] + offset, b[0][1] + offset)

function render(startYear, stopYear) {
  var start = ee.Date.fromYMD(startYear, 1, 1)
  var stop = ee.Date.fromYMD(stopYear, 1, 1)

  options.dateIntervals = [
    [start, start.advance(startIntervalLength, 'month')],
    [stop, stop.advance(stopIntervalLength, 'month')]
  ];

  options.slopeThresholdRatio = getWaterTrendChangeRatio(startYear, stopYear)

  var trend = renderWaterTrend(options);
  // Map.addLayer(trend.changeVis, {}, startYear + ' - ' + stopYear + ' (water change)', false);

  options.start = stop
  options.stop = stop.advance(stopIntervalLength, 'month')
  
  var percentileImage = renderLandsatPercentile(options)
  // Map.addLayer(percentileImage, {}, options.start.format('YYYY-MM-dd').getInfo() + ' ' + options.percentile + '%', false);

  // draw text at map center
  var str = start.format('YYYY').cat(' - ').cat(stop.format('YYYY'))
  var text = Text.draw(str, textLocation, textScale, {fontSize:32, textColor: '000000', outlineColor: 'ffffff', outlineWidth: 2, textOpacity: 0.9, outlineOpacity: 0.7})

  return ee.ImageCollection([
    percentileImage.visualize({forceRgbOutput:true}),
    trend.changeVis.visualize({forceRgbOutput:true}),
    //text
    ]).mosaic();
}

var startYear = 2000
var stopYear = 2015
var step = 1

var intervals = ee.List.sequence(startYear + step, stopYear, step).map(function(stop) {
  return [startYear, stop]
}) 

print(intervals)

var videoFrames = ee.ImageCollection(intervals.getInfo().map(function(interval) {
  return render(interval[0], interval[1])
}))

var count = 5
var list = videoFrames.toList(count, 0);
for(var i = 0; i < count; i++) {
  var interval = intervals.get(i).getInfo()
  var name = interval[0].toString() + '-' + interval[1].toString()
  var image = ee.Image(list.get(i))
  Map.addLayer(image, {}, name, i === 0);
}
  
Export.video.toDrive({
    collection: videoFrames,
    description: 'changes-Singapore',
    dimensions: 1920,
    region: bounds,
    framesPerSecond: 2,
    crs: 'EPSG: 4326'
})
