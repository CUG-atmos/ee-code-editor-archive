/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var mndwi = ee.Image("users/gena/paris-MNDWI"),
    ndvi = ee.Image("users/gena/paris-NDVI-inverted"),
    ndwi = ee.Image("users/gena/paris-NDWI"),
    training_water = /* color: #d63000 */ee.Feature(
        ee.Geometry({
          "type": "GeometryCollection",
          "geometries": [
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.2255897521972656,
                    48.849072124570554
                  ],
                  [
                    2.2262978553771973,
                    48.84938276601615
                  ],
                  [
                    2.2259974479675293,
                    48.850357038049204
                  ],
                  [
                    2.2247743606567383,
                    48.84948160607197
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.230519652366638,
                    48.84996521353227
                  ],
                  [
                    2.2305062413215637,
                    48.85010817688697
                  ],
                  [
                    2.2303909063339233,
                    48.85019466069352
                  ],
                  [
                    2.230272889137268,
                    48.850169951049736
                  ],
                  [
                    2.230297029018402,
                    48.85006934737421
                  ],
                  [
                    2.230425775051117,
                    48.84990520410125
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.2058647871017456,
                    48.833834208460516
                  ],
                  [
                    2.2058218717575073,
                    48.833964859046006
                  ],
                  [
                    2.205559015274048,
                    48.83414847550919
                  ],
                  [
                    2.205381989479065,
                    48.83397192123013
                  ],
                  [
                    2.2055697441101074,
                    48.83379889743296
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    1.8752717971801758,
                    48.9761186376262
                  ],
                  [
                    1.8744349479675293,
                    48.976125679749835
                  ],
                  [
                    1.8744456768035889,
                    48.9759284999124
                  ],
                  [
                    1.875089406967163,
                    48.97591441560846
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    1.8749821186065674,
                    48.9751045614386
                  ],
                  [
                    1.8756043910980225,
                    48.97515385728585
                  ],
                  [
                    1.875690221786499,
                    48.9753792091097
                  ],
                  [
                    1.875014305114746,
                    48.97535808241949
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    1.8739736080169678,
                    48.9751045614386
                  ],
                  [
                    1.87391996383667,
                    48.975231322090195
                  ],
                  [
                    1.8734586238861084,
                    48.97522427984025
                  ],
                  [
                    1.8735337257385254,
                    48.97502005415845
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    1.9034886360168457,
                    48.9752682938862
                  ],
                  [
                    1.9037622213363647,
                    48.97534751907101
                  ],
                  [
                    1.9036951661109924,
                    48.975497166298794
                  ],
                  [
                    1.9033250212669373,
                    48.975310547333784
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.437741756439209,
                    48.989401834542846
                  ],
                  [
                    2.4375003576278687,
                    48.98903222018334
                  ],
                  [
                    2.437666654586792,
                    48.98893717604772
                  ],
                  [
                    2.4378731842505204,
                    48.989062141371676
                  ],
                  [
                    2.4379831552505493,
                    48.98920822736316
                  ],
                  [
                    2.4381226299539094,
                    48.989410634568884
                  ],
                  [
                    2.4381011724472046,
                    48.98963064205803
                  ],
                  [
                    2.437886595726013,
                    48.98957080019398
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    1.9723248481750488,
                    48.993917948564736
                  ],
                  [
                    1.9697070121765137,
                    48.996438064932285
                  ],
                  [
                    1.966552734375,
                    48.99604386519703
                  ],
                  [
                    1.968247890472412,
                    48.99294647301535
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.285006046295166,
                    48.94257980893223
                  ],
                  [
                    2.285102605819702,
                    48.94271369911103
                  ],
                  [
                    2.28415846824646,
                    48.943235162699416
                  ],
                  [
                    2.2840189933776855,
                    48.943143554625706
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    1.7448198795318604,
                    49.03110839189348
                  ],
                  [
                    1.7448198795318604,
                    49.03065115688453
                  ],
                  [
                    1.7449378967285156,
                    49.03060191594063
                  ],
                  [
                    1.7449593544006348,
                    49.03107322011891
                  ]
                ]
              ],
              "geodesic": true,
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    1.7448091506958008,
                    49.02977888152065
                  ],
                  [
                    1.7444443702697754,
                    49.02984922687499
                  ],
                  [
                    1.7436504364013672,
                    49.029399014888654
                  ],
                  [
                    1.744551658630371,
                    49.029342738103914
                  ]
                ]
              ],
              "geodesic": true,
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    1.7989414930343628,
                    48.9718333209169
                  ],
                  [
                    1.8023908138275146,
                    48.972629142997405
                  ],
                  [
                    1.804383689819133,
                    48.97298655887033
                  ],
                  [
                    1.8035978028555064,
                    48.973090438876305
                  ],
                  [
                    1.8015807713987897,
                    48.972659088494545
                  ],
                  [
                    1.8004167079925537,
                    48.97240730006615
                  ],
                  [
                    1.7992043495178223,
                    48.97212911467796
                  ],
                  [
                    1.7986088991165161,
                    48.97203051695259
                  ],
                  [
                    1.7986518144607544,
                    48.97189670544201
                  ]
                ]
              ],
              "geodesic": true,
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.109793439967916,
                    48.886906755729754
                  ],
                  [
                    2.1102118492126465,
                    48.88526299769019
                  ],
                  [
                    2.110319137573242,
                    48.88440228632126
                  ],
                  [
                    2.110447883605957,
                    48.88380965676751
                  ],
                  [
                    2.110447883605957,
                    48.88341456649681
                  ],
                  [
                    2.110898494720459,
                    48.88341456649681
                  ],
                  [
                    2.110769748687744,
                    48.88424707449789
                  ],
                  [
                    2.1103835105895996,
                    48.88637766744743
                  ],
                  [
                    2.109729060013251,
                    48.888628091767046
                  ],
                  [
                    2.1091175079345703,
                    48.88807078916454
                  ]
                ]
              ],
              "geodesic": true,
              "evenOdd": true
            }
          ],
          "coordinates": []
        }),
        {
          "landuse": 0,
          "system:index": "0"
        }),
    training_vegetation = /* color: #98ff00 */ee.Feature(
        ee.Geometry.MultiPolygon(
            [[[[2.204985022544861, 48.83372827530324],
               [2.204228639602661, 48.833632935270174],
               [2.2042983770370483, 48.8331385766337],
               [2.204985022544861, 48.83293730064865]]],
             [[[2.2487425804138184, 48.84172912927874],
               [2.248774766921997, 48.84212454876025],
               [2.247755527496338, 48.842519965119926],
               [2.247530221939087, 48.84230107430656],
               [2.248753309249878, 48.841672640526525]]],
             [[[2.299739420413971, 48.86819945337243],
               [2.2999539971351624, 48.868300020614996],
               [2.299991548061371, 48.868427052632484],
               [2.2999271750450134, 48.86855232000058],
               [2.299717962741852, 48.86844293161201],
               [2.2995999455451965, 48.868300020614996]]],
             [[[2.294543981552124, 48.86602397565035],
               [2.294769287109375, 48.86597104314035],
               [2.2953540086746216, 48.86700498136806],
               [2.29514479637146, 48.86708967160736]]],
             [[[2.271750569343567, 48.86688853205499],
               [2.2719329595565796, 48.86679678392051],
               [2.2723621129989624, 48.86724846541969],
               [2.2726356983184814, 48.867502534471306],
               [2.272968292236328, 48.86800714001244],
               [2.2727054357528687, 48.86815887355065]]],
             [[[2.284576892852783, 48.945525309891664],
               [2.2846519947052, 48.94563100645562],
               [2.2835898399353027, 48.946258134796814],
               [2.2831928730010986, 48.94605379047262],
               [2.28440523147583, 48.945292776662974]]]]),
        {
          "landuse": 1,
          "system:index": "0"
        }),
    training_urban = /* color: #0b4a8b */ee.Feature(
        ee.Geometry({
          "type": "GeometryCollection",
          "geometries": [
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.2175323963165283,
                    48.83773945451089
                  ],
                  [
                    2.218111753463745,
                    48.838050166257226
                  ],
                  [
                    2.217961549758911,
                    48.83830438352523
                  ],
                  [
                    2.2175002098083496,
                    48.838106659094954
                  ],
                  [
                    2.2171032428741455,
                    48.837760639463916
                  ],
                  [
                    2.2173821926116943,
                    48.8376335296114
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.2122645378112793,
                    48.83729456842787
                  ],
                  [
                    2.211695909500122,
                    48.837725331203934
                  ],
                  [
                    2.2108376026153564,
                    48.83736518553026
                  ],
                  [
                    2.211620807647705,
                    48.83696972847469
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.252476215362549,
                    48.84166557942801
                  ],
                  [
                    2.2525620460510254,
                    48.84203275523027
                  ],
                  [
                    2.251178026199341,
                    48.84255527000023
                  ],
                  [
                    2.2505557537078857,
                    48.84179267904881
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.3029017448425293,
                    48.86873404534336
                  ],
                  [
                    2.302979528903961,
                    48.86890165551127
                  ],
                  [
                    2.3029983043670654,
                    48.86907279373504
                  ],
                  [
                    2.302708625793457,
                    48.86911337281563
                  ],
                  [
                    2.3022955656051636,
                    48.868825789925864
                  ],
                  [
                    2.3025262355804443,
                    48.86868817298901
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.2996683418750763,
                    48.86845792842136
                  ],
                  [
                    2.2997260093688965,
                    48.86846410357685
                  ],
                  [
                    2.299748808145523,
                    48.8685099761366
                  ],
                  [
                    2.2996026277542114,
                    48.86852850158151
                  ],
                  [
                    2.2996066510677338,
                    48.86846675007182
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.2999298572540283,
                    48.868562905960985
                  ],
                  [
                    2.299932539463043,
                    48.868611424917496
                  ],
                  [
                    2.2997957468032837,
                    48.86861407140468
                  ],
                  [
                    2.299799770116806,
                    48.86854967351014
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.295120656490326,
                    48.86709672912082
                  ],
                  [
                    2.2949865460395813,
                    48.86713554542712
                  ],
                  [
                    2.294916808605194,
                    48.86703144708323
                  ],
                  [
                    2.2950509190559387,
                    48.86698910193224
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.3756110668182373,
                    48.98638499720392
                  ],
                  [
                    2.376115322113037,
                    48.98669830619716
                  ],
                  [
                    2.375997304916382,
                    48.98683911858622
                  ],
                  [
                    2.3756781211150155,
                    48.98668950540965
                  ],
                  [
                    2.375466227531433,
                    48.98649060719702
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.2755593061447144,
                    48.8663168678604
                  ],
                  [
                    2.2759777307510376,
                    48.86617218638055
                  ],
                  [
                    2.276546359062195,
                    48.867259051655935
                  ],
                  [
                    2.276122570037842,
                    48.86741078746259
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.273091673851013,
                    48.86783423379168
                  ],
                  [
                    2.273343801498413,
                    48.86770014284184
                  ],
                  [
                    2.273848056793213,
                    48.86852232643396
                  ],
                  [
                    2.2736871242523193,
                    48.86857525624528
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.281315326690674,
                    48.831729627757355
                  ],
                  [
                    2.280714511871338,
                    48.83201212694841
                  ],
                  [
                    2.280135154724121,
                    48.831574252523325
                  ],
                  [
                    2.280735969543457,
                    48.83130587598418
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.3212695121765137,
                    48.84172912927874
                  ],
                  [
                    2.3220205307006836,
                    48.84191977834707
                  ],
                  [
                    2.3223423957824707,
                    48.842184567515815
                  ],
                  [
                    2.3218005895614624,
                    48.84323311887593
                  ],
                  [
                    2.321189045906067,
                    48.84315544915763
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.337770462036133,
                    48.86200447443296
                  ],
                  [
                    2.335367202758789,
                    48.86321847546523
                  ],
                  [
                    2.3346805572509766,
                    48.86316201095391
                  ],
                  [
                    2.335045337677002,
                    48.862060940250196
                  ],
                  [
                    2.337512969970703,
                    48.86125629633995
                  ]
                ]
              ],
              "evenOdd": true
            },
            {
              "type": "Polygon",
              "coordinates": [
                [
                  [
                    2.3078155517578125,
                    48.86973969792929
                  ],
                  [
                    2.296614646911621,
                    48.87329637017783
                  ],
                  [
                    2.2964000701904297,
                    48.87281651645486
                  ],
                  [
                    2.3070859909057617,
                    48.86937272529265
                  ]
                ]
              ],
              "geodesic": true,
              "evenOdd": true
            }
          ],
          "coordinates": []
        }),
        {
          "landuse": 2,
          "system:index": "0"
        }),
    jrc = ee.Image("JRC/GSW1_0/GlobalSurfaceWater");
/***** End of imports. If edited, may not auto-convert in the playground. *****/
var image = ee.Image([mndwi,mndwi,ndvi])//.resample('bilinear')
  
//image = image.updateMask(ndwi.add(mndwi).multiply(3))  

Map.addLayer(image, {min: [0.3,0.3,-0.3], max: [-0.6,-0.6,0.3]}, 'indices', true)

var training = ee.FeatureCollection([
  training_urban,
  training_vegetation,
  training_water
])

var samples = image.sampleRegions(training, ['landuse'], 10)

print(samples)

var classifier = ee.Classifier.randomForest()

classifier = classifier.train(samples, 'landuse')

print(classifier.confusionMatrix())
print(classifier.confusionMatrix().accuracy())
print(classifier.confusionMatrix().kappa())

var classified = image.classify(classifier)

var water = classified.eq(0)//.focal_mode(20, 'circle', 'meters')
Map.addLayer(water.mask(water), {palette:['ff69b4']})

Map.addLayer(jrc.select('occurrence').gt(80), {palette:['ffff00']})