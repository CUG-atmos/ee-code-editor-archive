/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var water = /* color: d63000 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([25.95073699951172, -15.831563065024945]),
            {
              "class": 1,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([25.876922607421875, -15.82759942873109]),
            {
              "class": 1,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([25.867996215820312, -15.846095732758398]),
            {
              "class": 1,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([25.855979919433594, -15.878790408710541]),
            {
              "class": 1,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([25.828857421875, -15.848077379137509]),
            {
              "class": 1,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([26.1968994140625, -15.841471815556517]),
            {
              "class": 1,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([26.244277954101562, -15.808440757784034]),
            {
              "class": 1,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([26.281700134277344, -15.803815979153368]),
            {
              "class": 1,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([26.592063903808594, -15.653122712347416]),
            {
              "class": 1,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([26.483917236328125, -15.734762083422133]),
            {
              "class": 1,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([26.613521575927734, -15.68403053611913]),
            {
              "class": 1,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([26.619529724121094, -15.676097425234593]),
            {
              "class": 1,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Point([26.632232666015625, -15.674196738304836]),
            {
              "class": 1,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([26.594209671020508, -15.671386994783221]),
            {
              "class": 1,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Point([26.110382080078125, -15.896373984889749]),
            {
              "class": 1,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([26.11750602722168, -15.902895203312582]),
            {
              "class": 1,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Point([26.172094345092773, -15.89612633951728]),
            {
              "class": 1,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([26.160764694213867, -15.917422728212152]),
            {
              "class": 1,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Point([26.16321086883545, -15.936942435124074]),
            {
              "class": 1,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([26.146817207336426, -15.961411603281727]),
            {
              "class": 1,
              "system:index": "19"
            })]),
    vegetation = /* color: 98ff00 */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([26.208443641662598, -15.882876870317762]),
            {
              "class": 2,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([26.215267181396484, -15.879884267671681]),
            {
              "class": 2,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([26.20960235595703, -15.876953537846584]),
            {
              "class": 2,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([26.20964527130127, -15.888407908483858]),
            {
              "class": 2,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([26.19694232940674, -15.882897508802285]),
            {
              "class": 2,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([26.293630599975586, -15.920352869747912]),
            {
              "class": 2,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([26.183853149414062, -16.014713500646653]),
            {
              "class": 2,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([26.176986694335938, -16.012485996992687]),
            {
              "class": 2,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([26.016483306884766, -15.79654825640521]),
            {
              "class": 2,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([25.95296859741211, -15.857985319147101]),
            {
              "class": 2,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([25.762081146240234, -15.90925112661851]),
            {
              "class": 2,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([25.75641632080078, -15.916102088896716]),
            {
              "class": 2,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Point([25.641403198242188, -15.874662585544675]),
            {
              "class": 2,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([25.59814453125, -15.895135757498398]),
            {
              "class": 2,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Point([25.57840347290039, -15.909994013334837]),
            {
              "class": 2,
              "system:index": "14"
            }),
        ee.Feature(
            ee.Geometry.Point([25.606212615966797, -15.790601743793673]),
            {
              "class": 2,
              "system:index": "15"
            }),
        ee.Feature(
            ee.Geometry.Point([25.59814453125, -15.805550283523724]),
            {
              "class": 2,
              "system:index": "16"
            }),
        ee.Feature(
            ee.Geometry.Point([25.588703155517578, -15.806045796328725]),
            {
              "class": 2,
              "system:index": "17"
            }),
        ee.Feature(
            ee.Geometry.Point([26.002793312072754, -16.312766995525166]),
            {
              "class": 2,
              "system:index": "18"
            }),
        ee.Feature(
            ee.Geometry.Point([26.007814407348633, -16.320468941945602]),
            {
              "class": 2,
              "system:index": "19"
            })]),
    other = /* color: 0B4A8B */ee.FeatureCollection(
        [ee.Feature(
            ee.Geometry.Point([26.652488708496094, -16.054061963936757]),
            {
              "class": 0,
              "system:index": "0"
            }),
        ee.Feature(
            ee.Geometry.Point([26.655750274658203, -16.054556863683178]),
            {
              "class": 0,
              "system:index": "1"
            }),
        ee.Feature(
            ee.Geometry.Point([26.652445793151855, -16.019374677861887]),
            {
              "class": 0,
              "system:index": "2"
            }),
        ee.Feature(
            ee.Geometry.Point([26.648025512695312, -16.015497246021134]),
            {
              "class": 0,
              "system:index": "3"
            }),
        ee.Feature(
            ee.Geometry.Point([26.23706817626953, -15.856994547042074]),
            {
              "class": 0,
              "system:index": "4"
            }),
        ee.Feature(
            ee.Geometry.Point([26.2093448638916, -15.86442521919015]),
            {
              "class": 0,
              "system:index": "5"
            }),
        ee.Feature(
            ee.Geometry.Point([26.19818687438965, -15.865746198905073]),
            {
              "class": 0,
              "system:index": "6"
            }),
        ee.Feature(
            ee.Geometry.Point([26.232519149780273, -15.841554386435174]),
            {
              "class": 0,
              "system:index": "7"
            }),
        ee.Feature(
            ee.Geometry.Point([26.230287551879883, -15.842008525664287]),
            {
              "class": 0,
              "system:index": "8"
            }),
        ee.Feature(
            ee.Geometry.Point([26.251401901245117, -15.855673509998681]),
            {
              "class": 0,
              "system:index": "9"
            }),
        ee.Feature(
            ee.Geometry.Point([26.125831604003906, -15.82627819935794]),
            {
              "class": 0,
              "system:index": "10"
            }),
        ee.Feature(
            ee.Geometry.Point([26.052017211914062, -15.86504442950923]),
            {
              "class": 0,
              "system:index": "11"
            }),
        ee.Feature(
            ee.Geometry.Point([26.103386878967285, -15.883248362715682]),
            {
              "class": 0,
              "system:index": "12"
            }),
        ee.Feature(
            ee.Geometry.Point([26.10252857208252, -15.882753039366145]),
            {
              "class": 0,
              "system:index": "13"
            }),
        ee.Feature(
            ee.Geometry.Point([25.79486846923828, -15.283853934312463]),
            {
              "class": 0,
              "system:index": "14"
            })]);
/***** End of imports. If edited, may not auto-convert in the playground. *****/

// Display an image given its ID.
var landsat = ee.Image('LANDSAT/LE7/LE71730712008045ASN00');
print(landsat);

//producing watermap with difference between NDWI and NDVI
//NDVI
var ndvi = landsat.normalizedDifference(['B4', 'B3']);
//NDWI
var ndwi = landsat.normalizedDifference(['B4', 'B5']);
//DIFF
var diff = ndwi.subtract(ndvi).gt(0.3);


Map.setCenter(26.38, -15.76);
Map.addLayer(landsat, {bands:['B3','B2','B1'], gain: '1.6, 1.6, 1.1'}, 'RGB',false);
Map.addLayer(landsat, {bands:['B5','B4','B3'], gain: '1.4, 1.4, 1.1'}, 'false-color',false);
Map.addLayer(landsat, {bands:['B4','B3','B2'], gain: '1.4, 1.4, 1.1'}, 'false-color2',false);
Map.addLayer(diff.mask(diff), {palette:['98ff00', '0b4a8b']}, 'watter',false);
//Map.addLayer(ndvi, {palette:['98ff00', '0b4a8b']}, 'ndvi',false);


//________________________Classification_______________________
//Cart example
var landsat = ee.Image('LANDSAT/LE7/LE71730712008045ASN00').select('B5','B4', 'B3', 'B2');
var trainingData = landsat.sampleRegions(vegetation.merge(water).merge(other), ['class'], 30);
var classifier = ee.Classifier.cart().train(trainingData, 'class', ['B5', 'B4', 'B3', 'B2']);
var classified=landsat.classify(classifier);

Map.addLayer(classified, {min: 0, max: 2, palette:['fcde16', '0b4a8b', '98ff00']}, 'classified_Cart');


//Mahalanobis example
var landsat_mahala = ee.Image('LANDSAT/LE7/LE71730712008045ASN00');
var trainingData = landsat_mahala.sampleRegions(vegetation.merge(water).merge(other), ['class'], 30);
var classifier2 = ee.Classifier.mahalanobis().train(trainingData, 'class');
var classified2=landsat_mahala.classify(classifier2);

Map.addLayer(classified2, {min: 0, max: 2, palette:['fcde16', '0b4a8b', '98ff00']}, 'classified')

//__________Confusion Matrix

//validate "classified" (but only class 1)
//use "diff" as ground true image














