/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var urban = /* color: ff0000 */ee.Feature(
        ee.Geometry.MultiPolygon(
            [[[[77.83568859100342, 29.79600077822167],
               [77.83751249313354, 29.79737872057758],
               [77.83637523651123, 29.798942848363463],
               [77.83388614654541, 29.79810492580485]]],
             [[[77.87864685058594, 29.795553873922895],
               [77.87336826324463, 29.791084721157866],
               [77.8734540939331, 29.789781180672353],
               [77.87590026855469, 29.78944598180331],
               [77.87817478179932, 29.786913331842676],
               [77.88160800933838, 29.789185270795695],
               [77.88100719451904, 29.79506972534679]]],
             [[[77.8786039352417, 29.866512142078378],
               [77.87358283996582, 29.869377707482027],
               [77.87126541137695, 29.867628605918295],
               [77.87607192993164, 29.863385976864116]]],
             [[[77.88199424743652, 29.875108591364317],
               [77.8797197341919, 29.873061884916968],
               [77.88122177124023, 29.872019909138775],
               [77.88366794586182, 29.87447597749222]]],
             [[[77.89701461791992, 29.873024671683734],
               [77.90066242218018, 29.873099098136308],
               [77.90104866027832, 29.87462482817602],
               [77.89697170257568, 29.873880572535565]]],
             [[[78.02764892578125, 30.33317596018173],
               [78.02292823791504, 30.33576875202763],
               [78.01786422729492, 30.332138824219577],
               [78.02129745483398, 30.32917551808637]]],
             [[[78.04215431213379, 30.2996857382589],
               [78.04910659790039, 30.30220531233519],
               [78.0457592010498, 30.305539943169563],
               [78.03983688354492, 30.300500901662943]]],
             [[[78.06327939033508, 30.308503964241467],
               [78.06577920913696, 30.308448389670865],
               [78.06511402130127, 30.31054167673672],
               [78.06298971176147, 30.310273071604676]]],
             [[[79.12990808486938, 29.393897730055304],
               [79.12849187850952, 29.39457076014344],
               [79.12705421447754, 29.39565507702868],
               [79.12694692611694, 29.39298165416787],
               [79.12733316421509, 29.391897308780944],
               [79.12952184677124, 29.391112085939707]]],
             [[[79.12192583084106, 29.396870246007246],
               [79.12087440490723, 29.397412393636618],
               [79.12018775939941, 29.395505516766285],
               [79.12177562713623, 29.394944663823527]]],
             [[[79.1290283203125, 29.404759143758035],
               [79.12748336791992, 29.404198341852695],
               [79.12752628326416, 29.40173077671939],
               [79.12954330444336, 29.40288979204351]]],
             [[[79.52929973602295, 29.210312555340497],
               [79.53264713287354, 29.208589473660247],
               [79.53324794769287, 29.21087442353738],
               [79.53084468841553, 29.213046951578498]]],
             [[[79.52582359313965, 29.209638309437675],
               [79.5262098312378, 29.208327263038655],
               [79.52779769897461, 29.210687134480704],
               [79.52672481536865, 29.211511203769547]]],
             [[[79.40141201019287, 28.983854532994172],
               [79.40557479858398, 28.983704371016326],
               [79.40587520599365, 28.988734678595193],
               [79.40188407897949, 28.98862206244632]]],
             [[[79.39222812652588, 28.975557757028874],
               [79.39484596252441, 28.974619165819643],
               [79.39776420593262, 28.975895647779915],
               [79.3976354598999, 28.978035596911916],
               [79.39390182495117, 28.97750999947127]]],
             [[[79.41205501556396, 28.980701085680252],
               [79.40930843353271, 28.980701085680252],
               [79.40943717956543, 28.978636276431605],
               [79.4126558303833, 28.978561191682374]]],
             [[[79.2474102973938, 29.04582464580738],
               [79.24574732780457, 29.044389574103988],
               [79.24750685691833, 29.043151456987328],
               [79.2492127418518, 29.044314537125903]]]]),
        {
          "class": 1,
          "system:index": "0",
          "name": "urban"
        }),
    sediment = /* color: 00ff00 */ee.Feature(
        ee.Geometry.MultiPolygon(
            [[[[79.54172372817993, 29.188640821719897],
               [79.54275369644165, 29.18322685607787],
               [79.54612255096436, 29.182945846600738],
               [79.54571485519409, 29.190045783403406],
               [79.54217433929443, 29.189895921740785]]],
             [[[79.54479217529297, 29.152048845599467],
               [79.5453929901123, 29.149518964374657],
               [79.54777479171753, 29.14963140486322],
               [79.54702377319336, 29.153548005072555],
               [79.54416990280151, 29.1532294355153]]],
             [[[79.54826831817627, 29.11969915279036],
               [79.55007076263428, 29.119099294118456],
               [79.5525598526001, 29.1230732926346],
               [79.54925537109375, 29.123973044564462]]],
             [[[79.55260276794434, 29.077213016086553],
               [79.55552101135254, 29.07672542999827],
               [79.55500602722168, 29.079350866312865],
               [79.55363273620605, 29.08242629233567],
               [79.55303192138672, 29.08703925922062],
               [79.54968452453613, 29.086701732063442]]],
             [[[79.54573631286621, 29.165952709972313],
               [79.54298973083496, 29.165952709972313],
               [79.54513549804688, 29.161830466737776],
               [79.5453929901123, 29.159207134871966],
               [79.54745292663574, 29.15950694762006]]],
             [[[79.39142346382141, 29.20355116646757],
               [79.39055442810059, 29.20335449889684],
               [79.39125180244446, 29.201359706499737],
               [79.39176678657532, 29.201771779471812]]],
             [[[79.40078973770142, 29.220369530055617],
               [79.40044641494751, 29.21999498631323],
               [79.401615858078, 29.21940507714186],
               [79.40192699432373, 29.219882622923446]]],
             [[[79.40184116363525, 29.22310365788544],
               [79.40126180648804, 29.222560583508667],
               [79.40214157104492, 29.221923871951645],
               [79.40261363983154, 29.22229840864099]]],
             [[[79.40693736076355, 29.225575546251385],
               [79.40672278404236, 29.225781534255503],
               [79.405038356781, 29.224948216595656],
               [79.40566062927246, 29.224133618621646]]],
             [[[79.41309571266174, 29.250356673828595],
               [79.41262900829315, 29.25049240583137],
               [79.41211938858032, 29.2494720711924],
               [79.41297233104706, 29.249462710277065]]],
             [[[79.39926624298096, 29.294623834500598],
               [79.39879417419434, 29.295035532029416],
               [79.39656257629395, 29.291966474158336],
               [79.39822554588318, 29.29127405200961]]],
             [[[79.4006609916687, 29.31368181828691],
               [79.39937353134155, 29.313672463252267],
               [79.39934134483337, 29.311174638320093],
               [79.40078973770142, 29.311230769888947]]],
             [[[79.4017767906189, 29.31859309304717],
               [79.40105259418488, 29.318925180235805],
               [79.40003871917725, 29.31727876554064],
               [79.40096139907837, 29.316979414559754]]],
             [[[79.40734505653381, 29.3252252774518],
               [79.40709829330444, 29.325590081853303],
               [79.40465211868286, 29.324009253356632],
               [79.40494179725647, 29.323550902051004]]],
             [[[79.33763980865479, 29.30561746018375],
               [79.33818697929382, 29.305598748635177],
               [79.33748960494995, 29.30670272413296],
               [79.33704972267151, 29.30658110029897]]],
             [[[79.30613994598389, 29.22568790339588],
               [79.30759906768799, 29.227129809141925],
               [79.30633306503296, 29.227111083223402],
               [79.30397272109985, 29.224676684657553],
               [79.30420875549316, 29.224526873624935]]],
             [[[79.32169675827026, 29.253426981303427],
               [79.32097792625427, 29.25372651856248],
               [79.31958317756653, 29.25133955667591],
               [79.32085990905762, 29.2510868162742]]],
             [[[79.27803039550781, 29.19308043495592],
               [79.27751541137695, 29.194054501601123],
               [79.2752194404602, 29.19319282773334],
               [79.2759919166565, 29.192237485198838]]],
             [[[80.04894018173218, 29.040937816631526],
               [80.0528883934021, 29.042194719948704],
               [80.04810333251953, 29.047391008476726],
               [80.04404783248901, 29.044896072278583]]],
             [[[80.05651473999023, 29.03908057325814],
               [80.05226612091064, 29.036529154126413],
               [80.05503416061401, 29.033846343923013],
               [80.05900382995605, 29.03744842270023]]],
             [[[80.10586738586426, 29.015871593493067],
               [80.10900020599365, 29.015271130292952],
               [80.10749816894531, 29.020187320038204],
               [80.10522365570068, 29.020187320038204]]],
             [[[80.03859758377075, 29.05613218854567],
               [80.03514289855957, 29.054837940366934],
               [80.03919839859009, 29.050504904343658],
               [80.04230976104736, 29.051742933210893]]],
             [[[77.86040782928467, 30.381131492023552],
               [77.85894870758057, 30.37939143216171],
               [77.85972118377686, 30.379095248674368],
               [77.86083698272705, 30.380354022296903],
               [77.86894798278809, 30.38498172712772],
               [77.8687334060669, 30.386129364012707],
               [77.86182403564453, 30.38213108686995]]],
             [[[77.81305074691772, 30.425048482301552],
               [77.81738519668579, 30.425714580349744],
               [77.81697750091553, 30.426510191502526],
               [77.81260013580322, 30.42593661202185]]],
             [[[77.80328750610352, 30.427268791442486],
               [77.80112028121948, 30.42728729380636],
               [77.801034450531, 30.42676922629162],
               [77.80354499816895, 30.426713718894714]]],
             [[[77.78459787368774, 30.419756541786388],
               [77.78728008270264, 30.41955299988095],
               [77.78730154037476, 30.42021913544704],
               [77.78427600860596, 30.42031165391601]]],
             [[[78.13395023345947, 30.258177558153754],
               [78.13575267791748, 30.25258002314296],
               [78.13849925994873, 30.25298780136615],
               [78.13545227050781, 30.260549927069945],
               [78.13236236572266, 30.260475791408766]]],
             [[[78.21437358856201, 30.198905354422923],
               [78.21207761764526, 30.19996244404488],
               [78.20915937423706, 30.195492917483097],
               [78.21104764938354, 30.194676882431125]]],
             [[[78.19780826568604, 30.007162434280254],
               [78.19493293762207, 30.00827732088532],
               [78.19394588470459, 30.007719879148905],
               [78.1972074508667, 30.00515560681881]]],
             [[[78.20141315460205, 30.00246119130154],
               [78.20375204086304, 30.003966356576132],
               [78.20188522338867, 30.00530426209689],
               [78.19905281066895, 30.00446807326054]]]]),
        {
          "class": 2,
          "system:index": "0",
          "name": "sediment"
        }),
    water = /* color: 0000ff */ee.Feature(
        ee.Geometry.MultiPolygon(
            [[[[78.45954895019531, 30.418035674116204],
               [78.46126556396484, 30.409301340268463],
               [78.47208023071289, 30.412410260548704],
               [78.44718933105469, 30.43165375353512],
               [78.43963623046875, 30.425881104151195]]],
             [[[78.54018688201904, 30.370098247588956],
               [78.54366302490234, 30.36695095297672],
               [78.55164527893066, 30.366025258812115],
               [78.553147315979, 30.36932069010696],
               [78.54902744293213, 30.368024747229484],
               [78.54456424713135, 30.36946879677073],
               [78.5416030883789, 30.372801137394188],
               [78.53941440582275, 30.37020932672447]]],
             [[[78.73455047607422, 29.55404647288076],
               [78.75686645507812, 29.545385155773786],
               [78.77368927001953, 29.554643777733105],
               [78.78707885742188, 29.57704016050325],
               [78.77506256103516, 29.580324545651127],
               [78.75240325927734, 29.562408419493508]]],
             [[[78.81591796875, 29.584205953958932],
               [78.82759094238281, 29.584205953958932],
               [78.8433837890625, 29.59734192056739],
               [78.84441375732422, 29.602715232128396],
               [78.81111145019531, 29.591072695292794]]],
             [[[78.72390747070312, 29.56688774904004],
               [78.72631072998047, 29.56121389806552],
               [78.73523712158203, 29.563901551414443]]],
             [[[78.70262145996094, 29.599730094380433],
               [78.6954116821289, 29.604207767868196],
               [78.6892318725586, 29.604207767868196],
               [78.69335174560547, 29.59913305622826],
               [78.7002182006836, 29.595550753100873],
               [78.70433807373047, 29.595252222097646]]],
             [[[79.86133575439453, 28.94416665003303],
               [79.86099243164062, 28.953780248774148],
               [79.85515594482422, 28.963392955167066],
               [79.84554290771484, 28.957084717256812],
               [79.82357025146484, 28.962792187164066],
               [79.81945037841797, 28.953780248774148],
               [79.8434829711914, 28.94206355637621]]],
             [[[79.30017471313477, 29.133270020196697],
               [79.28815841674805, 29.133719852533424],
               [79.2776870727539, 29.133569908639878],
               [79.26618576049805, 29.138517941642608],
               [79.26395416259766, 29.132970130878636],
               [79.29365158081055, 29.122323493346492]]],
             [[[79.61860656738281, 28.892478276281615],
               [79.60899353027344, 28.905402784534925],
               [79.60075378417969, 28.898790446487546],
               [79.60693359375, 28.894582375662424],
               [79.62032318115234, 28.89097532204449],
               [79.62684631347656, 28.88646632880094],
               [79.64195251464844, 28.886165722289984]]],
             [[[78.15510749816895, 29.852331964568556],
               [78.15682411193848, 29.85329970477414],
               [78.15587997436523, 29.853969673267112],
               [78.1538200378418, 29.85344858705001]]],
             [[[78.15974235534668, 29.84808868523699],
               [78.15905570983887, 29.85099200110465],
               [78.15845489501953, 29.851066443991126]]],
             [[[78.2010269165039, 29.750480779239886],
               [78.20347309112549, 29.752455480021393],
               [78.20295810699463, 29.753051608461874],
               [78.20016860961914, 29.750741591006687]]],
             [[[79.5743179321289, 28.94281466615429],
               [79.58444595336914, 28.940561320484914],
               [79.59217071533203, 28.944767526093795],
               [79.59114074707031, 28.951527141625252],
               [79.58221435546875, 28.946269700998563],
               [79.56916809082031, 28.9474714252392]]]]),
        {
          "class": 3,
          "system:index": "0",
          "name": "water"
        }),
    snow = /* color: 999900 */ee.Feature(
        ee.Geometry.MultiPolygon(
            [[[[79.83078002929688, 30.321915039121063],
               [79.8046875, 30.33258331240559],
               [79.77584838867188, 30.30176068632071]]],
             [[[80.26885986328125, 30.413150465068878],
               [80.28671264648438, 30.394199462058317],
               [80.31280517578125, 30.394199462058317],
               [80.29220581054688, 30.427361303226718],
               [80.22491455078125, 30.41907189914401]]],
             [[[79.3597412109375, 30.709961938958287],
               [79.28970336914062, 30.803192546290944],
               [79.24575805664062, 30.741835717889764],
               [79.34463500976562, 30.65327143279877]]],
             [[[79.3707275390625, 30.85743710875022],
               [79.3267822265625, 30.9611238394114],
               [79.24575805664062, 30.952880145101915],
               [79.30068969726562, 30.832677089226507]]],
             [[[78.9202880859375, 30.836214626064816],
               [79.04388427734375, 30.822063696500948],
               [79.013671875, 30.876297595828756],
               [78.92578125, 30.865689028446795]]],
             [[[78.56460571289062, 30.96936682219671],
               [78.63876342773438, 31.04940446165597],
               [78.57009887695312, 31.061169032707316],
               [78.52752685546875, 30.982318643027508]]],
             [[[79.61105346679688, 30.790216480462256],
               [79.76486206054688, 30.78785700758592],
               [79.716796875, 30.910472767872786],
               [79.58770751953125, 30.892797477508154]]]]),
        {
          "class": 4,
          "system:index": "0",
          "name": "snow"
        }),
    openField = /* color: 009999 */ee.Feature(
        ee.Geometry.MultiPolygon(
            [[[[77.96799659729004, 30.050225109627753],
               [77.96902656555176, 30.049184989443177],
               [77.96765327453613, 30.047847676012697],
               [77.9688549041748, 30.046658937805077],
               [77.9725456237793, 30.05133951198955],
               [77.97057151794434, 30.05289965422898]]],
             [[[78.03481578826904, 29.952610607236522],
               [78.03415060043335, 29.95331709147866],
               [78.03481578826904, 29.954079345162462],
               [78.03425788879395, 29.954358217001307],
               [78.03466558456421, 29.95469286217537],
               [78.03423643112183, 29.95512046270306],
               [78.03290605545044, 29.953986387709033],
               [78.03455829620361, 29.952313138685394]]],
             [[[78.08675408363342, 29.950658453626612],
               [78.08815956115723, 29.95040745966758],
               [78.08959722518921, 29.952740749447777],
               [78.08909296989441, 29.953279908222637],
               [78.08832049369812, 29.953112583398493],
               [78.08813810348511, 29.953196245845767],
               [78.08730125427246, 29.953196245845767],
               [78.08656096458435, 29.952480464854915],
               [78.08620691299438, 29.95235032230296]]],
             [[[78.0098819732666, 29.94376053726958],
               [78.01136255264282, 29.943500229171526],
               [78.01241397857666, 29.94483894927549],
               [78.01084756851196, 29.945192219631412]]],
             [[[78.01584720611572, 29.94072976506393],
               [78.01661968231201, 29.940562419123168],
               [78.01812171936035, 29.94188258500599],
               [78.01655530929565, 29.942198678462677]]],
             [[[78.01052570343018, 29.939874438409113],
               [78.01140546798706, 29.93968849685883],
               [78.01207065582275, 29.941250395079216],
               [78.01112651824951, 29.941436333710055]]],
             [[[78.0115556716919, 29.932455100850106],
               [78.0129075050354, 29.93215757201706],
               [78.01329374313354, 29.933589421365063],
               [78.01198482513428, 29.93388694591688]]],
             [[[78.01415205001831, 29.935523315049924],
               [78.01573991775513, 29.93520720038283],
               [78.01619052886963, 29.9367133847889],
               [78.01462411880493, 29.937085278663123]]],
             [[[78.00464630126953, 29.937475765734938],
               [78.00614833831787, 29.93721544119067],
               [78.00657749176025, 29.93861002901365],
               [78.00475358963013, 29.938963321491958]]],
             [[[78.00924897193909, 29.932975774167343],
               [78.01007509231567, 29.932752628793562],
               [78.01059007644653, 29.93421236237681],
               [78.00958156585693, 29.934379718998972]]],
             [[[77.90406346321106, 29.92713663879626],
               [77.90531873703003, 29.926030139821787],
               [77.90611267089844, 29.926736812855086],
               [77.90485739707947, 29.927815409390625]]],
             [[[77.90811896324158, 29.927285410829473],
               [77.90892362594604, 29.926522951808654],
               [77.90953516960144, 29.92713663879626],
               [77.90870904922485, 29.92787119854867]]],
             [[[77.90698170661926, 29.928205932840246],
               [77.90734648704529, 29.928494175355883],
               [77.90628433227539, 29.929163638622803],
               [77.90600538253784, 29.928931186609905]]],
             [[[77.90560841560364, 29.924691166631238],
               [77.90574789047241, 29.92456098772147],
               [77.9070246219635, 29.925044508528117],
               [77.90737867355347, 29.925397849170736],
               [77.90635943412781, 29.92623470358423],
               [77.90569424629211, 29.925695398212717]]],
             [[[77.85676002502441, 29.914936575395416],
               [77.85676002502441, 29.919028226691],
               [77.84970045089722, 29.91607109555565],
               [77.8555154800415, 29.914564598758655]]],
             [[[77.84764051437378, 29.916517460600005],
               [77.84890651702881, 29.916052496968724],
               [77.85289764404297, 29.918042526070806],
               [77.85126686096191, 29.920534655955098]]],
             [[[77.87051439285278, 29.92245020592556],
               [77.86939859390259, 29.920999598655634],
               [77.86680221557617, 29.918451686003436],
               [77.87070751190186, 29.91822850806683],
               [77.87214517593384, 29.92077642643036]]],
             [[[77.87193059921265, 29.919009628656426],
               [77.87317514419556, 29.918340097097648],
               [77.87607192993164, 29.920534655955098],
               [77.87441968917847, 29.921985269999688]]],
             [[[77.87416219711304, 29.92274776377857],
               [77.87637233734131, 29.920832219533565],
               [77.87877559661865, 29.92313830711086],
               [77.87643671035767, 29.924979419325563]]],
             [[[77.87461280822754, 29.92709944575321],
               [77.87686586380005, 29.926002244730693],
               [77.8782606124878, 29.927359796762698],
               [77.87643671035767, 29.928717330278555]]],
             [[[77.8717589378357, 29.931320767404817],
               [77.86753177642822, 29.93451918263572],
               [77.8652572631836, 29.932603864933025],
               [77.86982774734497, 29.929238023152234]]],
             [[[79.89266395568848, 28.95370514599224],
               [79.89719152450562, 28.952409614431375],
               [79.89935874938965, 28.958305090885055],
               [79.89508867263794, 28.958624263153453]]],
             [[[79.8431396484375, 28.901382833769766],
               [79.84966278076172, 28.89585984376665],
               [79.8521089553833, 28.89792630300478],
               [79.84678745269775, 28.90224694847467]]],
             [[[79.86326694488525, 28.879552158913153],
               [79.8720645904541, 28.877673228872403],
               [79.87326622009277, 28.884963287544753],
               [79.8647689819336, 28.88763117081205]]],
             [[[79.87571239471436, 28.88981051754675],
               [79.88317966461182, 28.895145966469755],
               [79.8856258392334, 28.895747126625093],
               [79.88738536834717, 28.89969215375586],
               [79.88279342651367, 28.902059098063912]]],
             [[[79.92575168609619, 28.893567904498955],
               [79.92369174957275, 28.894469657133815],
               [79.92055892944336, 28.889059023839483],
               [79.92373466491699, 28.88774389676489]]],
             [[[79.95999813079834, 28.884625100264266],
               [79.96276617050171, 28.883854780681098],
               [79.96598482131958, 28.893060665199776],
               [79.96098518371582, 28.894375724933123],
               [79.96177911758423, 28.88930325989091]]],
             [[[79.96117830276489, 28.894488443563738],
               [79.96446132659912, 28.893567904498955],
               [79.96596336364746, 28.897963874610166],
               [79.96268033981323, 28.898828017780147]]],
             [[[79.96508359909058, 28.893755770277135],
               [79.96647834777832, 28.89322974524155],
               [79.97119903564453, 28.896592502203546],
               [79.96637105941772, 28.89788873138583]]],
             [[[79.97102737426758, 28.90125133742308],
               [79.97173547744751, 28.901044699970228],
               [79.97201442718506, 28.901382833769766],
               [79.97319459915161, 28.9010822704468],
               [79.97375249862671, 28.903580676613867],
               [79.97203588485718, 28.904144218563502]]],
             [[[79.9858546257019, 28.911094317639282],
               [79.9834942817688, 28.9116390354597],
               [79.98370885848999, 28.91210861749204],
               [79.98171329498291, 28.912803594999033],
               [79.98070478439331, 28.910568380478093],
               [79.981369972229, 28.91043689577119],
               [79.98072624206543, 28.90893420157202],
               [79.98312950134277, 28.90812649444677],
               [79.98274326324463, 28.906886745696934],
               [79.98512506484985, 28.90733756513804],
               [79.98557567596436, 28.909929738912222]]],
             [[[79.97870922088623, 28.95911240707266],
               [79.97836589813232, 28.964275326850505],
               [79.97070550918579, 28.965101370120713]]],
             [[[79.98272180557251, 28.974412674611063],
               [79.97722864151001, 28.97574547424902],
               [79.974524974823, 28.969024985632103],
               [79.9729585647583, 28.96936289771479],
               [79.97141361236572, 28.966546929981835],
               [79.97866630554199, 28.965045049198046]]],
             [[[80.00322461128235, 28.98318818755483],
               [80.00404000282288, 28.9874395854789],
               [79.99826788902283, 28.988293597978295],
               [79.99686241149902, 28.98790882398887],
               [80.00232338905334, 28.983244498603096]]],
             [[[80.00229120254517, 28.99047082870411],
               [80.00257015228271, 28.99298584851349],
               [80.00155091285706, 28.993079691352353],
               [80.00083208084106, 28.992084952927005],
               [79.99928712844849, 28.992150643495503],
               [79.99832153320312, 28.99030190727088],
               [80.00296711921692, 28.989757602997834]]],
             [[[79.43098068237305, 29.00806529965205],
               [79.43904876708984, 29.00708947145038],
               [79.44256782531738, 29.01264406275341],
               [79.43758964538574, 29.024052556810513],
               [79.43295478820801, 29.02420266017471],
               [79.4285774230957, 29.020074738158232]]],
             [[[79.47235107421875, 29.00453726181703],
               [79.464111328125, 28.99365213082483],
               [79.47175025939941, 28.988997449132317],
               [79.47835922241211, 28.99688025474534],
               [79.47784423828125, 29.004837525045478]]],
             [[[79.50985908508301, 28.997330682627545],
               [79.50719833374023, 29.008815930459388],
               [79.50196266174316, 29.008740867624052],
               [79.48951721191406, 28.991625117778984],
               [79.5077133178711, 28.991625117778984]]],
             [[[79.45591449737549, 29.008290489466816],
               [79.46076393127441, 29.01031717571499],
               [79.46020603179932, 29.021876033511024],
               [79.45630073547363, 29.021800980165246]]]]),
        {
          "class": 5,
          "system:index": "0",
          "name": "openField"
        }),
    forest = /* color: ff00ff */ee.Feature(
        ee.Geometry.MultiPolygon(
            [[[[79.83783960342407, 28.985675229628797],
               [79.84350442886353, 28.983253883774793],
               [79.84987735748291, 28.989842064193507],
               [79.84496355056763, 28.991474967083658]]],
             [[[79.8870849609375, 29.002285259796388],
               [79.88493919372559, 29.009941866446017],
               [79.88330841064453, 29.009941866446017],
               [79.88373756408691, 29.00588843947475],
               [79.88099098205566, 29.00453726181703],
               [79.87738609313965, 28.99898223473773],
               [79.87858772277832, 28.996354753068953]]],
             [[[79.90313529968262, 29.04063765835085],
               [79.89626884460449, 29.04408942586422],
               [79.88004684448242, 29.021275605217628],
               [79.89077568054199, 29.016021708747697]]],
             [[[79.81636047363281, 29.0056632444253],
               [79.83464241027832, 29.01346971975029],
               [79.83086585998535, 29.025778732324877],
               [79.8153305053711, 29.02210119322105],
               [79.80408668518066, 29.0076899822035],
               [79.81472969055176, 28.997781108547148]]],
             [[[79.55061793327332, 29.1847349271218],
               [79.5515513420105, 29.18291774561069],
               [79.55288171768188, 29.183048883498405],
               [79.55225944519043, 29.183985577821367],
               [79.55073595046997, 29.18617740911456],
               [79.54956650733948, 29.1857746402097]]],
             [[[79.59620475769043, 29.21320614363229],
               [79.60477709770203, 29.21260683108381],
               [79.60527062416077, 29.216614667086546],
               [79.59707379341125, 29.21639929670799]]],
             [[[79.69208836555481, 29.172941407787917],
               [79.69357967376709, 29.176229491071528],
               [79.68925595283508, 29.17620138824197],
               [79.68989968299866, 29.173915665669586],
               [79.68889117240906, 29.17311939789908]]],
             [[[79.98643398284912, 28.89368062400664],
               [80.00716209411621, 28.89326731854675],
               [80.01171112060547, 28.914155970315733],
               [79.99737739562988, 28.915808849536965],
               [79.9856185913086, 28.904876818522897]]],
             [[[80.01518726348877, 28.931960600766065],
               [80.00467300415039, 28.9356037875217],
               [80.00312805175781, 28.92906849536583],
               [79.99797821044922, 28.927415827481642],
               [79.99823570251465, 28.919114528961654],
               [80.0130844116211, 28.921142961898962]]],
             [[[79.37626361846924, 29.205648930409627],
               [79.38257217407227, 29.212709838177542],
               [79.36834573745728, 29.215575266731822],
               [79.35896873474121, 29.209769413155115]]],
             [[[79.39085483551025, 29.219863895679826],
               [79.3747615814209, 29.225481915203446],
               [79.36823844909668, 29.21915225788563],
               [79.38385963439941, 29.214882327303712]]],
             [[[79.33798313140869, 29.194504067701274],
               [79.34725284576416, 29.20252099881366],
               [79.34407711029053, 29.20525560294081],
               [79.34107303619385, 29.203082909726486],
               [79.33691024780273, 29.20626701338249],
               [79.33017253875732, 29.200947631871227],
               [79.33608412742615, 29.19574036431375]]],
             [[[78.9309310913086, 29.39249556973426],
               [78.96732330322266, 29.38052968215464],
               [78.96629333496094, 29.418516514834337],
               [78.93728256225586, 29.419264144688718]]],
             [[[77.96979904174805, 30.059771416748866],
               [77.98104286193848, 30.06311426390437],
               [77.98194408416748, 30.069613921324745],
               [77.97743797302246, 30.074330548274762],
               [77.97263145446777, 30.07429341035803],
               [77.96555042266846, 30.061071426278318]]]]),
        {
          "class": 6,
          "system:index": "0",
          "name": "forest"
        });
/***** End of imports. If edited, may not auto-convert in the playground. *****/
// Mekong basins

var accuracy = 500
var buffer_size = 1
var Mekong = ee.FeatureCollection("ft:13-A9HlCctjhabZVqy0giCUWGOnYqZxx5dlBibAKw")
Map.centerObject(Mekong,5);
addToMap(Mekong, null, "Mekong"); 

//elevation from srtm 30m
var elev = ee.Image("USGS/SRTMGL1_003");
var paletteDEM= ["ff0000","FF3300", "ffff00", "00ff00", "66ffff" ];
//addToMap(elev, {min:20, max:400, palette:paletteDEM}, "elevation");

// elevation is reclassified according to risk- 5 is low risk (low elevation), 1 is high risk 
var elevationrisk = elev.expression(
    "(b(0) <= 125) ? 5 \
      : (b(0) <= 140) ? 4 \
      : (b(0) <= 175) ? 3 \
      : (b(0)<= 200) ? 2 \
      : (b(0) <=300) ? 1 \
      : 0"
  );


////slope 
function radians(img) {
  return img.toFloat().multiply(3.1415927).divide(180);
}
var terrain = ee.call('Terrain', ee.Image("USGS/SRTMGL1_003"));
var slope = terrain.select(['slope']);
var imageofsmall= ee.Image.constant(.001);
var slopeadd= slope.add(imageofsmall)
var slopefortopo= slopeadd.clip (Mekong);

//recolor slope
var paletteslope= ["66ffff","00ff00", "ffff00", "ff3300", "ff0000" ];
//addToMap(slope, {min:0, max:3, palette:paletteDEM}, "slope");

//reclass slope
var sloperisk = slope.expression(
    "(b(0) <= 0.000001) ? 5 \
      : (b(0) <= .5) ? 4 \
      : (b(0) <= 1) ? 3 \
      : (b(0)<= 3) ? 2 \
      : (b(0) <=15) ? 1 \
      : 0"
  );

//try an updated NDVI with filters by QA band or the simple cloud score
//both take too long to run

var QA = ee.ImageCollection('LC8_L1T_TOA').filterDate('2014-05-01', '2015-03-01').filterBounds(Mekong);
var cloudscore =ee.Algorithms.Landsat.simpleComposite(ee.ImageCollection('LC8_L1T_TOA').filterDate('2014-05-01', '2015-03-01').filterBounds(Mekong))
//I want the lowest cloud-freendvi
//I need to make sure the bad pixels are gone

var maskBadPixels = function(img) {
  var bad = img.select('BQA').eq([61440,59424,57344,56320,53248,52256,52224,49184,49152]).reduce('max');
  return img.mask(bad.not());
};
var QA2 = QA.map(maskBadPixels);

/* Generate NDVI */

var ndvicollect = QA2.map(function(img) {
  return img.normalizedDifference (["B5","B4"]);
});

var ndvim = cloudscore.normalizedDifference (["B5","B4"]);

var medndvi= ndvicollect.median()

// Create a Landsat 7, image for clipped polygon (this tends to run fine)
var image = ee.Image("L7_TOA_1YEAR/2012").select("40", "30", "20");
 

// Select the NIR, R and G bands.
var image2 = image.select('40', '30', '20');
var vis = {bands:'40,30,10', min:0, max:0.5, gamma:1.6};
//addToMap(image2, {min:0, max:100}, "RGB 432 annual composite for 2012");


// calculate NDVI
var NDVI12 = image.normalizedDifference(["40","30"]);
//addToMap(NDVI12, {min:-1, max:1}, "NDVI 2012");

//pick one of the ndvis to reclassify

var ndviclass = ndvim.expression(
    "(b(0) <= 0) ? 5 \
          : (b(0) <= 0.2) ? 4\
          : (b(0) <= 0.5) ? 3 \
          : (b(0) <= 0.7) ? 1 \
          : (b(0) <= 0.7) ? 2 \
          :0"
  );
                
// 15 sec flow thanks google!
var FLOWAC = ee.Image('WWF/HydroSHEDS/15ACC');

//flow accumulation in flood zone
var floodflow = FLOWAC.clip(Mekong);
//flow plus 1
var imageof1= ee.Image.constant(1);
var floodflowplus1 = floodflow.add(imageof1);
//addToMap(floodflow,null, "flowac");
//addToMap(floodflowplus1);

// pixel dimensions of flow accumulation
var pixel_area = ee.Image.pixelArea().mask(floodflow.mask());

//contributing catchment area according to 
//topmodel topographic index equation.
// flow accum + 1 * cell^2
var CA =floodflowplus1.multiply(pixel_area);
//addToMap(CA);

//calculate slope from elevation and tan
function radians(img) {
  return img.toFloat().multiply(3.1415927).divide(180);
}
var terrain = ee.call('Terrain', ee.Image('ned_13'));
var slope = radians(terrain.select(['slope']));
//add a very low number to the slope so that zero slopes
//dont get counted out of the index
var imageofalmost0= ee.Image.constant(.0000001);
var nonzeroslopes = slope.add(imageofalmost0);
var tanslope = nonzeroslopes.tan();
var clipped2= tanslope.clip (Mekong);
var paletteDEM= ["66ffff","00ff00", "ffff00", "ff3300", "ff0000" ];
//addToMap (nonzeroslopes, {palette:paletteDEM});

//topographic index is LN([flowaccum+1*cellarea]/tanslope)
var topoindex = CA.divide(slopefortopo);
var logtopo = topoindex.log();
var floodtopoindex = logtopo.clip(Mekong);
//addToMap(floodtopoindex,{min:0, max: 45, palette:paletteDEM}, "topoindex");

var topoclass = floodtopoindex.expression(
    "(b(0) > 50) ? 5 \
          : (b(0) > 35) ? 4\
          : (b(0) > 25) ? 3 \
          : (b(0) > 10) ? 2 \
          : (b(0) > 1) ? 1 \
          :0"
  );
   
var topoclassclip= topoclass.clip(Mekong);
//addToMap(topoclassclip,{min:0, max: 5, palette:paletteDEM}, "topoclassindex");
 
var biorisk2=sloperisk.add (ndviclass);
var biorisk3=biorisk2.add(topoclassclip).add(elevationrisk);
var paletteslope= ["66ffff","00ff00", "ffff00", "ff3300", "ff0000" ];

//make sure I remove the water
var waterland= ee.Image("MODIS/MOD44W/MOD44W_005_2000_02_24").clip(Mekong).select("water_mask");
//var watermask= ee.Image(waterland.first());
print(waterland)

var PALETTE2 = [
  '0000FF',
  'CCCCCC',
  'FF0000'
].join(',');
var vis_params = {min: 0, max: 1, palette: PALETTE2};


var nowaterb=waterland.neq(1)
 var biorisk4= biorisk3.mask(nowaterb)
//Map.addLayer(biorisk4, null, "masked")

//addToMap(biorisk4,{min:0, max: 20, palette:paletteslope}, "biophysical risk");

// Get the CRS string for the image.
var crs =biorisk4.select(0).projection();

////this percentile also takes too long to run

// //threshold the 90th percentile of the index
// //_____________selecting the top 95%___________//
// // Return the percentile values for each band in an image.
// var getPercentile = function (image, percentile, crs) {
//   return image.reduceRegion(
//         ee.Reducer.percentile(percentile), // reducer
//         Mekong, // geometry (Defaults to the footprint of the image's first band)
//         1000, // scale (Set automatically because bestEffort == true)
//         crs,
//         null, // crsTransform,
//         true,
//       10000000, //best effort
//         8// tiling
//   ).getInfo();
// };



// Get the percentile values for each band.
//var p95 = getPercentile(biorisk4, [90]).constant;

//var p95= ee.Reducer.percentile(biorisk3nowater, [85]);

//print("Threshold for top 5% of biophysical risk surface:", p95);


var highBioRisk = (biorisk4.gt(15))
//var highBioRisk = biorisk4.gt(p95)
var mask = highBioRisk.mask(highBioRisk);
var highBioRisk2 = mask.clip(Mekong);
//addToMap(highBioRisk2, {min:0, max:1, palette: '3366FF'},"Potential Flood Area");


// var geometry = ee.call('Geometry.bounds', Mekong.geometry()).getInfo();

// var exportParams = {
//   'scale': 100,
//   'crs': 'EPSG:4326',
//   'region': JSON.stringify(geometry['coordinates'])
// };

// var path = highBioRisk2.getDownloadURL(exportParams);
// print(path);


Export.image(highBioRisk2, 'mekong', {
  scale: 100,
  maxPixels: 5000000000,
  region: JSON.stringify(Mekong.geometry().getInfo())
});
