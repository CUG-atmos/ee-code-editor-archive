/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var geometry = /* color: #d63000 */ee.Geometry.Polygon(
        [[[35.76128128370124, 14.157478678904193],
          [35.98512771924811, 13.786333278931528],
          [36.293431552255925, 13.836342719638543],
          [36.06575495401671, 14.15925150519115],
          [36.51796463331061, 14.143823719809738],
          [36.644994052255925, 14.231030703791136],
          [36.60791519483405, 14.305562670540336],
          [36.5172779878028, 14.308889415059456],
          [36.38887527784186, 14.33816264126152],
          [36.23438003858405, 14.318204037579346],
          [36.043492587412175, 14.29025901149125],
          [35.96452835401374, 14.323526505511062],
          [35.87183121045905, 14.389381585230526],
          [35.80522659620124, 14.343484635566345]]]),
    geometry2 = /* color: #98ff00 */ee.Geometry.Point([35.87183121045905, 14.309893276270852]),
    waterBoundary = /* color: #0b4a8b */ee.Geometry.Polygon(
        [[[35.869729294892494, 14.388854894912848],
          [35.86757333821061, 14.38562095989002],
          [35.86541738152872, 14.38562095989002],
          [35.86326142484683, 14.378075111503415],
          [35.860027489824006, 14.374841176480585],
          [35.85787153314212, 14.374841176480585],
          [35.85463759811929, 14.371607241457754],
          [35.851403663096455, 14.371607241457754],
          [35.847091749732684, 14.366217349753036],
          [35.84385781470986, 14.365139371412093],
          [35.84062387968702, 14.356515544684546],
          [35.84277983636891, 14.347891717957],
          [35.84277983636891, 14.338189912888508],
          [35.847091749732684, 14.33603395620662],
          [35.84816972807363, 14.330644064501904],
          [35.851403663096455, 14.32633215113813],
          [35.851403663096455, 14.324176194456243],
          [35.84816972807363, 14.3230982161153],
          [35.847091749732684, 14.31986428109247],
          [35.84816972807363, 14.316630346069639],
          [35.84385781470986, 14.313396411046808],
          [35.84170185802797, 14.300460670955488],
          [35.84816972807363, 14.290758865886996],
          [35.85894951148306, 14.286446952523223],
          [35.86433940318778, 14.286446952523223],
          [35.868651316551556, 14.28860290920511],
          [35.869729294892494, 14.286446952523223],
          [35.87404120825627, 14.28536897418228],
          [35.876197164938155, 14.277823125795676],
          [35.88374301332476, 14.276745147454733],
          [35.88805492668853, 14.269199299068129],
          [35.88805492668853, 14.26057547234058],
          [35.884820991665705, 14.255185580635864],
          [35.88589897000665, 14.249795688931147],
          [35.89452279673419, 14.24440579722643],
          [35.903146623461744, 14.245483775567374],
          [35.903146623461744, 14.243327818885486],
          [35.90638055848457, 14.241171862203599],
          [35.90422460180269, 14.23793792718077],
          [35.90422460180269, 14.241171862203599],
          [35.89883471009797, 14.243327818885486],
          [35.89452279673419, 14.241171862203599],
          [35.89344481839325, 14.23793792718077],
          [35.89452279673419, 14.233626013816995],
          [35.89883471009797, 14.231470057135109],
          [35.903146623461744, 14.232548035476052],
          [35.905302580143626, 14.235781970498882],
          [35.905302580143626, 14.230392078794166],
          [35.89452279673419, 14.220690273725674],
          [35.89021088337042, 14.204520598611523],
          [35.88374301332476, 14.199130706906805],
          [35.882665034983816, 14.195896771883975],
          [35.88374301332476, 14.193740815202089],
          [35.88158705664287, 14.189428901838316],
          [35.88589897000665, 14.180805075110767],
          [35.88374301332476, 14.173259226724163],
          [35.88697694834759, 14.166791356678504],
          [35.882665034983816, 14.154933594928126],
          [35.884820991665705, 14.15062168156435],
          [35.88805492668853, 14.149543703223408],
          [35.89236684005231, 14.15062168156435],
          [35.89452279673419, 14.153855616587181],
          [35.89991268843891, 14.151699659905296],
          [35.89775673175703, 14.145231789859634],
          [35.89991268843891, 14.141997854836804],
          [35.89991268843891, 14.13768594147303],
          [35.89452279673419, 14.132296049768314],
          [35.89344481839325, 14.125828179722653],
          [35.89560077507514, 14.12151626635888],
          [35.89991268843891, 14.120438288017935],
          [35.903146623461744, 14.12151626635888],
          [35.907458536825516, 14.127984136404539],
          [35.909614493507405, 14.127984136404539],
          [35.91069247184835, 14.120438288017935],
          [35.91500438521212, 14.119360309676992],
          [35.916082363553066, 14.111814461290388],
          [35.91823832023495, 14.110736482949445],
          [35.91931629857589, 14.106424569585672],
          [35.916082363553066, 14.106424569585672],
          [35.91392640687118, 14.102112656221898],
          [35.91500438521212, 14.091332872812464],
          [35.92147225525778, 14.089176916130576],
          [35.92470619028061, 14.090254894471519],
          [35.925784168621554, 14.09348882949435],
          [35.930096081985326, 14.094566807835294],
          [35.932252038667215, 14.091332872812464],
          [35.938719908712876, 14.091332872812464],
          [35.93548597369004, 14.085942981107745],
          [35.93764193037193, 14.079475111062086],
          [35.934407995349105, 14.079475111062086],
          [35.932252038667215, 14.075163197698313],
          [35.934407995349105, 14.070851284334537],
          [35.93333001700816, 14.064383414288878],
          [35.93548597369004, 14.060071500925105],
          [35.94410980041759, 14.057915544243217],
          [35.940875865394766, 14.057915544243217],
          [35.93979788705382, 14.054681609220387],
          [35.93548597369004, 14.053603630879444],
          [35.93548597369004, 14.04605778249284],
          [35.93117406032627, 14.044979804151897],
          [35.93117406032627, 14.041745869129066],
          [35.92901810364439, 14.040667890788121],
          [35.9268621469625, 14.035277999083405],
          [35.92901810364439, 14.02449821567397],
          [35.93117406032627, 14.023420237333028],
          [35.92901810364439, 14.016952367287367],
          [35.930096081985326, 14.00832854055982],
          [35.93548597369004, 14.00509460553699],
          [35.940875865394766, 14.007250562218877],
          [35.940875865394766, 14.010484497241706],
          [35.94734373544042, 14.023420237333028],
          [35.94734373544042, 14.027732150696801],
          [35.94410980041759, 14.034200020742462],
          [35.94734373544042, 14.036355977424348],
          [35.94734373544042, 14.038511934106236],
          [35.95273362714514, 14.036355977424348],
          [35.95596756216797, 14.037433955765293],
          [35.95812351884986, 14.041745869129066],
          [35.96027947553174, 14.040667890788121],
          [35.96782532391835, 14.043901825810952],
          [35.973215215623064, 14.043901825810952],
          [35.97537117230495, 14.050369695856613],
          [35.97105925894118, 14.060071500925105],
          [35.977527128986836, 14.057915544243217],
          [35.98076106400967, 14.054681609220387],
          [35.981839042350614, 14.04929171751567],
          [35.9764491506459, 14.04605778249284],
          [35.9764491506459, 14.038511934106236],
          [35.97429319396401, 14.037433955765293],
          [35.973215215623064, 14.032044064060575],
          [35.97537117230495, 14.027732150696801],
          [35.98291702069156, 14.023420237333028],
          [35.9839949990325, 14.01803034562831],
          [35.986150955714386, 14.015874388946424],
          [35.9915408474191, 14.01479641060548],
          [35.99046286907816, 14.00509460553699],
          [35.99369680410099, 13.999704713832273],
          [35.99369680410099, 13.995392800468498],
          [35.9915408474191, 13.992158865445669],
          [35.99261882576005, 13.985690995400008],
          [35.98938489073722, 13.985690995400008],
          [35.98507297737344, 13.982457060377177],
          [35.98291702069156, 13.97706716867246],
          [35.9839949990325, 13.974911211990573],
          [35.981839042350614, 13.97383323364963],
          [35.981839042350614, 13.9705992986268],
          [35.979683085668725, 13.969521320285857],
          [35.977527128986836, 13.964131428581139],
          [35.97860510732778, 13.959819515217365],
          [35.9839949990325, 13.957663558535478],
          [35.98722893405533, 13.958741536876422],
          [35.98938489073722, 13.961975471899253],
          [35.99261882576005, 13.961975471899253],
          [35.995852760782874, 13.966287385263026],
          [35.995852760782874, 13.969521320285857],
          [36.00339860916948, 13.97383323364963],
          [36.00555456585137, 13.981379082036234],
          [36.00986647921514, 13.982457060377177],
          [36.010944457556086, 13.98676897374095],
          [36.008788500874196, 13.999704713832273],
          [36.010944457556086, 14.004016627196046],
          [36.013100414237975, 13.999704713832273],
          [36.01202243589703, 13.995392800468498],
          [36.0163343492608, 13.984613017059065],
          [36.02495817598835, 13.98030110369529],
          [36.02819211101118, 13.981379082036234],
          [36.033582002715896, 13.979223125354347],
          [36.03465998105684, 13.9705992986268],
          [36.03897189442061, 13.965209406922082],
          [36.04867369948911, 13.965209406922082],
          [36.054063591193824, 13.959819515217365],
          [36.05514156953477, 13.955507601853592],
          [36.058375504557596, 13.955507601853592],
          [36.056219547875706, 13.953351645171704],
          [36.05298561285288, 13.953351645171704],
          [36.05082965617099, 13.950117710148874],
          [36.04328380778439, 13.950117710148874],
          [36.03897189442061, 13.947961753466988],
          [36.03681593773873, 13.93933792673944],
          [36.03897189442061, 13.93610399171661],
          [36.03897189442061, 13.921012294943402],
          [36.04328380778439, 13.919934316602458],
          [36.04436178612533, 13.915622403238684],
          [36.04867369948911, 13.914544424897741],
          [36.05298561285288, 13.916700381579629],
          [36.05514156953477, 13.924246229966233],
          [36.056219547875706, 13.916700381579629],
          [36.060531461239485, 13.915622403238684],
          [36.05945348289854, 13.913466446556798],
          [36.06160943958043, 13.90807655485208],
          [36.0659213529442, 13.906998576511137],
          [36.07238922298986, 13.899452728124533],
          [36.07885709303552, 13.899452728124533],
          [36.07885709303552, 13.897296771442647],
          [36.085324963081185, 13.890828901396986],
          [36.08424698474024, 13.885439009692268],
          [36.08640294142212, 13.881127096328495],
          [36.089636876444956, 13.880049117987552],
          [36.091792833126846, 13.87034731291906],
          [36.09610474649062, 13.868191356237174],
          [36.0982607031725, 13.864957421214344],
          [36.10472857321816, 13.863879442873401],
          [36.10688452990005, 13.861723486191513],
          [36.107962508240995, 13.85741157282774],
          [36.105806551559105, 13.853099659463966],
          [36.107962508240995, 13.846631789418305],
          [36.11335239994571, 13.84447583273642],
          [36.114430378286656, 13.836929984349815],
          [36.11874229165043, 13.831540092645097],
          [36.12089824833232, 13.831540092645097],
          [36.12089824833232, 13.826150200940381],
          [36.12521016169609, 13.823994244258493],
          [36.130600053400805, 13.823994244258493],
          [36.13383398842364, 13.820760309235663],
          [36.13383398842364, 13.811058504167173],
          [36.14137983681024, 13.811058504167173],
          [36.17048525201571, 13.81644839587189],
          [36.16832929533383, 13.81968233089472],
          [36.164017381970055, 13.820760309235663],
          [36.16509536031099, 13.82291626591755],
          [36.16293940362911, 13.827228179281324],
          [36.15108164187873, 13.828306157622267],
          [36.14461377183307, 13.826150200940381],
          [36.14353579349213, 13.833696049326985],
          [36.139223880128355, 13.834774027667928],
          [36.137067923446466, 13.836929984349815],
          [36.13598994510552, 13.842319876054532],
          [36.130600053400805, 13.845553811077362],
          [36.12952207505986, 13.853099659463966],
          [36.12628814003703, 13.856333594486797],
          [36.12736611837798, 13.858489551168683],
          [36.13598994510552, 13.858489551168683],
          [36.13814590178741, 13.862801464532456],
          [36.137067923446466, 13.864957421214344],
          [36.139223880128355, 13.867113377896231],
          [36.14569175017402, 13.867113377896231],
          [36.15000366353779, 13.861723486191513],
          [36.15647153358345, 13.86064550785057],
          [36.159705468606276, 13.861723486191513],
          [36.161861425288166, 13.864957421214344],
          [36.16509536031099, 13.863879442873401],
          [36.17048525201571, 13.866035399555287],
          [36.171563230356654, 13.87034731291906],
          [36.17587514372043, 13.872503269600948],
          [36.19096684049364, 13.868191356237174],
          [36.19420077551647, 13.87034731291906],
          [36.20174662390307, 13.871425291260005],
          [36.204980558925904, 13.875737204623778],
          [36.21360438565345, 13.877893161305664],
          [36.21468236399439, 13.87358124794189],
          [36.21683832067628, 13.872503269600948],
          [36.21683832067628, 13.869269334578117],
          [36.22115023404005, 13.868191356237174],
          [36.22007225569911, 13.863879442873401],
          [36.22330619072194, 13.856333594486797],
          [36.225462147403825, 13.855255616145852],
          [36.225462147403825, 13.852021681123023],
          [36.231930017449486, 13.849865724441136],
          [36.2373199091542, 13.852021681123023],
          [36.23839788749515, 13.843397854395475],
          [36.24378777919986, 13.836929984349815],
          [36.24917767090458, 13.834774027667928],
          [36.25780149763213, 13.834774027667928],
          [36.258879475973075, 13.830462114304154],
          [36.29337478288326, 13.836929984349815],
          [36.29121882620137, 13.840163919372644],
          [36.28259499947383, 13.84447583273642],
          [36.265347346018736, 13.843397854395475],
          [36.26103543265496, 13.846631789418305],
          [36.250255649245524, 13.846631789418305],
          [36.25133362758647, 13.859567529509627],
          [36.24917767090458, 13.864957421214344],
          [36.24486575754081, 13.867113377896231],
          [36.236241930813264, 13.866035399555287],
          [36.23947586583609, 13.868191356237174],
          [36.23947586583609, 13.875737204623778],
          [36.236241930813264, 13.878971139646609],
          [36.225462147403825, 13.881127096328495],
          [36.225462147403825, 13.884361031351325],
          [36.22115023404005, 13.888672944715099],
          [36.21468236399439, 13.890828901396986],
          [36.204980558925904, 13.888672944715099],
          [36.200668645562125, 13.885439009692268],
          [36.19420077551647, 13.886516988033213],
          [36.18881088381175, 13.884361031351325],
          [36.182343013766086, 13.888672944715099],
          [36.180187057084204, 13.894062836419817],
          [36.17587514372043, 13.89514081476076],
          [36.171563230356654, 13.892984858078872],
          [36.17048525201571, 13.886516988033213],
          [36.16725131699288, 13.883283053010382],
          [36.16293940362911, 13.88220507466944],
          [36.157549511924394, 13.884361031351325],
          [36.14461377183307, 13.880049117987552],
          [36.14353579349213, 13.883283053010382],
          [36.139223880128355, 13.885439009692268],
          [36.130600053400805, 13.884361031351325],
          [36.12736611837798, 13.89514081476076],
          [36.11658633496854, 13.896218793101703],
          [36.11119644326382, 13.894062836419817],
          [36.10904048658194, 13.890828901396986],
          [36.10688452990005, 13.894062836419817],
          [36.10041665985439, 13.89514081476076],
          [36.10041665985439, 13.903764641488307],
          [36.09610474649062, 13.904842619829251],
          [36.09502676814967, 13.906998576511137],
          [36.091792833126846, 13.906998576511137],
          [36.091792833126846, 13.909154533193025],
          [36.08855889810401, 13.912388468215855],
          [36.089636876444956, 13.917778359920572],
          [36.08748091976307, 13.925324208307176],
          [36.08209102805835, 13.927480164989062],
          [36.08424698474024, 13.93610399171661],
          [36.081013049717406, 13.941493883421327],
          [36.08209102805835, 13.943649840103214],
          [36.085324963081185, 13.943649840103214],
          [36.08855889810401, 13.94903973180793],
          [36.08640294142212, 13.953351645171704],
          [36.08640294142212, 13.959819515217365],
          [36.083169006399295, 13.963053450240196],
          [36.08209102805835, 13.969521320285857],
          [36.07777911469458, 13.9705992986268],
          [36.07777911469458, 13.972755255308686],
          [36.074545179671745, 13.97383323364963],
          [36.074545179671745, 13.98030110369529],
          [36.06915528796703, 13.982457060377177],
          [36.068077309626084, 13.985690995400008],
          [36.06160943958043, 13.98676897374095],
          [36.06376539626231, 13.991080887104724],
          [36.06160943958043, 13.997548757150385],
          [36.06160943958043, 14.006172583877932],
          [36.05729752621665, 14.010484497241706],
          [36.049751677830045, 14.010484497241706],
          [36.04867369948911, 14.012640453923593],
          [36.049751677830045, 14.020186302310197],
          [36.04759572114816, 14.023420237333028],
          [36.04759572114816, 14.036355977424348],
          [36.04436178612533, 14.040667890788121],
          [36.04436178612533, 14.043901825810952],
          [36.0411278511025, 14.044979804151897],
          [36.042205829443446, 14.0525256525385],
          [36.03897189442061, 14.056837565902274],
          [36.03789391607967, 14.064383414288878],
          [36.033582002715896, 14.068695327652652],
          [36.03034806769307, 14.068695327652652],
          [36.02172424096552, 14.073007241016425],
          [36.0163343492608, 14.070851284334537],
          [36.01417839257891, 14.075163197698313],
          [36.004476587510425, 14.078397132721141],
          [36.002320630828535, 14.082709046084915],
          [35.99693073912382, 14.08378702442586],
          [35.998008717464764, 14.085942981107745],
          [35.99477478244194, 14.091332872812464],
          [35.99477478244194, 14.094566807835294],
          [35.99046286907816, 14.09672276451718],
          [35.988306912396276, 14.103190634562841],
          [35.973215215623064, 14.104268612903784],
          [35.96782532391835, 14.102112656221898],
          [35.96782532391835, 14.109658504608502],
          [35.96243543221363, 14.11289243963133],
          [35.959201497190804, 14.120438288017935],
          [35.954889583827025, 14.12475020138171],
          [35.948421713781364, 14.126906158063596],
          [35.94734373544042, 14.1344520064502],
          [35.94949969212231, 14.138763919813973],
          [35.94626575709948, 14.145231789859634],
          [35.94518777875854, 14.153855616587181],
          [35.940875865394766, 14.160323486632842],
          [35.9419538437357, 14.167869335019446],
          [35.94410980041759, 14.171103270042277],
          [35.94303182207665, 14.17541518340605],
          [35.95596756216797, 14.17541518340605],
          [35.96135745387269, 14.173259226724163],
          [35.96566936723646, 14.176493161746993],
          [35.97213723728212, 14.176493161746993],
          [35.97429319396401, 14.170025291701334],
          [35.98076106400967, 14.167869335019446],
          [35.98076106400967, 14.161401464973785],
          [35.98722893405533, 14.158167529950955],
          [35.98722893405533, 14.13768594147303],
          [36.00016467414665, 14.13121807142737],
          [36.00986647921514, 14.132296049768314],
          [36.01741232760175, 14.130140093086426],
          [36.02172424096552, 14.132296049768314],
          [36.02172424096552, 14.140919876495861],
          [36.004476587510425, 14.146309768200577],
          [36.00339860916948, 14.153855616587181],
          [36.006632544192314, 14.154933594928126],
          [36.008788500874196, 14.16247944331473],
          [36.00771052253325, 14.171103270042277],
          [36.00555456585137, 14.17218124838322],
          [36.00339860916948, 14.178649118428881],
          [35.99693073912382, 14.180805075110767],
          [35.998008717464764, 14.182961031792654],
          [35.99369680410099, 14.189428901838316],
          [35.99369680410099, 14.192662836861146],
          [35.98938489073722, 14.193740815202089],
          [35.98722893405533, 14.199130706906805],
          [35.97537117230495, 14.202364641929636],
          [35.96890330225929, 14.198052728565862],
          [35.963513410554576, 14.19697475022492],
          [35.96243543221363, 14.201286663588693],
          [35.95596756216797, 14.204520598611523],
          [35.95596756216797, 14.212066446998127],
          [35.95273362714514, 14.215300382020958],
          [35.94410980041759, 14.216378360361901],
          [35.9419538437357, 14.223924208748505],
          [35.94734373544042, 14.222846230407562],
          [35.950577670463254, 14.223924208748505],
          [35.95273362714514, 14.227158143771335],
          [35.95381160548608, 14.225002187089448],
          [35.96135745387269, 14.222846230407562],
          [35.9667473455774, 14.214222403680013],
          [35.9764491506459, 14.20991049031624],
          [35.98507297737344, 14.202364641929636],
          [35.9915408474191, 14.201286663588693],
          [35.995852760782874, 14.198052728565862],
          [36.002320630828535, 14.20020868524775],
          [36.00771052253325, 14.20020868524775],
          [36.01202243589703, 14.198052728565862],
          [36.00986647921514, 14.191584858520201],
          [36.01202243589703, 14.187272945156428],
          [36.01525637091986, 14.186194966815485],
          [36.02280221930646, 14.18835092349737],
          [36.02280221930646, 14.19697475022492],
          [36.027114132670235, 14.19697475022492],
          [36.031426046034014, 14.192662836861146],
          [36.04004987276156, 14.191584858520201],
          [36.04436178612533, 14.18835092349737],
          [36.05514156953477, 14.193740815202089],
          [36.060531461239485, 14.191584858520201],
          [36.07131124464892, 14.192662836861146],
          [36.07777911469458, 14.189428901838316],
          [36.083169006399295, 14.192662836861146],
          [36.083169006399295, 14.195896771883975],
          [36.09394878980873, 14.195896771883975],
          [36.0982607031725, 14.199130706906805],
          [36.10365059487722, 14.19697475022492],
          [36.10904048658194, 14.20020868524775],
          [36.10904048658194, 14.203442620270579],
          [36.11766431330948, 14.203442620270579],
          [36.12736611837798, 14.198052728565862],
          [36.12736611837798, 14.194818793543032],
          [36.12952207505986, 14.193740815202089],
          [36.132756010082694, 14.185116988474542],
          [36.139223880128355, 14.182961031792654],
          [36.14245781515118, 14.184039010133597],
          [36.14892568519684, 14.180805075110767],
          [36.153237598560615, 14.182961031792654],
          [36.153237598560615, 14.191584858520201],
          [36.15862749026533, 14.191584858520201],
          [36.159705468606276, 14.189428901838316],
          [36.161861425288166, 14.189428901838316],
          [36.16293940362911, 14.186194966815485],
          [36.171563230356654, 14.186194966815485],
          [36.1726412086976, 14.182961031792654],
          [36.18557694878892, 14.178649118428881],
          [36.19527875385741, 14.181883053451712],
          [36.19635673219835, 14.186194966815485],
          [36.200668645562125, 14.187272945156428],
          [36.202824602244014, 14.191584858520201],
          [36.207136515607786, 14.192662836861146],
          [36.20821449394873, 14.19697475022492],
          [36.2125264073125, 14.199130706906805],
          [36.2125264073125, 14.20667655529341],
          [36.207136515607786, 14.20991049031624],
          [36.19851268888024, 14.20991049031624],
          [36.193122797175526, 14.207754533634354],
          [36.18988886215269, 14.204520598611523],
          [36.18988886215269, 14.202364641929636],
          [36.18557694878892, 14.199130706906805],
          [36.184498970447976, 14.202364641929636],
          [36.17695312206137, 14.202364641929636],
          [36.17695312206137, 14.205598576952466],
          [36.1726412086976, 14.20667655529341],
          [36.17371918703854, 14.20991049031624],
          [36.1726412086976, 14.21314442533907],
          [36.16940727367477, 14.214222403680013],
          [36.16940727367477, 14.218534317043787],
          [36.178031100402315, 14.219612295384731],
          [36.182343013766086, 14.217456338702844],
          [36.186654927129865, 14.220690273725674],
          [36.19204481883458, 14.217456338702844],
          [36.20821449394873, 14.218534317043787],
          [36.21037045063062, 14.222846230407562],
          [36.20821449394873, 14.227158143771335],
          [36.20821449394873, 14.232548035476052],
          [36.211448428971565, 14.239015905521713],
          [36.21683832067628, 14.240093883862656],
          [36.21899427735816, 14.243327818885486],
          [36.225462147403825, 14.243327818885486],
          [36.22654012574477, 14.239015905521713],
          [36.23085203910854, 14.23793792718077],
          [36.236241930813264, 14.241171862203599],
          [36.2373199091542, 14.24763973224926],
          [36.240553844177036, 14.248717710590203],
          [36.24378777919986, 14.253029623953976],
          [36.24594373588175, 14.251951645613033],
          [36.2545675626093, 14.254107602294921],
          [36.26642532435968, 14.254107602294921],
          [36.26965925938251, 14.26057547234058],
          [36.26858128104156, 14.262731429022468],
          [36.27073723772345, 14.262731429022468],
          [36.27397117274628, 14.265965364045298],
          [36.27397117274628, 14.269199299068129],
          [36.27720510776911, 14.271355255750015],
          [36.27720510776911, 14.277823125795676],
          [36.281517021132885, 14.275667169113788],
          [36.29337478288326, 14.274589190772845],
          [36.297686696247034, 14.276745147454733],
          [36.297686696247034, 14.279979082477563],
          [36.304154566292695, 14.281057060818506],
          [36.306310522974584, 14.283213017500392],
          [36.310622436338356, 14.278901104136619],
          [36.312778393020245, 14.278901104136619],
          [36.31709030638402, 14.269199299068129],
          [36.32140221974779, 14.267043342386241],
          [36.32248019808873, 14.26380940736341],
          [36.33002604647534, 14.26057547234058],
          [36.336493916521, 14.26057547234058],
          [36.34188380822572, 14.26380940736341],
          [36.345117743248544, 14.26380940736341],
          [36.34727369993043, 14.268121320727184],
          [36.35697550499893, 14.271355255750015],
          [36.360209440021755, 14.276745147454733],
          [36.36452135338553, 14.277823125795676],
          [36.36452135338553, 14.275667169113788],
          [36.36991124509024, 14.270277277409072],
          [36.37098922343119, 14.26380940736341],
          [36.37422315845402, 14.26057547234058],
          [36.37422315845402, 14.258419515658694],
          [36.378535071817794, 14.254107602294921],
          [36.38392496352251, 14.253029623953976],
          [36.387158898545344, 14.248717710590203],
          [36.3860809202044, 14.241171862203599],
          [36.38931485522723, 14.235781970498882],
          [36.39686070361383, 14.232548035476052],
          [36.405484530341376, 14.232548035476052],
          [36.41303037872798, 14.236859948839825],
          [36.41949824877364, 14.232548035476052],
          [36.42704409716025, 14.232548035476052],
          [36.430278032183075, 14.23470399215794],
          [36.43782388056968, 14.235781970498882],
          [36.44429175061534, 14.22608016543039],
          [36.450759620661, 14.223924208748505],
          [36.45830546904761, 14.217456338702844],
          [36.463695360752325, 14.215300382020958],
          [36.46908525245704, 14.216378360361901],
          [36.47231918747987, 14.219612295384731],
          [36.47231918747987, 14.221768252066617],
          [36.48525492757119, 14.217456338702844],
          [36.49819066766251, 14.219612295384731],
          [36.508970451071946, 14.228236122112278],
          [36.51220438609478, 14.235781970498882],
          [36.51220438609478, 14.241171862203599],
          [36.51867225614044, 14.241171862203599],
          [36.52082821282232, 14.245483775567374],
          [36.52621810452704, 14.24763973224926],
          [36.533763952913645, 14.24763973224926],
          [36.53807586627742, 14.25087366727209],
          [36.54885564968686, 14.24763973224926],
          [36.558557454755345, 14.248717710590203],
          [36.55963543309629, 14.25087366727209],
          [36.56610330314195, 14.253029623953976],
          [36.567181281482895, 14.258419515658694],
          [36.57149319484667, 14.261653450681525],
          [36.57257117318761, 14.264887385704355],
          [36.57149319484667, 14.269199299068129],
          [36.56610330314195, 14.271355255750015],
          [36.560713411437234, 14.269199299068129],
          [36.55963543309629, 14.265965364045298],
          [36.556401498073456, 14.264887385704355],
          [36.556401498073456, 14.261653450681525],
          [36.55316756305063, 14.261653450681525],
          [36.552089584709684, 14.259497493999637],
          [36.53915384461836, 14.261653450681525],
          [36.53484193125459, 14.258419515658694],
          [36.5326859745727, 14.259497493999637],
          [36.52837406120893, 14.257341537317751],
          [36.51543832111761, 14.258419515658694],
          [36.51004842941289, 14.255185580635864],
          [36.51004842941289, 14.253029623953976],
          [36.50142460268535, 14.251951645613033],
          [36.49711268932157, 14.24763973224926],
          [36.496034710980624, 14.242249840544543],
          [36.49926864600346, 14.236859948839825],
          [36.49172279761685, 14.230392078794166],
          [36.486332905912136, 14.229314100453221],
          [36.482020992548364, 14.230392078794166],
          [36.47878705752553, 14.233626013816995],
          [36.470163230797986, 14.23470399215794],
          [36.46692929577515, 14.233626013816995],
          [36.46477333909327, 14.230392078794166],
          [36.461539404070436, 14.230392078794166],
          [36.45830546904761, 14.233626013816995],
          [36.45183759900195, 14.235781970498882],
          [36.44644770729723, 14.246561753908317],
          [36.44213579393345, 14.248717710590203],
          [36.43566792388779, 14.248717710590203],
          [36.42273218379648, 14.24440579722643],
          [36.41949824877364, 14.24763973224926],
          [36.409796443705154, 14.248717710590203],
          [36.401172616977604, 14.24440579722643],
          [36.39793868195478, 14.255185580635864],
          [36.39578272527289, 14.256263558976807],
          [36.39254879025006, 14.262731429022468],
          [36.38931485522723, 14.262731429022468],
          [36.385002941863455, 14.265965364045298],
          [36.38176900684062, 14.275667169113788],
          [36.37961305015874, 14.276745147454733],
          [36.37745709347685, 14.283213017500392],
          [36.37422315845402, 14.28536897418228],
          [36.37314518011308, 14.28860290920511],
          [36.36344337504458, 14.29183684422794],
          [36.35481954831704, 14.290758865886996],
          [36.35050763495327, 14.28860290920511],
          [36.35050763495327, 14.28536897418228],
          [36.34727369993043, 14.284290995841337],
          [36.34727369993043, 14.28213503915945],
          [36.33972785154383, 14.279979082477563],
          [36.335415938180056, 14.275667169113788],
          [36.333259981498166, 14.275667169113788],
          [36.32571413311157, 14.283213017500392],
          [36.32679211145251, 14.28536897418228],
          [36.32248019808873, 14.293992800909827],
          [36.31924626306591, 14.293992800909827],
          [36.31709030638402, 14.297226735932657],
          [36.31385637136119, 14.2983047142736],
          [36.310622436338356, 14.297226735932657],
          [36.306310522974584, 14.300460670955488],
          [36.297686696247034, 14.300460670955488],
          [36.29445276122421, 14.299382692614545],
          [36.29229680454232, 14.295070779250771],
          [36.28906286951949, 14.293992800909827],
          [36.2869069128376, 14.290758865886996],
          [36.275049151087224, 14.297226735932657],
          [36.27073723772345, 14.295070779250771],
          [36.26426936767779, 14.295070779250771],
          [36.2621134109959, 14.29183684422794],
          [36.258879475973075, 14.290758865886996],
          [36.258879475973075, 14.28536897418228],
          [36.25564554095024, 14.28213503915945],
          [36.25564554095024, 14.278901104136619],
          [36.24594373588175, 14.278901104136619],
          [36.24163182251798, 14.275667169113788],
          [36.236241930813264, 14.277823125795676],
          [36.23085203910854, 14.274589190772845],
          [36.227618104085714, 14.274589190772845],
          [36.22654012574477, 14.27243323409096],
          [36.222228212381, 14.271355255750015],
          [36.222228212381, 14.265965364045298],
          [36.22007225569911, 14.264887385704355],
          [36.22007225569911, 14.262731429022468],
          [36.21576034233534, 14.267043342386241],
          [36.21468236399439, 14.271355255750015],
          [36.207136515607786, 14.271355255750015],
          [36.202824602244014, 14.262731429022468],
          [36.202824602244014, 14.258419515658694],
          [36.1974347105393, 14.255185580635864],
          [36.19635673219835, 14.25087366727209],
          [36.18773290547081, 14.24763973224926],
          [36.186654927129865, 14.243327818885486],
          [36.18126503542515, 14.24440579722643],
          [36.17695312206137, 14.242249840544543],
          [36.17479716537949, 14.243327818885486],
          [36.17371918703854, 14.24763973224926],
          [36.16293940362911, 14.24763973224926],
          [36.159705468606276, 14.246561753908317],
          [36.15862749026533, 14.243327818885486],
          [36.15647153358345, 14.243327818885486],
          [36.153237598560615, 14.239015905521713],
          [36.146769728514954, 14.23793792718077],
          [36.14569175017402, 14.23470399215794],
          [36.14137983681024, 14.233626013816995],
          [36.14137983681024, 14.230392078794166],
          [36.139223880128355, 14.230392078794166],
          [36.14030185846929, 14.232548035476052],
          [36.13814590178741, 14.236859948839825],
          [36.128444096718916, 14.236859948839825],
          [36.128444096718916, 14.243327818885486],
          [36.12197622667326, 14.245483775567374],
          [36.11658633496854, 14.243327818885486],
          [36.1155083566276, 14.240093883862656],
          [36.112274421604766, 14.23793792718077],
          [36.112274421604766, 14.230392078794166],
          [36.10688452990005, 14.229314100453221],
          [36.10257261653628, 14.231470057135109],
          [36.09610474649062, 14.229314100453221],
          [36.09502676814967, 14.227158143771335],
          [36.08855889810401, 14.228236122112278],
          [36.07993507137646, 14.223924208748505],
          [36.07885709303552, 14.221768252066617],
          [36.07562315801269, 14.221768252066617],
          [36.07346720133081, 14.217456338702844],
          [36.06915528796703, 14.217456338702844],
          [36.06268741792137, 14.219612295384731],
          [36.06160943958043, 14.223924208748505],
          [36.05514156953477, 14.22608016543039],
          [36.05298561285288, 14.229314100453221],
          [36.04867369948911, 14.230392078794166],
          [36.04004987276156, 14.228236122112278],
          [36.04004987276156, 14.231470057135109],
          [36.03681593773873, 14.232548035476052],
          [36.03465998105684, 14.23793792718077],
          [36.02819211101118, 14.241171862203599],
          [36.02603615432929, 14.240093883862656],
          [36.02819211101118, 14.245483775567374],
          [36.02603615432929, 14.25087366727209],
          [36.02172424096552, 14.251951645613033],
          [36.01741232760175, 14.249795688931147],
          [36.01741232760175, 14.242249840544543],
          [36.02172424096552, 14.241171862203599],
          [36.01849030594269, 14.239015905521713],
          [36.013100414237975, 14.24440579722643],
          [36.004476587510425, 14.24440579722643],
          [36.002320630828535, 14.251951645613033],
          [36.00016467414665, 14.253029623953976],
          [36.00016467414665, 14.26057547234058],
          [35.995852760782874, 14.262731429022468],
          [35.995852760782874, 14.270277277409072],
          [35.9915408474191, 14.273511212431902],
          [35.98722893405533, 14.274589190772845],
          [35.981839042350614, 14.271355255750015],
          [35.96998128060024, 14.271355255750015],
          [35.96782532391835, 14.274589190772845],
          [35.959201497190804, 14.275667169113788],
          [35.95596756216797, 14.28213503915945],
          [35.94949969212231, 14.283213017500392],
          [35.93333001700816, 14.278901104136619],
          [35.9268621469625, 14.27243323409096],
          [35.925784168621554, 14.267043342386241],
          [35.923628211939665, 14.267043342386241],
          [35.91931629857589, 14.271355255750015],
          [35.91392640687118, 14.273511212431902],
          [35.91177045018929, 14.276745147454733],
          [35.909614493507405, 14.276745147454733],
          [35.909614493507405, 14.278901104136619],
          [35.907458536825516, 14.279979082477563],
          [35.907458536825516, 14.286446952523223],
          [35.91177045018929, 14.292914822568884],
          [35.91177045018929, 14.308006519342092],
          [35.907458536825516, 14.3230982161153],
          [35.90422460180269, 14.32633215113813],
          [35.89667875341608, 14.32956608616096],
          [35.88589897000665, 14.32956608616096],
          [35.88374301332476, 14.332800021183791],
          [35.88158705664287, 14.344657782934169],
          [35.878353121620044, 14.348969696297942],
          [35.869729294892494, 14.350047674638885],
          [35.862183446505895, 14.346813739616055],
          [35.860027489824006, 14.343579804593224],
          [35.85463759811929, 14.350047674638885],
          [35.85463759811929, 14.356515544684546],
          [35.85894951148306, 14.35759352302549],
          [35.860027489824006, 14.359749479707377],
          [35.86649535986967, 14.359749479707377],
          [35.86757333821061, 14.36406139307115],
          [35.87296322991533, 14.368373306434924],
          [35.8772751432791, 14.379153089844358],
          [35.880509078301934, 14.379153089844358],
          [35.882665034983816, 14.381309046526244],
          [35.87511918659721, 14.387776916571905],
          [35.869729294892494, 14.388854894912848]],
         [[36.05945348289854, 13.954429623512649],
          [36.058375504557596, 13.953351645171704],
          [36.05945348289854, 13.953351645171704],
          [36.05945348289854, 13.954429623512649]],
         [[36.01202243589703, 14.00509460553699],
          [36.010944457556086, 14.004016627196046],
          [36.01202243589703, 14.004016627196046],
          [36.01202243589703, 14.00509460553699]],
         [[36.0163343492608, 14.032044064060575],
          [36.010944457556086, 14.030966085719632],
          [36.01202243589703, 14.023420237333028],
          [36.00986647921514, 14.016952367287367],
          [36.013100414237975, 14.013718432264536],
          [36.01525637091986, 14.01803034562831],
          [36.020646262624574, 14.020186302310197],
          [36.02172424096552, 14.02449821567397],
          [36.02172424096552, 14.026654172355858],
          [36.01849030594269, 14.027732150696801],
          [36.0163343492608, 14.032044064060575]],
         [[35.9419538437357, 14.225002187089448],
          [35.940875865394766, 14.223924208748505],
          [35.9419538437357, 14.223924208748505],
          [35.9419538437357, 14.225002187089448]],
         [[35.940875865394766, 14.22608016543039],
          [35.93979788705382, 14.225002187089448],
          [35.940875865394766, 14.225002187089448],
          [35.940875865394766, 14.22608016543039]],
         [[35.900990666779855, 14.269199299068129],
          [35.89883471009797, 14.257341537317751],
          [35.90853651516646, 14.257341537317751],
          [35.91500438521212, 14.249795688931147],
          [35.92255023359873, 14.251951645613033],
          [35.92255023359873, 14.254107602294921],
          [35.916082363553066, 14.256263558976807],
          [35.91392640687118, 14.259497493999637],
          [35.90422460180269, 14.264887385704355],
          [35.900990666779855, 14.269199299068129]],
         [[35.878353121620044, 14.31986428109247],
          [35.876197164938155, 14.315552367728696],
          [35.87296322991533, 14.313396411046808],
          [35.862183446505895, 14.313396411046808],
          [35.860027489824006, 14.308006519342092],
          [35.85679355480117, 14.308006519342092],
          [35.85679355480117, 14.300460670955488],
          [35.860027489824006, 14.2983047142736],
          [35.868651316551556, 14.30153864929643],
          [35.880509078301934, 14.299382692614545],
          [35.884820991665705, 14.287524930864167],
          [35.89021088337042, 14.286446952523223],
          [35.89452279673419, 14.28213503915945],
          [35.89560077507514, 14.290758865886996],
          [35.89991268843891, 14.2983047142736],
          [35.89667875341608, 14.315552367728696],
          [35.89128886171137, 14.317708324410583],
          [35.884820991665705, 14.316630346069639],
          [35.878353121620044, 14.31986428109247]]], null, false);
/***** End of imports. If edited, may not auto-convert in the playground. *****/
waterBoundary = ee.Geometry.Polygon(waterBoundary.coordinates().get(0)).buffer(300 * 30).simplify(600)
Map.addLayer(waterBoundary)
print(waterBoundary)

// throw(0)

var utils = require('users/gena/packages:utils')

Map.addLayer(waterBoundary.simplify(1000), {}, 'water boundary (vector)', false)

var waterBoundaryImage = ee.Image(0).float().paint(waterBoundary.simplify(1000), 1)
Map.addLayer(waterBoundaryImage, { min: 0, max: 1}, 'water boundary mask (image)', false)

print('Map scale: ', Map.getScale())
print('Map zoom: ', Map.getZoom())

var region = geometry.buffer(300 * 30)

var assets = require('users/gena/packages:assets')
var animation = require('users/gena/packages:animation')
var palettes = require('users/gena/packages:palettes')
var charting = require('users/gena/packages:charting')
var tiler = require('users/gena/packages:tiler')
var utils = require('users/gena/packages:utils')

var start = ee.Date('2013-01-01')
var stop = ee.Date('2020-01-01')

var images = assets.getImages(geometry2, {
  resample: true,
  missions: [
    // 'L8',
    'S2'
  ],
  filter: ee.Filter.date(start, stop),
  scale: 500
})
print('original', images.size())

images = assets.getMostlyCleanImages(images, geometry2, { scale: 1000, cloudFrequencyThresholdDelta: 0.2 })
print('clean', images.size())

print(ee.List(images.aggregate_array('system:time_start')).sort().map(function(o) { return ee.Date(o).format('YYYY-MM-dd') }))

function computeMaxWaterGeometry() {
  // water
  var water = images.select(['green', 'swir']).reduce(ee.Reducer.percentile([10])).normalizedDifference()
  Map.addLayer(water.selfMask(), { min: 0, max: 0.5, palette: palettes.crameri.vik[50].reverse() }, 'water')
  
  var waterMask = utils.focalMaxWeight(utils.focalMax(water, 1000), 3000)
  
  // vectorize
  var waterVector = water.gt(0).focal_max(5).selfMask().reduceToVectors({ geometry: geometry, scale: 120 })
  Map.addLayer(waterVector, {}, 'water (vector)')
  
  // take the largest
  waterVector = waterVector.map(function(f) {
    return f.set({ area: f.area(120) })
  })
  
  var waterVectorLargest = waterVector.sort('area', false).first()
  
  print('Largest geometry: ', waterVectorLargest.geometry().simplify(240))

  // tiles (on water)
  var zoom = 12
  var tiles = tiler.getTilesForGeometry(waterVectorLargest.geometry(), zoom)
  print(tiler.zoomToScale(zoom))
  print(tiles.size())
  Map.addLayer(tiles, {}, 'tiles, zoom = ' + zoom)
  
  throw(0) // copy/paste water boundary
}

// computeMaxWaterGeometry()


function exportWaterBoundaryMask() {
  var exportMask = utils.focalMaxWeight(utils.focalMax(waterBoundaryImage, 100),  200)
    .reproject(ee.Projection('EPSG:3857').atScale(30))
    .resample('bicubic')
    
  Export.image.toAsset({ 
    image: exportMask, 
    description: 'dam-Merowe-mask', 
    assetId: 'users/gena/dam-Merowe-export-mask', 
    region: region, 
    scale: 60, crs: 'EPSG:3857' 
  })
  
  throw(0)
}

// exportWaterBoundaryMask()

var exportMask = ee.Image('users/gena/dam-Merowe-export-mask').resample('bicubic')
  
Map.addLayer(exportMask, { min: 0, max: 1}, 'water boundary mask (image), buffer', false, 0.5)


// play
images = images.sort('system:time_start')

// plot
var rect = ee.Geometry.Rectangle({ coords: [[0, 0], [100, 4]], geodesic: false })
var plot = new charting.Plot(rect.bounds(), { area: { width: 1, color: '000000', fillColor: '00000011' } })
plot.setMinMax(start.millis(), stop.millis(), 0, 1)
var times = ee.List(images.aggregate_array('system:time_start'))
plot.addRugSeries('images', times, { width: 1, color: 'red' }, 1)  
print(plot.getThumbnail({ dimensions: '600x24'}))

var vis = { min: 0.05, max: 0.5 }

images = images.map(function(i) {
  return i.updateMask(exportMask).visualize(vis)
})

// animation.animate(images, { maxFrames: 150, preload: false })

var bucket = 'deltares-video-map'
var prefix = 'dam-Merowe-v3-S2'
var maxZoom = 14

function exportFrame(i) {
  var frameId = utils.pad(i, 5)
  var task = prefix + '-' + frameId
  var path = prefix + '/' + frameId
  
  var frame = ee.Image(images.get(i))
  
  Export.map.toCloudStorage({
    image: frame, 
    description: task, 
    bucket: bucket, 
    fileFormat: 'png', 
    path: path,
    minZoom: 0, 
    maxZoom: maxZoom,
    region: region,
    writePublicTiles: false,
    skipEmptyTiles: true
  })
}

var count = 179
images = images.toList(count)
ee.List.sequence(1, count).evaluate(function(indices) { indices.map(exportFrame)})

Map.addLayer(ee.Image(images.get(0)), {}, 'frame 0')


Map.addLayer(region, {}, 'export region')

Map.centerObject(geometry2, maxZoom)

